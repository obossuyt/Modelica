<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Electrical.AC.OnePhase.Conversion</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with models for AC/AC and AC/DC conversion&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Conversion<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Electrical.AC.OnePhase.Conversion"></a><a href="Buildings_Electrical_AC_OnePhase.html#Buildings.Electrical.AC.OnePhase"
>Buildings.Electrical.AC.OnePhase</a>.Conversion</h2>
<p>
<b>Package with models for AC/AC and AC/DC conversion</b><br>
</p>
<h3>Information</h3>

<p>
This package contains models for AC/AC and AC/DC conversion.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_Package.html#Modelica.Icons.Package"
>Modelica.Icons.Package</a> (Icon for standard packages).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.Electrical.AC.O26876f2856b4691aerterS.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACConverter" width="20" height="20" align="top">&nbsp;<a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion.ACACConverter"
>ACACConverter</a>
</td>
<td>AC AC converter single phase systems</td>
</tr>
<tr>
<td><img src="Buildings.Electrical.AC.Odcf6edfd7840374dormerS.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformer" width="20" height="20" align="top">&nbsp;<a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformer"
>ACACTransformer</a>
</td>
<td>AC AC transformer simplified equivalent circuit</td>
</tr>
<tr>
<td><img src="Buildings.Electrical.AC.O622c3e3c54f55defrFullS.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformerFull" width="20" height="20" align="top">&nbsp;<a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformerFull"
>ACACTransformerFull</a>
</td>
<td>AC AC transformer with detailed equivalent circuit</td>
</tr>
<tr>
<td><img src="Buildings.Electrical.AC.O5b05302356a0691aerterS.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACDCConverter" width="20" height="20" align="top">&nbsp;<a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion.ACDCConverter"
>ACDCConverter</a>
</td>
<td>AC DC converter</td>
</tr>
<tr>
<td><img src="Buildings.Electrical.AC.O7aa08e71eca369b3mplesS.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.Examples" width="20" height="20" align="top">&nbsp;<a href="Buildings_Electrical_AC_OnePhase_Conversion_Examples.html#Buildings.Electrical.AC.OnePhase.Conversion.Examples"
>Examples</a>
</td>
<td>Package with example models</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ACACConverter<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Electrical.AC.O26876f2856b4691aerterI.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACConverter" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Electrical.AC.OnePhase.Conversion.ACACConverter"></a><a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion"
>Buildings.Electrical.AC.OnePhase.Conversion</a>.ACACConverter</h2>
<p>
<b>AC AC converter single phase systems</b>
<br>
<br><img src="Buildings.Electrical.AC.O26876f2856b4691aerterD.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACConverter">
</p>
<h3>Information</h3>

<p>
This is an AC/AC converter, based on a power balance between both circuit sides.
The paramater <i>conversionFactor</i> defines the ratio between the RMS voltages
as
</p>

<p align="center" style="font-style:italic;">
V<sub>2</sub> = conversionFactor  V<sub>1</sub>
</p>

<p>
where <i>V<sub>1</sub></i> and <i>V<sub>2</sub></i> are the RMS voltages
at the primary and secondary sides of the transformer, i.e., the
connector N and P, respectively.
</p>

<p>
The loss of the converter is proportional to the power transmitted.
The parameter <code>eta</code> is the efficiency of the transfer.
The loss is computed as
</p>
<p align="center" style="font-style:italic;">
P<sub>loss</sub> = (1-&eta;) P<sub>tr</sub>,
</p>
<p>
where <i>P<sub>tr</sub></i> is the power transmitted. The model is bi-directional
and the power can flow from the primary to the secondary side and vice-versa.
Furthermore, reactive power on both side are set to zero.
</p>
<h4>Note:</h4>
<p>
This model is derived from
<a href="../../msl/Modelica%203.2.1/help/Modelica_Electrical_QuasiStationary_SinglePhase_Utilities.html#Modelica.Electrical.QuasiStationary.SinglePhase.Utilities.IdealACDCConverter"
>
Modelica.Electrical.QuasiStationary.SinglePhase.Utilities.IdealACDCConverter</a>.
</p>

<p>Extends from <a href="Buildings_Electrical_Icons.html#Buildings.Electrical.Icons.RefAngleConversion"
>Buildings.Electrical.Icons.RefAngleConversion</a> (Icon that represents if the angle symble should be displayed or not), <a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a> (Model representing a generic two port system for conversion).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal n</td></tr>
<tr><td>Real</td><td>conversionFactor</td><td>&nbsp;</td><td>Ratio of QS rms voltage on side 2 / QS rms voltage on side 1</td></tr>
<tr><td>Real</td><td>eta</td><td>&nbsp;</td><td>Converter efficiency, pLoss = (1-eta) * Ptr</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Ground</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">side 1</td></tr>
<tr><td>Boolean</td><td>ground_1</td><td>false</td><td>If true, connect side 1 of converter to ground</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">side 2</td></tr>
<tr><td>Boolean</td><td>ground_2</td><td>true</td><td>If true, connect side 2 of converter to ground</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td>Phase system of terminal n</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ACACConverter <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;AC AC converter single phase systems&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Electrical_Icons.html#Buildings.Electrical.Icons.RefAngleConversion"
>Buildings.Electrical.Icons.RefAngleConversion</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_p = <a href="Buildings_Electrical_PhaseSystems_OnePhase.html#Buildings.Electrical.PhaseSystems.OnePhase"
>PhaseSystems.OnePhase</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_n = <a href="Buildings_Electrical_PhaseSystems_OnePhase.html#Buildings.Electrical.PhaseSystems.OnePhase"
>PhaseSystems.OnePhase</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_AC_OnePhase_Interfaces.html#Buildings.Electrical.AC.OnePhase.Interfaces.Terminal_n"
>Interfaces.Terminal_n</a> terminal_n(
      i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_n.n),
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)),
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_AC_OnePhase_Interfaces.html#Buildings.Electrical.AC.OnePhase.Interfaces.Terminal_p"
>Interfaces.Terminal_p</a> terminal_p(
      i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_p.n),
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)));
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real conversionFactor(min = Modelica.Constants.eps) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Ratio of QS rms voltage on side 2 / QS rms voltage on side 1&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real eta(min=0, max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Converter efficiency, pLoss = (1-eta) * Ptr&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_1 = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;If true, connect side 1 of converter to ground&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_2 = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;If true, connect side 2 of converter to ground&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> LossPower[2] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Loss power&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_p[2] =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_p.phasePowers_vi</span>(terminal_p.v, terminal_p.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin p&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_n[2] =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_n.phasePowers_vi</span>(terminal_n.v, terminal_n.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin n&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Ideal transformation</span>
  terminal_p.v = conversionFactor*terminal_n.v;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Power loss term</span>
  terminal_p.i[1] = terminal_n.i[1]/conversionFactor*
    <span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.spliceFunction</span>(eta-2, 1/(eta-2), P_p[1], deltax=0.1);
  terminal_p.i[2] = terminal_n.i[2]/conversionFactor*
    <span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.spliceFunction</span>(eta-2, 1/(eta-2), P_p[1], deltax=0.1);
  LossPower = P_p + P_n;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// The two sides have the same reference angle</span>
  terminal_p.theta = terminal_n.theta;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_1<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.potentialRoot</span>(terminal_n.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_2<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.root</span>(terminal_p.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ACACConverter;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ACACTransformer<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Electrical.AC.Odcf6edfd7840374dormerI.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformer" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformer"></a><a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion"
>Buildings.Electrical.AC.OnePhase.Conversion</a>.ACACTransformer</h2>
<p>
<b>AC AC transformer simplified equivalent circuit</b>
<br>
<br><img src="Buildings.Electrical.AC.O26876f2856b4691aerterD.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformer">
</p>
<h3>Information</h3>

<p>
This is a simplified equivalent transformer model.
The model accounts for winding Joule losses and leakage reactances
that are represented by a series of a resistance <i>R</i> and an
inductance <i>L</i>. The resistance and the inductance represent both the
effects of the secondary and primary side of the transformer.
</p>
<p>
The model is parameterized using the following parameters
</p>
<ul>
<li><code>VHigh</code> - RMS voltage at primary side,</li>
<li><code>VLow</code> - RMS voltage at secondary side,</li>
<li><code>VABase</code> - apparent nominal power of the transformer,</li>
<li><code>XoverR</code> - ratio between reactance and resistance, and</li>
<li><code>Zperc</code> - the short circuit impedance.</li>
</ul>
<p>
Given the nominal conditions,the model computes the values of the resistance and the inductance.
</p>

<p>Extends from <a href="Buildings_Electrical_Icons.html#Buildings.Electrical.Icons.RefAngleConversion"
>Buildings.Electrical.Icons.RefAngleConversion</a> (Icon that represents if the angle symble should be displayed or not), <a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a> (Model representing a generic two port system for conversion).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal n</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Voltage</a></td><td>VHigh</td><td>&nbsp;</td><td>Rms voltage on side 1 of the transformer (primary side) [V]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Voltage</a></td><td>VLow</td><td>&nbsp;</td><td>Rms voltage on side 2 of the transformer (secondary side) [V]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ApparentPower"
>ApparentPower</a></td><td>VABase</td><td>&nbsp;</td><td>Nominal power of the transformer [VA]</td></tr>
<tr><td>Real</td><td>XoverR</td><td>&nbsp;</td><td>Ratio between the complex and real components of the impedance (XL/R)</td></tr>
<tr><td>Real</td><td>Zperc</td><td>&nbsp;</td><td>Short circuit impedance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Ground</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">side 1</td></tr>
<tr><td>Boolean</td><td>ground_1</td><td>false</td><td>If true, connect side 1 of converter to ground</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">side 2</td></tr>
<tr><td>Boolean</td><td>ground_2</td><td>true</td><td>If true, connect side 2 of converter to ground</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>phi_1</td><td>0</td><td>Angle of the voltage side 1 at initialization [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>phi_2</td><td>phi_1</td><td>Angle of the voltage side 2 at initialization [rad]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td>Phase system of terminal n</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ACACTransformer <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;AC AC transformer simplified equivalent circuit&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Electrical_Icons.html#Buildings.Electrical.Icons.RefAngleConversion"
>Buildings.Electrical.Icons.RefAngleConversion</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_p = <a href="Buildings_Electrical_PhaseSystems_OnePhase.html#Buildings.Electrical.PhaseSystems.OnePhase"
>PhaseSystems.OnePhase</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_n = <a href="Buildings_Electrical_PhaseSystems_OnePhase.html#Buildings.Electrical.PhaseSystems.OnePhase"
>PhaseSystems.OnePhase</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_AC_OnePhase_Interfaces.html#Buildings.Electrical.AC.OnePhase.Interfaces.Terminal_n"
>Interfaces.Terminal_n</a> terminal_n(
      i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_n.n),
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)),
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_AC_OnePhase_Interfaces.html#Buildings.Electrical.AC.OnePhase.Interfaces.Terminal_p"
>Interfaces.Terminal_p</a> terminal_p(
      i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_p.n),
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)));
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> VHigh <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Rms voltage on side 1 of the transformer (primary side)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> VLow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Rms voltage on side 2 of the transformer (secondary side)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ApparentPower"
>Modelica.SIunits.ApparentPower</a> VABase <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal power of the transformer&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real XoverR <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Ratio between the complex and real components of the impedance (XL/R)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real Zperc <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Short circuit impedance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_1 = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;If true, connect side 1 of converter to ground&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_2 = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;If true, connect side 2 of converter to ground&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> phi_1 = 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Angle of the voltage side 1 at initialization&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> phi_2 = phi_1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Angle of the voltage side 2 at initialization&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Efficiency"
>Modelica.SIunits.Efficiency</a> eta <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Efficiency&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> PLoss[2] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Loss power&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  Real N = VHigh/VLow <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Winding ratio&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Current"
>Modelica.SIunits.Current</a> IHigh = VABase/VHigh <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal current on primary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Current"
>Modelica.SIunits.Current</a> ILow = VABase/VLow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal current on secondary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Current"
>Modelica.SIunits.Current</a> IscHigh = IHigh/Zperc <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Short circuit current on primary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Current"
>Modelica.SIunits.Current</a> IscLow = ILow/Zperc <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Short circuit current on secondary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Zp = VHigh/IscHigh <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Impedance of the primary side (module)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Z1[2]=
    {Zp*<span style="color: red; font-weight: normal; font-style: normal;">cos</span>(<span style="color: red; font-weight: normal; font-style: normal;">atan</span>(XoverR)), Zp*<span style="color: red; font-weight: normal; font-style: normal;">sin</span>(<span style="color: red; font-weight: normal; font-style: normal;">atan</span>(XoverR))} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Impedance of the primary side of the transformer&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Zs = VLow/IscLow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Impedance of the secondary side (module)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Z2[2]=
    {Zs*<span style="color: red; font-weight: normal; font-style: normal;">cos</span>(<span style="color: red; font-weight: normal; font-style: normal;">atan</span>(XoverR)), Zs*<span style="color: red; font-weight: normal; font-style: normal;">sin</span>(<span style="color: red; font-weight: normal; font-style: normal;">atan</span>(XoverR))} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Impedance of the secondary side of the transformer&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> V1[2](
    start =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_n.phaseVoltages</span>(VHigh, phi_1)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Voltage at the winding - primary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> V2[2](
    start =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_p.phaseVoltages</span>(VLow, phi_2)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Voltage at the winding - secondary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_p[2]=
    <span style="color: red; font-weight: normal; font-style: normal;">PhaseSystem_p.phasePowers_vi</span>(terminal_p.v, terminal_p.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin p (secondary)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_n[2]=
    <span style="color: red; font-weight: normal; font-style: normal;">PhaseSystem_n.phasePowers_vi</span>(terminal_n.v, terminal_n.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin n (primary)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> S_p =<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Fluid.Utilities.regRoot</span>(P_p[1]^2 + P_p[2]^2, delta=0.1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Apparent power at terminal p&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> S_n =<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Fluid.Utilities.regRoot</span>(P_n[1]^2 + P_n[2]^2, delta=0.1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Apparent power at terminal n&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Efficiency</span>
  eta =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.smoothMin</span>(
        x1=
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_p[1]^2 + P_p[2]^2, delta=0.01)/
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_n[1]^2 + P_n[2]^2 + 1e-6, delta=0.01),
        x2=
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_n[1]^2 + P_n[2]^2, delta=0.01)/
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_p[1]^2 + P_p[2]^2 + 1e-6, delta=0.01),
        deltaX=  0.01);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Ideal transformation</span>
  V2 = V1/N;
  terminal_p.i[1] + terminal_n.i[1]*N = 0;
  terminal_p.i[2] + terminal_n.i[2]*N = 0;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Losses due to the impedance</span>
  terminal_n.v = V1 +<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Electrical.PhaseSystems.OnePhase.product</span>(
    terminal_n.i, Z1);
  V2 = terminal_p.v;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Loss of power</span>
  PLoss = P_p + P_n;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// The two sides have the same reference angle</span>
  terminal_p.theta = terminal_n.theta;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_1<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.potentialRoot</span>(terminal_n.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_2<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.root</span>(terminal_p.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ACACTransformer;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ACACTransformerFull<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Electrical.AC.O622c3e3c54f55defrFullI.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformerFull" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformerFull"></a><a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion"
>Buildings.Electrical.AC.OnePhase.Conversion</a>.ACACTransformerFull</h2>
<p>
<b>AC AC transformer with detailed equivalent circuit</b>
<br>
<br><img src="Buildings.Electrical.AC.O26876f2856b4691aerterD.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACACTransformerFull">
</p>
<h3>Information</h3>

<p>
This is a detailed transformer model that takes into account the winding Joule losses
and the leakage reactances on both primary and secondary side. The model also describes
the core or iron losses and the losses due to magnetization effects.
</p>
<p>
The losses are represented by a series of resistances <i>R<sub>1</sub></i>, <i>R<sub>2</sub></i>,
<i>R<sub>m</sub></i> and inductances <i>L<sub>1</sub></i>, <i>L<sub>2</sub></i>, and
<i>L<sub>m</sub></i>.
</p>
<p>
The model is parameterized using the following parameters
</p>
<ul>
<li><code>VHigh</code> - RMS voltage at primary side,</li>
<li><code>VLow</code> - RMS voltage at secondary side,</li>
<li><code>VABase</code> - apparent nominal power of the transformer,</li>
<li><code>f</code> - frequency,</li>
<li><code>R_1, L_1</code> - resistance and inductance at primary side (per unit),</li>
<li><code>R_2, L_2</code> - resistance and inductance at secondary side (per unit), and</li>
<li><code>R_m, L_m</code> - resistance and inductance for magnetization effects (per unit).</li>
</ul>
<p>
Given the nominal conditions, the model computes the values of the nominal impedances
at both primary and secondary side. Given these values, the per unit values are transformed into
the actual values of the resistances and inductances.
</p>
<p>
The magnetization losses can be enabled or disabled using the boolean flag <code>magEffects</code>.
</p>

<p>Extends from <a href="Buildings_Electrical_Icons.html#Buildings.Electrical.Icons.RefAngleConversion"
>Buildings.Electrical.Icons.RefAngleConversion</a> (Icon that represents if the angle symble should be displayed or not), <a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a> (Model representing a generic two port system for conversion).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal n</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Voltage</a></td><td>VHigh</td><td>&nbsp;</td><td>RMS voltage on side 1 of the transformer (primary side) [V]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Voltage</a></td><td>VLow</td><td>&nbsp;</td><td>RMS voltage on side 2 of the transformer (secondary side) [V]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ApparentPower"
>ApparentPower</a></td><td>VABase</td><td>&nbsp;</td><td>Nominal power of the transformer [VA]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Frequency"
>Frequency</a></td><td>f</td><td>&nbsp;</td><td>Nominal frequency [Hz]</td></tr>
<tr><td><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>PerUnit</a></td><td>R1</td><td>&nbsp;</td><td>Resistance on side 1 of the transformer (pu) [1]</td></tr>
<tr><td><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>PerUnit</a></td><td>L1</td><td>&nbsp;</td><td>Inductance on side 1 of the transformer (pu) [1]</td></tr>
<tr><td><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>PerUnit</a></td><td>R2</td><td>&nbsp;</td><td>Resistance on side 2 of the transformer (pu) [1]</td></tr>
<tr><td><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>PerUnit</a></td><td>L2</td><td>&nbsp;</td><td>Inductance on side 2 of the transformer (pu) [1]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Magnetization</td></tr>
<tr><td>Boolean</td><td>magEffects</td><td>false</td><td>If true, introduce magnetization effects</td></tr>
<tr><td><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>PerUnit</a></td><td>Rm</td><td>&nbsp;</td><td>Magnetization resistance (pu) [1]</td></tr>
<tr><td><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>PerUnit</a></td><td>Lm</td><td>&nbsp;</td><td>Magnetization inductance (pu) [1]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Ground</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">side 1</td></tr>
<tr><td>Boolean</td><td>ground_1</td><td>false</td><td>Connect side 1 of converter to ground</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">side 2</td></tr>
<tr><td>Boolean</td><td>ground_2</td><td>true</td><td>Connect side 2 of converter to ground</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>phi_1</td><td>0</td><td>Angle of the voltage side 1 at initialization [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>phi_2</td><td>phi_1</td><td>Angle of the voltage side 2 at initialization [rad]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td>Phase system of terminal n</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ACACTransformerFull <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;AC AC transformer with detailed equivalent circuit&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Electrical_Icons.html#Buildings.Electrical.Icons.RefAngleConversion"
>Buildings.Electrical.Icons.RefAngleConversion</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_p = <a href="Buildings_Electrical_PhaseSystems_OnePhase.html#Buildings.Electrical.PhaseSystems.OnePhase"
>PhaseSystems.OnePhase</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_n = <a href="Buildings_Electrical_PhaseSystems_OnePhase.html#Buildings.Electrical.PhaseSystems.OnePhase"
>PhaseSystems.OnePhase</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_AC_OnePhase_Interfaces.html#Buildings.Electrical.AC.OnePhase.Interfaces.Terminal_n"
>Interfaces.Terminal_n</a> terminal_n(
      i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_n.n),
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)),
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_AC_OnePhase_Interfaces.html#Buildings.Electrical.AC.OnePhase.Interfaces.Terminal_p"
>Interfaces.Terminal_p</a> terminal_p(
      i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_p.n),
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)));
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> VHigh <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;RMS voltage on side 1 of the transformer (primary side)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> VLow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;RMS voltage on side 2 of the transformer (secondary side)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ApparentPower"
>Modelica.SIunits.ApparentPower</a> VABase <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal power of the transformer&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Frequency"
>Modelica.SIunits.Frequency</a> f(start=60) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Nominal frequency&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>Buildings.Electrical.Types.PerUnit</a> R1(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Resistance on side 1 of the transformer (pu)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>Buildings.Electrical.Types.PerUnit</a> L1(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Inductance on side 1 of the transformer (pu)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>Buildings.Electrical.Types.PerUnit</a> R2(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Resistance on side 2 of the transformer (pu)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>Buildings.Electrical.Types.PerUnit</a> L2(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Inductance on side 2 of the transformer (pu)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean magEffects = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;If true, introduce magnetization effects&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>Buildings.Electrical.Types.PerUnit</a> Rm(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Magnetization resistance (pu)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Electrical_Types.html#Buildings.Electrical.Types.PerUnit"
>Buildings.Electrical.Types.PerUnit</a> Lm(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Magnetization inductance (pu)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_1 = false <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Connect side 1 of converter to ground&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_2 = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Connect side 2 of converter to ground&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> phi_1 = 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Angle of the voltage side 1 at initialization&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> phi_2 = phi_1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Angle of the voltage side 2 at initialization&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Efficiency"
>Modelica.SIunits.Efficiency</a> eta <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Efficiency&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> PLoss[2] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Loss power&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>Modelica.SIunits.AngularVelocity</a> omega_n = 2*Modelica.Constants.pi*f;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real N = VHigh/VLow <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Winding ratio&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Resistance"
>Modelica.SIunits.Resistance</a> RBaseHigh = VHigh^2/VABase <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Base impedance of the primary side&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Resistance"
>Modelica.SIunits.Resistance</a> RBaseLow = VLow^2/VABase <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Base impedance of the secondary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Z1[2] = {RBaseHigh*R1, omega*L1*RBaseHigh/omega_n} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Impedance of the primary side of the transformer&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Z2[2] = {RBaseLow*R2, omega*L2*RBaseLow/omega_n} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Impedance of the secondary side of the transformer&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Zrm[2] = {RBaseHigh*Rm, 0} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Magnetization impedance - resistance&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Impedance"
>Modelica.SIunits.Impedance</a> Zlm[2] = {0, omega*Lm*RBaseHigh/omega_n} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Magnetization impedance - impedence&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> V1[2](start =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_n.phaseVoltages</span>(VHigh, phi_1)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Voltage at the winding - primary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Voltage"
>Modelica.SIunits.Voltage</a> V2[2](start =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_n.phaseVoltages</span>(VLow, phi_2)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Voltage at the winding - secondary side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_p[2] =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_p.phasePowers_vi</span>(terminal_p.v, terminal_p.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin p (secondary)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_n[2] =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_n.phasePowers_vi</span>(terminal_n.v, terminal_n.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin n (primary)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> S_p =<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Fluid.Utilities.regRoot</span>(P_p[1]^2 + P_p[2]^2, delta=0.1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Apparent power at terminal p&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> S_n =<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Fluid.Utilities.regRoot</span>(P_n[1]^2 + P_n[2]^2, delta=0.1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Apparent power at terminal n&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>Modelica.SIunits.AngularVelocity</a> omega <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Angular velocity&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Current"
>Modelica.SIunits.Current</a> Im[2] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Magnetization current&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(P_p[1]^2 + P_p[2]^2) &lt;= VABase*1.01,
    &quot;The load power of the transformer is higher than VABase&quot;);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Angular velocity</span>
  omega =<span style="color: red; font-weight: normal; font-style: normal;"> der</span>(<span style="color: red; font-weight: normal; font-style: normal;">PhaseSystem_p.thetaRef</span>(terminal_p.theta));

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Efficiency</span>
  eta =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.smoothMin</span>(
        x1=
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_p[1]^2 + P_p[2]^2, delta=0.01)/
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_n[1]^2 + P_n[2]^2 + 1e-6, delta=0.01),
        x2=
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_n[1]^2 + P_n[2]^2, delta=0.01)/
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regRoot</span>(P_p[1]^2 + P_p[2]^2 + 1e-6, delta=0.01),
        deltaX=  0.01);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Ideal transformation</span>
  V2 = V1/N;
  terminal_p.i[1] + (terminal_n.i[1] - Im[1])*N = 0;
  terminal_p.i[2] + (terminal_n.i[2] - Im[2])*N = 0;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Magnetization current</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>magEffects<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    Im =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Electrical.PhaseSystems.OnePhase.divide</span>(V1, Zrm) +
         <span style="color: red; font-weight: normal; font-style: normal;">Buildings.Electrical.PhaseSystems.OnePhase.divide</span>(V1, Zlm);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    Im =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(2);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Losses due to the impedance - primary side</span>
  terminal_n.v = V1 +<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Electrical.PhaseSystems.OnePhase.product</span>(
    terminal_n.i, Z1);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Losses due to the impedance - secondary side</span>
  terminal_p.v = V2 +<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Electrical.PhaseSystems.OnePhase.product</span>(
    terminal_p.i, Z2);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Loss of power</span>
  PLoss = P_p + P_n;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// The two sides have the same reference angle</span>
  terminal_p.theta = terminal_n.theta;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_1<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.potentialRoot</span>(terminal_n.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_2<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.root</span>(terminal_p.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ACACTransformerFull;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ACDCConverter<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Electrical.AC.O5b05302356a0691aerterI.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACDCConverter" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Electrical.AC.OnePhase.Conversion.ACDCConverter"></a><a href="Buildings_Electrical_AC_OnePhase_Conversion.html#Buildings.Electrical.AC.OnePhase.Conversion"
>Buildings.Electrical.AC.OnePhase.Conversion</a>.ACDCConverter</h2>
<p>
<b>AC DC converter</b>
<br>
<br><img src="Buildings.Electrical.AC.O5b05302356a0691aerterD.png" alt="Buildings.Electrical.AC.OnePhase.Conversion.ACDCConverter">
</p>
<h3>Information</h3>

<p>
This is an AC/DC converter, based on a power balance between both circuit sides.
The paramater <code>conversionFactor</code> defines the ratio between the RMS voltages
as
</p>

<p align="center" style="font-style:italic;">
V<sub>DC</sub> = conversionFactor V<sub>AC</sub>,
</p>

<p>
where <i>V<sub>DC</sub></i> is the voltage of the DC circuit and <i>V<sub>AC</sub></i>
is the RMS voltage at the primary side of the transformer.
</p>

<p>
The loss of the converter is proportional to the power transmitted.
The parameter <code>eta</code> is the efficiency of the transfer.
The loss is computed as
</p>
<p align="center" style="font-style:italic;">
P<sub>loss</sub> = (1-&eta;) P<sub>tr</sub>
</p>
<p>
where <i>P<sub>tr</sub></i> is the power transmitted. The model is bi-directional
and the power can flow from both the primary to the secondary side and vice-versa.
Furthermore, reactive power on both side are set to <i>0</i>.
</p>
<h4>Note:</h4>
<p>
This model is derived from
<a href="../../msl/Modelica%203.2.1/help/Modelica_Electrical_QuasiStationary_SinglePhase_Utilities.html#Modelica.Electrical.QuasiStationary.SinglePhase.Utilities.IdealACDCConverter"
>
Modelica.Electrical.QuasiStationary.SinglePhase.Utilities.IdealACDCConverter</a>.
</p>

<p>Extends from <a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a> (Model representing a generic two port system for conversion).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td><a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem"
>PartialPhaseSystem</a></td><td>Phase system of terminal n</td></tr>
<tr><td>Real</td><td>conversionFactor</td><td>&nbsp;</td><td>Ratio of DC voltage / AC RMS voltage</td></tr>
<tr><td>Real</td><td>eta</td><td>&nbsp;</td><td>Converter efficiency, pLoss = (1-eta) * Ptr</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Ground</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">AC side</td></tr>
<tr><td>Boolean</td><td>ground_AC</td><td>false</td><td>Connect AC side of converter to ground</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">DC side</td></tr>
<tr><td>Boolean</td><td>ground_DC</td><td>true</td><td>Connect DC side of converter to ground</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package PhaseSystem_p</td><td>Phase system of terminal p</td></tr>
<tr><td colspan="2">replaceable package PhaseSystem_n</td><td>Phase system of terminal n</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ACDCConverter <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;AC DC converter&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Electrical_Interfaces.html#Buildings.Electrical.Interfaces.PartialConversion"
>Buildings.Electrical.Interfaces.PartialConversion</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_p = <a href="Buildings_Electrical_PhaseSystems_TwoConductor.html#Buildings.Electrical.PhaseSystems.TwoConductor"
>PhaseSystems.TwoConductor</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> PhaseSystem_n = <a href="Buildings_Electrical_PhaseSystems_OnePhase.html#Buildings.Electrical.PhaseSystems.OnePhase"
>PhaseSystems.OnePhase</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_AC_OnePhase_Interfaces.html#Buildings.Electrical.AC.OnePhase.Interfaces.Terminal_n"
>Interfaces.Terminal_n</a> terminal_n(
        i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_n.n),
        <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)),
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Electrical_DC_Interfaces.html#Buildings.Electrical.DC.Interfaces.Terminal_p"
>DC.Interfaces.Terminal_p</a> terminal_p(
        i(start =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(PhaseSystem_p.n),
        <span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect = StateSelect.prefer)));
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real conversionFactor(min = Modelica.Constants.eps) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Ratio of DC voltage / AC RMS voltage&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real eta(min=0, max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Converter efficiency, pLoss = (1-eta) * Ptr&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> PLoss <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Loss power&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_AC = false <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Connect AC side of converter to ground&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean ground_DC = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Connect DC side of converter to ground&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem.Current"
>PhaseSystem_p.Current</a> i_dc <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;DC current&quot;</span>;
  <a href="Buildings_Electrical_PhaseSystems_PartialPhaseSystem.html#Buildings.Electrical.PhaseSystems.PartialPhaseSystem.Voltage"
>PhaseSystem_p.Voltage</a> v_dc <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;DC voltage&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_p[2] =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_p.phasePowers_vi</span>(terminal_p.v, terminal_p.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin p (secondary)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</a> P_n[2] =<span style="color: red; font-weight: normal; font-style: normal;"> PhaseSystem_n.phasePowers_vi</span>(terminal_n.v, terminal_n.i) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Power transmitted at pin n (primary)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//voltage relation</span>
  v_p = v_n*conversionFactor;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Power losses</span>
  PLoss = (1-eta)*
    <span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.spliceFunction</span>(P_p[1], P_n[1], i_p, deltax=0.1);
  P_n + P_p = {PLoss, 0};

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_AC<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.potentialRoot</span>(terminal_n.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ground_DC<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    v_dc = 0;
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.root</span>(terminal_p.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    i_dc = 0;
    <span style="color: red; font-weight: normal; font-style: normal;">Connections.potentialRoot</span>(terminal_p.theta);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  v_dc = terminal_p.v[2];
  <span style="color: red; font-weight: normal; font-style: normal;">sum</span>(terminal_p.i) + i_dc = 0;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ACDCConverter;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:22:36 2015.
</address>
</body>
</html>
