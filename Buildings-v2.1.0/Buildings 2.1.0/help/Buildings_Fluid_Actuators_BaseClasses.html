<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Fluid.Actuators.BaseClasses</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with base classes for Buildings.Fluid.Actuators&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Actuators.BaseClasses"></a><a href="Buildings_Fluid_Actuators.html#Buildings.Fluid.Actuators"
>Buildings.Fluid.Actuators</a>.BaseClasses</h2>
<p>
<b>Package with base classes for Buildings.Fluid.Actuators</b><br>
</p>
<h3>Information</h3>

<p>
This package contains base classes that are used to construct the models in
<a href="Buildings_Fluid_Actuators.html#Buildings.Fluid.Actuators"
>Buildings.Fluid.Actuators</a>.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</a> (Icon for packages containing base classes).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators05b8ecb1449abd53ignalS.png" alt="Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"
>ActuatorSignal</a>
</td>
<td>Partial model that implements the filtered opening for valves and dampers</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators2c08592b56e2d47fntialS.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialDamperExponential" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialDamperExponential"
>PartialDamperExponential</a>
</td>
<td>Partial model for air dampers with exponential opening characteristics</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators8b7314e2935a9e36ValveS.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>PartialThreeWayValve</a>
</td>
<td>Partial three way valve</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators8f28c1b0799bc0dcValveS.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>PartialTwoWayValve</a>
</td>
<td>Partial model for a two way valve</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators8f28c1b0799bc0dcValveS.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>PartialTwoWayValveKv</a>
</td>
<td>Partial model for a two way valve using a Kv characteristic</td>
</tr>
<tr>
<td><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ValveParameters"
>ValveParameters</a>
</td>
<td>Model with parameters for valves</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuatorsc90dad90afeece15ntageS.png" alt="Buildings.Fluid.Actuators.BaseClasses.der_equalPercentage" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.der_equalPercentage"
>der_equalPercentage</a>
</td>
<td>Derivative of valve opening characteristics for equal percentage valve</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuatorsc90dad90afeece15ntageS.png" alt="Buildings.Fluid.Actuators.BaseClasses.equalPercentage" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.equalPercentage"
>equalPercentage</a>
</td>
<td>Valve opening characteristics for equal percentage valve</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuatorsc90dad90afeece15ntageS.png" alt="Buildings.Fluid.Actuators.BaseClasses.exponentialDamper" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.exponentialDamper"
>exponentialDamper</a>
</td>
<td>Damper opening characteristics for an exponential damper</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators8d59ca857b6ac398mplesS.png" alt="Buildings.Fluid.Actuators.BaseClasses.Examples" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_BaseClasses_Examples.html#Buildings.Fluid.Actuators.BaseClasses.Examples"
>Examples</a>
</td>
<td>Collection of models that illustrate model use and test models</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ActuatorSignal<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators05b8ecb1449abd53ignalI.png" alt="Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.ActuatorSignal</h2>
<p>
<b>Partial model that implements the filtered opening for valves and dampers</b>
<br>
<br><img src="Buildings.Fluid.Actuators05b8ecb1449abd53ignalD.png" alt="Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal">
</p>
<h3>Information</h3>

<p>
This model implements the filter that is used to approximate the travel
time of the actuator.
Models that extend this model use the signal
<code>y_actual</code> to obtain the
current position of the actuator.
</p>
<p>
See
<a href="Buildings_Fluid_Actuators_UsersGuide.html#Buildings.Fluid.Actuators.UsersGuide"
>
Buildings.Fluid.Actuators.UsersGuide</a>
for a description of the filter.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ActuatorSignal <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model that implements the filtered opening for valves and dampers&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean filteredOpening=true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, if opening is filtered with a 2nd order CriticalDamping filter&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> riseTime=120 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Rise time of the filter (time to reach 99.6 % of an opening step)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Modelica.Blocks.Types.Init</a> init=Modelica.Blocks.Types.Init.InitialOutput <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Type of initialization (no init/steady state/initial state/initial output)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real y_start=1 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Initial value of output&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> y(min=0, max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Actuator position (0: closed, 1: open)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> y_actual <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Actual valve position&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Classes used to implement the filtered opening</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> y_filtered <span style="color: blue; font-weight: normal; font-style: normal;">if </span>filteredOpening <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Filtered valve position in the range 0..1&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Continuous.html#Modelica.Blocks.Continuous.Filter"
>Modelica.Blocks.Continuous.Filter</a> filter(
     order=2,
     f_cut=5/(2*Modelica.Constants.pi*riseTime),
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>init=init,
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>y_start=y_start,
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>analogFilter=Modelica.Blocks.Types.AnalogFilter.CriticalDamping,
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>filterType=Modelica.Blocks.Types.FilterType.LowPass,
     x(<span style="color: blue; font-weight: normal; font-style: normal;">each </span>stateSelect=StateSelect.always)) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
        filteredOpening <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Second order filter to approximate valve opening time, and to improve numerics&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
 <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(filter.y, y_filtered);
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>filteredOpening<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(y, filter.u);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(filter.y, y_actual);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(y, y_actual);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ActuatorSignal;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialDamperExponential<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators2c08592b56e2d47fntialI.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialDamperExponential" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.BaseClasses.PartialDamperExponential"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.PartialDamperExponential</h2>
<p>
<b>Partial model for air dampers with exponential opening characteristics</b>
<br>
<br><img src="Buildings.Fluid.Actuators2c08592b56e2d47fntialD.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialDamperExponential">
</p>
<h3>Information</h3>

<p>
Partial model for air dampers with exponential opening characteristics.
This is the base model for air dampers and variable air volume flow boxes.
The model implements the functions that relate the opening signal,
the pressure drop and the mass flow rate.
The model also defines parameters that are used by different air damper
models.
</p>
<p>
For a description of the opening characteristics and typical parameter values, see the damper model
<a href="Buildings_Fluid_Actuators_Dampers.html#Buildings.Fluid.Actuators.Dampers.Exponential"
>
Exponential</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialResistance"
>Buildings.Fluid.BaseClasses.PartialResistance</a> (Partial model for a hydraulic resistance), <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"
>Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal</a> (Partial model that implements the filtered opening for valves and dampers).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_turbulent</td><td>if use_deltaM then deltaM*m_...</td><td>Turbulent flow if |m_flow| &gt;= m_flow_turbulent [kg/s]</td></tr>
<tr><td>Boolean</td><td>use_deltaM</td><td>true</td><td>Set to true to use deltaM for turbulent transition, else ReC is used</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.3</td><td>Fraction of nominal mass flow rate where transition to turbulent occurs</td></tr>
<tr><td>Boolean</td><td>use_v_nominal</td><td>true</td><td>Set to true to use face velocity to compute area</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</a></td><td>v_nominal</td><td>1</td><td>Nominal face velocity [m/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A</td><td>m_flow_nominal/rho_default/v...</td><td>Face area [m2]</td></tr>
<tr><td>Boolean</td><td>roundDuct</td><td>false</td><td>Set to true for round duct, false for square cross section</td></tr>
<tr><td>Real</td><td>ReC</td><td>4000</td><td>Reynolds number where transition to turbulent starts</td></tr>
<tr><td>Real</td><td>kFixed</td><td>&nbsp;</td><td>Flow coefficient of fixed resistance that may be in series with damper, k=m_flow/sqrt(dp), with unit=(kg.m)^(1/2).</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure drop at nominal mass flow rate [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Boolean</td><td>use_constant_density</td><td>true</td><td>Set to true to use constant density for flow friction</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Damper coefficients</b></td></tr>
<tr><td>Real</td><td>a</td><td>-1.51</td><td>Coefficient a for damper characteristics</td></tr>
<tr><td>Real</td><td>b</td><td>0.105*90</td><td>Coefficient b for damper characteristics</td></tr>
<tr><td>Real</td><td>yL</td><td>15/90</td><td>Lower value for damper curve</td></tr>
<tr><td>Real</td><td>yU</td><td>55/90</td><td>Upper value for damper curve</td></tr>
<tr><td>Real</td><td>k0</td><td>1E6</td><td>Flow coefficient for y=0, k0 = pressure drop divided by dynamic pressure</td></tr>
<tr><td>Real</td><td>k1</td><td>0.45</td><td>Flow coefficient for y=1, k1 = pressure drop divided by dynamic pressure</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialDamperExponential <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model for air dampers with exponential opening characteristics&quot;</span>
   <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialResistance"
>Buildings.Fluid.BaseClasses.PartialResistance</a>(
      m_flow_turbulent=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>use_deltaM<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>deltaM * m_flow_nominal<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
      eta_default*ReC*<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(area)*facRouDuc);
   <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"
>Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal</a>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean use_deltaM = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to use deltaM for turbulent transition, else ReC is used&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real deltaM = 0.3 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of nominal mass flow rate where transition to turbulent occurs&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean use_v_nominal = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to use face velocity to compute area&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Modelica.SIunits.Velocity</a> v_nominal=1 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Nominal face velocity&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A=m_flow_nominal/rho_default/v_nominal <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Face area&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean roundDuct = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true for round duct, false for square cross section&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real ReC=4000 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Reynolds number where transition to turbulent starts&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real a(unit=&quot;&quot;)=-1.51 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Coefficient a for damper characteristics&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real b(unit=&quot;&quot;)=0.105*90 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Coefficient b for damper characteristics&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real yL = 15/90 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Lower value for damper curve&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real yU = 55/90 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Upper value for damper curve&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real k0(min=0) = 1E6 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient for y=0, k0 = pressure drop divided by dynamic pressure&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real k1(min=0) = 0.45 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient for y=1, k1 = pressure drop divided by dynamic pressure&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean use_constant_density=true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to use constant density for flow friction&quot;</span>;
 <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Density"
>Medium.Density</a> rho <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium density&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real kFixed(unit=&quot;&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient of fixed resistance that may be in series with damper, k=m_flow/sqrt(dp), with unit=(kg.m)^(1/2).&quot;</span>;
 Real kDam(unit=&quot;&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient of damper, k=m_flow/sqrt(dp), with unit=(kg.m)^(1/2)&quot;</span>;
 Real k(unit=&quot;&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient of damper plus fixed resistance, k=m_flow/sqrt(dp), with unit=(kg.m)^(1/2)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Density"
>Medium.Density</a> rho_default=<span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(sta_default) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Density, used to compute fluid volume&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real[3] cL=
    {(<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(k0) - b - a)/yL^2,
      (-b*yL - 2*<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(k0) + 2*b + 2*a)/yL,
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(k0)} <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficients for curve fit for y &lt; yl&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real[3] cU=
    {(<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(k1) - a)/(yU^2 - 2*yU + 1),
    (-b*yU^2 - 2*<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(k1)*yU - (-2*b - 2*a)*yU - b)/(yU^2 - 2*yU + 1),
    (<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(k1)*yU^2 + b*yU^2 + (-2*b - 2*a)*yU + b + a)/(yU^2 - 2*yU + 1)} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Polynomial coefficients for curve fit for y &gt; yu&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real facRouDuc= <span style="color: blue; font-weight: normal; font-style: normal;">if </span>roundDuct<span style="color: blue; font-weight: normal; font-style: normal;"> then </span><span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(Modelica.Constants.pi)/2<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>1;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> area=
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>use_v_nominal<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>m_flow_nominal/rho_default/v_nominal<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Face velocity used in the computation&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(k0 &gt; k1, &quot;k0 must be bigger than k1.&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(m_flow_turbulent &gt; 0, &quot;m_flow_turbulent must be bigger than zero.&quot;);
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  rho = <span style="color: blue; font-weight: normal; font-style: normal;">if </span>use_constant_density<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>
          rho_default<span style="color: blue; font-weight: normal; font-style: normal;">
        else </span>
          <span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(<span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_phX</span>(port_a.p,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.h_outflow),<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.Xi_outflow)));
  <span style="color: #006400; font-weight: normal; font-style: normal;">// flow coefficient, k=m_flow/sqrt(dp)</span>
  kDam=<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(2*rho)*area/<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.Actuators.BaseClasses.exponentialDamper</span>(
    y=y_actual,
    a=a,
    b=b,
    cL=cL,
    cU=cU,
    yL=yL,
    yU=yU);
  k = <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(kFixed&gt;Modelica.Constants.eps)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span><span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(1/(1/kFixed^2 + 1/kDam^2))<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>kDam;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Pressure drop calculation</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>linearized<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    m_flow*m_flow_nominal_pos = k^2*dp;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>homotopyInitialization<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>from_dp<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        m_flow=<span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(
           actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_dp</span>(
                  dp=dp, k=k,
                  m_flow_turbulent=m_flow_turbulent),
           simplified=m_flow_nominal_pos*dp/dp_nominal_pos);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        dp=<span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(
           actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow</span>(
                  m_flow=m_flow, k=k,
                  m_flow_turbulent=m_flow_turbulent),
           simplified=dp_nominal_pos*m_flow/m_flow_nominal_pos);
       <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;">  // from_dp</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span><span style="color: #006400; font-weight: normal; font-style: normal;"> // do not use homotopy</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>from_dp<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        m_flow=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_dp</span>(
                 dp=dp, k=k, m_flow_turbulent=m_flow_turbulent);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        dp=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow</span>(
                 m_flow=m_flow, k=k, m_flow_turbulent=m_flow_turbulent);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;">  // from_dp</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;"> // homotopyInitialization</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;"> // linearized</span>
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialDamperExponential;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialThreeWayValve<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators8b7314e2935a9e36ValveI.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.PartialThreeWayValve</h2>
<p>
<b>Partial three way valve</b>
<br>
<br><img src="Buildings.Fluid.Actuators8b7314e2935a9e36ValveD.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve">
</p>
<h3>Information</h3>

<p>
Partial model of a three way valve. This is the base model for valves
with different opening characteristics, such as linear, equal percentage
or quick opening. The three way valve model consists of a mixer where
valves are placed in two of the flow legs. The third flow leg
has no friction.
The flow coefficient <code>Kv</code> for flow from <code>port_1 &rarr; port_2</code> is
a parameter.
The flow coefficient for the bypass flow from <code>port_3 &rarr; port_2</code>
is computed as
</p>
<pre>
         Kv(port_3 &rarr; port_2)
  fraK = ----------------------
         Kv(port_1 &rarr; port_2)
</pre>
<p>
where <code>0 &lt; fraK &le; 1</code> is a parameter with a default value
of <code>fraK=0.7</code>.
</p>
<p>
Since this model uses two way valves to construct a three way valve, see
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>
for details regarding the valve implementation.
</p>

<p>Extends from <a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialThreeWayResistance"
>Buildings.Fluid.BaseClasses.PartialThreeWayResistance</a> (Flow splitter with partial resistance model at each port), <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"
>Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal</a> (Partial model that implements the filtered opening for valves and dampers), <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ValveParameters"
>Buildings.Fluid.Actuators.BaseClasses.ValveParameters</a> (Model with parameters for valves).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>fraK</td><td>0.7</td><td>Fraction Kv(port_3&amp;rarr;port_2)/Kv(port_1&amp;rarr;port_2)</td></tr>
<tr><td>Real</td><td>l[2]</td><td>{0,0}</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal[2]</td><td>{0,0}</td><td>Nominal pressure drop of pipes and other equipment in flow legs at port_1 and port_3 [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Boolean</td><td>dynamicBalance</td><td>true</td><td>Set to true to use a dynamic balance, which often leads to smaller systems of equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>mDyn_flow_nominal</td><td>m_flow_nominal</td><td>Nominal mass flow rate for dynamic momentum and energy balance [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>10</td><td>Time constant at nominal flow for dynamic energy and momentum balance [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>true</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_1</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_1</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_2</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_2</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_3</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_3</td></tr>
<tr><td>Boolean</td><td>linearized[2]</td><td>{false,false}</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_1</td><td>First port, typically inlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_2</td><td>Second port, typically outlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_3</td><td>Third port, can be either inlet or outlet</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialThreeWayValve <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Partial three way valve&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialThreeWayResistance"
>Buildings.Fluid.BaseClasses.PartialThreeWayResistance</a>(
      <span style="color: blue; font-weight: normal; font-style: normal;">final </span>mDyn_flow_nominal = m_flow_nominal,
        <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>
            res1 <span style="color: blue; font-weight: normal; font-style: normal;">constrainedby </span>
      Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve(
               deltaM=deltaM,
               dp(start=dpValve_nominal/2),
               from_dp=from_dp,
               <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>l=l[1],
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearized=linearized[1],
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>CvData=Buildings.Fluid.Types.CvTypes.OpPoint,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=m_flow_nominal,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dpValve_nominal=dpValve_nominal,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dpFixed_nominal=dpFixed_nominal[1],
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>filteredOpening=false),
        <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.LosslessPipe"
>FixedResistances.LosslessPipe</a> res2(
          <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>, m_flow_nominal=m_flow_nominal),
        <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>
            res3 <span style="color: blue; font-weight: normal; font-style: normal;">constrainedby </span>
      Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve(
               deltaM=deltaM,
               dp(start=dpValve_nominal/2),
               from_dp=from_dp,
               <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>l=l[2],
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearized=linearized[2],
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>CvData=Buildings.Fluid.Types.CvTypes.OpPoint,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=m_flow_nominal,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dpValve_nominal=dpValve_nominal/fraK^2,
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dpFixed_nominal=dpFixed_nominal[2],
               <span style="color: blue; font-weight: normal; font-style: normal;">final </span>filteredOpening=false));
    <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"
>Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal</a>;
    <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ValveParameters"
>Buildings.Fluid.Actuators.BaseClasses.ValveParameters</a>(
      rhoStd=<span style="color: red; font-weight: normal; font-style: normal;">Medium.density_pTX</span>(101325, 273.15+4, Medium.X_default));
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dpFixed_nominal[2](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>displayUnit=&quot;Pa&quot;,
                                                         <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) = {0, 0} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal pressure drop of pipes and other equipment in flow legs at port_1 and port_3&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real fraK(min=0, max=1) = 0.7 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction Kv(port_3&amp;rarr;port_2)/Kv(port_1&amp;rarr;port_2)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real[2] l(<span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) = {0, 0} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Valve leakage, l=Kv(y=0)/Kv(y=1)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real deltaM = 0.02 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of nominal flow rate where linearization starts, if y=1&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean[2] linearized = {false, false} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</a> inv <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Inversion of control signal&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Constant"
>Modelica.Blocks.Sources.Constant</a> uni(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>k=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outputs one for bypass valve&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(uni.y, inv.u1);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialThreeWayValve;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialTwoWayValve<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators8f28c1b0799bc0dcValveI.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.PartialTwoWayValve</h2>
<p>
<b>Partial model for a two way valve</b>
<br>
<br><img src="Buildings.Fluid.Actuators8f28c1b0799bc0dcValveD.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve">
</p>
<h3>Information</h3>

<p>
Partial model for a two way valve. This is the base model for valves
with different opening characteristics, such as linear, equal percentage,
quick opening or pressure-independent.
</p>
<p>
To prevent the derivative <code>d/dP (m_flow)</code> to be infinite near
the origin, this model linearizes the pressure drop versus flow relation
ship. The region in which it is linearized is parameterized by
</p>
<pre>
  m_turbulent_flow = deltaM * m_flow_nominal
</pre>
<p>
Because the parameterization contains <code>Kv_SI</code>, the values for
<code>deltaM</code> and <code>dp_nominal</code> need not be changed if the valve size
changes.
</p>
<p>
In contrast to the model in <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid.html#Modelica.Fluid"
>
Modelica.Fluid</a>, this model uses the parameter <code>Kv_SI</code>,
which is the flow coefficient in SI units, i.e.,
it is the ratio between mass flow rate in <code>kg/s</code> and square root
of pressure drop in <code>Pa</code>.
</p>
<h4>Modelling options</h4>
<p>
This model allows different parameterization of the flow resistance.
The different parameterizations are described in
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ValveParameters"
>
Buildings.Fluid.Actuators.BaseClasses.ValveParameters</a>.
</p>
<h4>Implementation</h4>
<p>
The two way valve models are implemented using this partial model, as opposed to using
different functions for the valve opening characteristics, because
each valve opening characteristics has different parameters.
</p>

<p>Extends from <a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialResistance"
>Buildings.Fluid.BaseClasses.PartialResistance</a> (Partial model for a hydraulic resistance), <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ValveParameters"
>Buildings.Fluid.Actuators.BaseClasses.ValveParameters</a> (Model with parameters for valves), <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"
>Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal</a> (Partial model that implements the filtered opening for valves and dampers).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_turbulent</td><td>deltaM*abs(m_flow_nominal)</td><td>Turbulent flow if |m_flow| &gt;= m_flow_turbulent [kg/s]</td></tr>
<tr><td>Real</td><td>l</td><td>0.0001</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>dpValve_nominal + dpFixed_no...</td><td>Pressure drop at nominal mass flow rate [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal</td><td>0</td><td>Pressure drop of pipe and other resistances that are in series [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialTwoWayValve <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Partial model for a two way valve&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialResistance"
>Buildings.Fluid.BaseClasses.PartialResistance</a>(
       <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_nominal=dpValve_nominal + dpFixed_nominal,
       dp(nominal=6000),
       <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_turbulent = deltaM *<span style="color: red; font-weight: normal; font-style: normal;"> abs</span>(m_flow_nominal));

  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ValveParameters"
>Buildings.Fluid.Actuators.BaseClasses.ValveParameters</a>(
      rhoStd=<span style="color: red; font-weight: normal; font-style: normal;">Medium.density_pTX</span>(101325, 273.15+4, Medium.X_default));

  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal"
>Buildings.Fluid.Actuators.BaseClasses.ActuatorSignal</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dpFixed_nominal(displayUnit=&quot;Pa&quot;, min=0) = 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure drop of pipe and other resistances that are in series&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real l(min=1e-10, max=1) = 0.0001 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Valve leakage, l=Kv(y=0)/Kv(y=1)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real phi <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Ratio actual to nominal mass flow rate of valve, phi=Kv(y)/Kv(y=1)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real kFixed(unit=&quot;&quot;, min=0) = <span style="color: blue; font-weight: normal; font-style: normal;">if </span>dpFixed_nominal &gt; Modelica.Constants.eps<span style="color: blue; font-weight: normal; font-style: normal;">
    then </span>m_flow_nominal /<span style="color: red; font-weight: normal; font-style: normal;"> sqrt</span>(dpFixed_nominal)<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient of fixed resistance that may be in series with valve, k=m_flow/sqrt(dp), with unit=(kg.m)^(1/2).&quot;</span>;
 Real kVal(unit=&quot;&quot;, min=Modelica.Constants.small) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient of valve, k=m_flow/sqrt(dp), with unit=(kg.m)^(1/2).&quot;</span>;
 Real k(unit=&quot;&quot;, min=Modelica.Constants.small) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient of valve and pipe in series, k=m_flow/sqrt(dp), with unit=(kg.m)^(1/2).&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(dpFixed_nominal &gt; -Modelica.Constants.small, &quot;Require dpFixed_nominal &gt;= 0. Received dpFixed_nominal = &quot;
        +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(dpFixed_nominal) + &quot; Pa.&quot;);

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialTwoWayValve;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialTwoWayValveKv<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators8f28c1b0799bc0dcValveI.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.PartialTwoWayValveKv</h2>
<p>
<b>Partial model for a two way valve using a Kv characteristic</b>
<br>
<br><img src="Buildings.Fluid.Actuators8f28c1b0799bc0dcValveD.png" alt="Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv">
</p>
<h3>Information</h3>

<p>
Partial model for valves with different opening characteristics,
such as linear, equal percentage or quick opening. This partial extends from
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>PartialTwoWayValve</a>
and also contains the governing equations for these three two way valve models.
</p>
<h4>Implementation</h4>
<p>
Models that extend this model need to provide a binding equation
for the flow function <code>phi</code>.
An example of such a code can be found in
<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayLinear"
>
Buildings.Fluid.Actuators.Valves.TwoWayLinear</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a> (Partial model for a two way valve).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>l</td><td>0.0001</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal</td><td>0</td><td>Pressure drop of pipe and other resistances that are in series [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialTwoWayValveKv <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model for a two way valve using a Kv characteristic&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
 kVal = phi*Kv_SI;
 <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(dpFixed_nominal &gt; Modelica.Constants.eps)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
   k =<span style="color: red; font-weight: normal; font-style: normal;"> sqrt</span>(1/(1/kFixed^2 + 1/kVal^2));
 <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
   k = kVal;
 <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

 <span style="color: blue; font-weight: normal; font-style: normal;">if </span>linearized<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
   <span style="color: #006400; font-weight: normal; font-style: normal;">// This implementation yields m_flow_nominal = phi*kv_SI * sqrt(dp_nominal)</span>
   <span style="color: #006400; font-weight: normal; font-style: normal;">// if m_flow = m_flow_nominal and dp = dp_nominal</span>
   m_flow*m_flow_nominal_pos = k^2 * dp;
 <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
   <span style="color: blue; font-weight: normal; font-style: normal;">if </span>homotopyInitialization<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
     <span style="color: blue; font-weight: normal; font-style: normal;">if </span>from_dp<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
         m_flow=<span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_dp</span>(dp=dp, k=k,
                                m_flow_turbulent=m_flow_turbulent),
                                simplified=m_flow_nominal_pos*dp/dp_nominal_pos);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
         dp=<span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow</span>(m_flow=m_flow, k=k,
                                m_flow_turbulent=m_flow_turbulent),
                                simplified=dp_nominal_pos*m_flow/m_flow_nominal_pos);
     <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
   <span style="color: blue; font-weight: normal; font-style: normal;">else</span><span style="color: #006400; font-weight: normal; font-style: normal;"> // do not use homotopy</span>
     <span style="color: blue; font-weight: normal; font-style: normal;">if </span>from_dp<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
       m_flow=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_dp</span>(dp=dp, k=k,
                                m_flow_turbulent=m_flow_turbulent);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        dp=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow</span>(m_flow=m_flow, k=k,
                                m_flow_turbulent=m_flow_turbulent);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;"> // homotopyInitialization</span>
 <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;"> // linearized</span>
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialTwoWayValveKv;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ValveParameters<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Actuators.BaseClasses.ValveParameters"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.ValveParameters</h2>
<p>
<b>Model with parameters for valves</b>
</p>
<h3>Information</h3>

<p>
Model that computes the flow coefficients of valves. This base class allows the following modeling options,
which have been adapted from the valve implementation
in <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid.html#Modelica.Fluid"
>
Modelica.Fluid</a>
to specify the valve flow coefficient in fully open conditions:
</p>
<ul>
<li><code>CvData = Buildings.Fluid.Types.CvTypes.Av</code>: the flow coefficient is given by the metric <code>Av</code> coefficient (m^2).</li>
<li><code>CvData = Buildings.Fluid.Types.CvTypes.Kv</code>: the flow coefficient is given by the metric <code>Kv</code> coefficient (m^3/h).</li>
<li><code>CvData = Buildings.Fluid.Types.CvTypes.Cv</code>: the flow coefficient is given by the US <code>Cv</code> coefficient (USG/min).</li>
<li><code>CvData = Buildings.Fluid.Types.CvTypes.OpPoint</code>: the flow is computed from the nominal operating point specified by <code>dp_nominal</code> and <code>m_flow_nominal</code>.</li>
</ul>
<p>
The treatment of parameters <code>Kv</code> and <code>Cv</code> is
explained in detail in the
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_UsersGuide_ComponentDefinition.html#Modelica.Fluid.UsersGuide.ComponentDefinition.ValveCharacteristics"
>Users Guide</a>.
</p>
<p>
In contrast to the model in <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid.html#Modelica.Fluid"
>
Modelica.Fluid</a>, this model uses the protected parameter <code>Kv_SI</code>,
which is the flow coefficient in SI units, i.e.,
it is the ratio between mass flow rate in <code>kg/s</code> and square root
of pressure drop in <code>Pa</code>.
The value of <code>Kv_SI</code> is computed based on the parameters
<code>Av</code>,
<code>Kv</code>,
<code>Cv</code>, or, if
<code>CvData = Buildings.Fluid.Types.CvTypes.OpPoint</code>, based on
<code>m_flow_nominal</code> and <code>dpValve_nominal</code>.
Conversely, if
<code>CvData &lt;&gt; Buildings.Fluid.Types.CvTypes.OpPoint</code>, then
<code>dpValve_nominal</code> is computed based on
<code>Av</code>,
<code>Kv</code>, or
<code>Cv</code>, and the nominal mass flow rate <code>m_flow_nominal</code>.
Therefore, if
<code>CvData &lt;&gt; Buildings.Fluid.Types.CvTypes.OpPoint</code>,
then specifying a value for <code>dpValve_nominal</code> is a syntax error.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>&nbsp;</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ValveParameters <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Model with parameters for valves&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>Buildings.Fluid.Types.CvTypes</a> CvData=Buildings.Fluid.Types.CvTypes.OpPoint <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Selection of flow coefficient&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real Kv(
    fixed= <span style="color: blue; font-weight: normal; font-style: normal;">if </span>CvData==Buildings.Fluid.Types.CvTypes.Kv<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>true<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real Cv(
    fixed= <span style="color: blue; font-weight: normal; font-style: normal;">if </span>CvData==Buildings.Fluid.Types.CvTypes.Cv<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>true<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Cv (US) flow coefficient [USG/min/(psi)^(1/2)]&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> Av(
    fixed= <span style="color: blue; font-weight: normal; font-style: normal;">if </span>CvData==Buildings.Fluid.Types.CvTypes.Av<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>true<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Av (metric) flow coefficient&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real deltaM = 0.02 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of nominal flow rate where linearization starts, if y=1&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dpValve_nominal(displayUnit=&quot;Pa&quot;,
                                                      min=0,
                                                      fixed= <span style="color: blue; font-weight: normal; font-style: normal;">if </span>CvData==Buildings.Fluid.Types.CvTypes.OpPoint<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>true<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rhoStd <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Inlet density for which valve coefficients are defined&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real Kv_SI(
    min=0,
    fixed= false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient for fully open valve in SI units, Kv=m_flow/sqrt(dp) [kg/s/(Pa)^(1/2)]&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span> CvData == Buildings.Fluid.Types.CvTypes.OpPoint<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    Kv_SI =           m_flow_nominal/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(dpValve_nominal);
    Kv    =           Kv_SI/(rhoStd/3600/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(1E5));
    Cv    =           Kv_SI/(rhoStd*0.0631/1000/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(6895));
    Av    =           Kv_SI/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(rhoStd);
  <span style="color: blue; font-weight: normal; font-style: normal;">elseif </span>CvData == Buildings.Fluid.Types.CvTypes.Kv<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    Kv_SI =           Kv*rhoStd/3600/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(1E5) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Unit conversion m3/(h*sqrt(bar)) to kg/(s*sqrt(Pa))&quot;</span>;
    Cv    =           Kv_SI/(rhoStd*0.0631/1000/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(6895));
    Av    =           Kv_SI/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(rhoStd);
    dpValve_nominal =  (m_flow_nominal/Kv_SI)^2;
  <span style="color: blue; font-weight: normal; font-style: normal;">elseif </span>CvData == Buildings.Fluid.Types.CvTypes.Cv<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    Kv_SI =           Cv*rhoStd*0.0631/1000/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(6895) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Unit conversion USG/(min*sqrt(psi)) to kg/(s*sqrt(Pa))&quot;</span>;
    Kv    =           Kv_SI/(rhoStd/3600/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(1E5));
    Av    =           Kv_SI/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(rhoStd);
    dpValve_nominal =  (m_flow_nominal/Kv_SI)^2;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(CvData == Buildings.Fluid.Types.CvTypes.Av, &quot;Invalid value for CvData.
Obtained CvData = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(CvData) + &quot;.&quot;);
    Kv_SI =           Av*<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(rhoStd);
    Kv    =           Kv_SI/(rhoStd/3600/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(1E5));
    Cv    =           Kv_SI/(rhoStd*0.0631/1000/<span style="color: red; font-weight: normal; font-style: normal;">sqrt</span>(6895));
    dpValve_nominal =  (m_flow_nominal/Kv_SI)^2;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ValveParameters;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE der_equalPercentage<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Actuators.BaseClasses.der_equalPercentage"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.der_equalPercentage</h2>
<p>
<b>Derivative of valve opening characteristics for equal percentage valve</b>
</p>
<h3>Information</h3>

<p>
This function computes the derivative of the opening characteristics of an equal percentage valve.
</p><p>
The function is the derivative of
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.equalPercentage"
>
TwoWayValveEqualPercentage</a>.
</p>

<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Real</td><td>y</td><td>&nbsp;</td><td>Valve opening signal, y=1 is fully open</td></tr>
<tr><td>Real</td><td>R</td><td>&nbsp;</td><td>Rangeability, R=50...100 typically</td></tr>
<tr><td>Real</td><td>l</td><td>&nbsp;</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>delta</td><td>&nbsp;</td><td>Range of significant deviation from equal percentage law</td></tr>
<tr><td>Real</td><td>der_y</td><td>&nbsp;</td><td>Derivative of valve opening signal</td></tr>
</table>
<h3>Outputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Outputs">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>Real</td><td>der_phi</td><td>Derivative of ratio actual to nominal mass flow rate, dphi/dy</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> der_equalPercentage <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Derivative of valve opening characteristics for equal percentage valve&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real y <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Valve opening signal, y=1 is fully open&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real R <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Rangeability, R=50...100 typically&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real l(min=0, max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Valve leakage, l=Kv(y=0)/Kv(y=1)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real delta <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Range of significant deviation from equal percentage law&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real der_y <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Derivative of valve opening signal&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real der_phi <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Derivative of ratio actual to nominal mass flow rate, dphi/dy&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
   Real a <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficient&quot;</span>;
   Real b <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficient&quot;</span>;
   Real c <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficient&quot;</span>;
   Real logR <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;=log(R)&quot;</span>;
   Real z <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable&quot;</span>;
   Real q <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable&quot;</span>;
   Real p <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>y &lt; delta/2<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    der_phi := (R^(delta-1) - l) / delta * der_y;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(y &gt; (3/2 * delta))<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      der_phi := R^(y-1)*<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(R) * der_y;
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      logR :=<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Math.log</span>(R);
      z := (3*delta/2);
      q := delta*R^z*logR;
      p := R^z;
      a := (q - 2*p + 2*R^delta)/(delta^3*R);
      b := (-5*q + 12*p - 13*R^delta + l*R)/(2*delta^2*R);
      c := (7*q - 18*p + 24*R^delta - 6*l*R)/(4*delta*R);
      der_phi  := (c + y * ( 2*b + 3*a*y)) * der_y;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>der_equalPercentage;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE equalPercentage<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Actuators.BaseClasses.equalPercentage"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.equalPercentage</h2>
<p>
<b>Valve opening characteristics for equal percentage valve</b>
</p>
<h3>Information</h3>

<p>
This function computes the opening characteristics of an equal percentage valve.
</p><p>
The function is used by the model
<a href="modelica://Buildings.Fluid.Actuators.TwoWayValveEqualPercentage">
TwoWayValveEqualPercentage</a>.
</p><p>
For <code>y &lt; delta/2</code>, the valve characteristics is linear. For <code> y &gt; 3*delta/2</code>
the valve characteristics is equal percentage. In between, a cubic spline is used to ensure
that the valve characteristics is once continuously differentiable with respect to <code>y</code>.
</p>

<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Real</td><td>y</td><td>&nbsp;</td><td>Valve opening signal, y=1 is fully open</td></tr>
<tr><td>Real</td><td>R</td><td>&nbsp;</td><td>Rangeability, R=50...100 typically</td></tr>
<tr><td>Real</td><td>l</td><td>&nbsp;</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>delta</td><td>&nbsp;</td><td>Range of significant deviation from equal percentage law</td></tr>
</table>
<h3>Outputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Outputs">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>Real</td><td>phi</td><td>Ratio actual to nominal mass flow rate, phi=Cv(y)/Cv(y=1)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> equalPercentage <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Valve opening characteristics for equal percentage valve&quot;</span>
  annotation(derivative=<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.der_equalPercentage"
>der_equalPercentage</a>);

  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real y <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Valve opening signal, y=1 is fully open&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real R <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Rangeability, R=50...100 typically&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real l(min=0, max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Valve leakage, l=Kv(y=0)/Kv(y=1)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real delta <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Range of significant deviation from equal percentage law&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real phi <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Ratio actual to nominal mass flow rate, phi=Cv(y)/Cv(y=1)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
   Real a <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficient&quot;</span>;
   Real b <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficient&quot;</span>;
   Real c <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficient&quot;</span>;
   Real d <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficient&quot;</span>;
   Real logR <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;=log(R)&quot;</span>;
   Real z <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable&quot;</span>;
   Real q <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable&quot;</span>;
   Real p <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>y &lt; delta/2<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    phi := l + y * (R^(delta-1) - l) / delta;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(y &gt; (3/2 * delta))<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      phi := R^(y-1);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      logR :=<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Math.log</span>(R);
      z := (3*delta/2);
      q := delta*R^z*logR;
      p := R^z;
      a := (q - 2*p + 2*R^delta)/(delta^3*R);
      b := (-5*q + 12*p - 13*R^delta + l*R)/(2*delta^2*R);
      c := (7*q - 18*p + 24*R^delta - 6*l*R)/(4*delta*R);
      d := (-3*q + 8*p - 9*R^delta + 9*l*R)/(8*R);
      phi  := d + y * ( c + y * ( b + y * a));
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>equalPercentage;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE exponentialDamper<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Actuators.BaseClasses.exponentialDamper"></a><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses"
>Buildings.Fluid.Actuators.BaseClasses</a>.exponentialDamper</h2>
<p>
<b>Damper opening characteristics for an exponential damper</b>
</p>
<h3>Information</h3>

<p>
This function computes the opening characteristics of an exponential damper.
</p><p>
The function is used by the model
<a href="Buildings_Fluid_Actuators_Dampers.html#Buildings.Fluid.Actuators.Dampers.Exponential"
>
Buildings.Fluid.Actuators.Dampers.Exponential</a>.
</p><p>
For <code>yL &lt; y &lt; yU</code>, the damper characteristics is
</p>
<p align="center" style="font-style:italic;">
  k<sub>d</sub>(y) = exp(a+b (1-y)).
</p>
<p>
Outside this range, the damper characteristic is defined by a quadratic polynomial.
</p>
<p>
Note that this implementation returns <i>sqrt(k<sub>d</sub>(y))</i> instead of <i>k<sub>d</sub>(y)</i>.
This is done for numerical reason since otherwise <i>k<sub>d</sub>(y)</i> may be an iteration
variable, which may cause a lot of warnings and slower convergence if the solver
attempts <i>k<sub>d</sub>(y) &lt; 0</i> during the iterative solution procedure.
</p>

<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Real</td><td>y</td><td>&nbsp;</td><td>Control signal, y=0 is closed, y=1 is open</td></tr>
<tr><td>Real</td><td>a</td><td>&nbsp;</td><td>Coefficient a for damper characteristics</td></tr>
<tr><td>Real</td><td>b</td><td>&nbsp;</td><td>Coefficient b for damper characteristics</td></tr>
<tr><td>Real</td><td>cL[3]</td><td>&nbsp;</td><td>Polynomial coefficients for curve fit for y &lt; yl</td></tr>
<tr><td>Real</td><td>cU[3]</td><td>&nbsp;</td><td>Polynomial coefficients for curve fit for y &gt; yu</td></tr>
<tr><td>Real</td><td>yL</td><td>&nbsp;</td><td>Lower value for damper curve</td></tr>
<tr><td>Real</td><td>yU</td><td>&nbsp;</td><td>Upper value for damper curve</td></tr>
</table>
<h3>Outputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Outputs">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>Real</td><td>kThetaSqRt</td><td>Flow coefficient, kThetaSqRT = =sqrt(kTheta) = sqrt(pressure drop/dynamic pressure)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> exponentialDamper <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Damper opening characteristics for an exponential damper&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real y(min=0, max=1, unit=&quot;&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Control signal, y=0 is closed, y=1 is open&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real a(unit=&quot;&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Coefficient a for damper characteristics&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real b(unit=&quot;&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Coefficient b for damper characteristics&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real[3] cL <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficients for curve fit for y &lt; yl&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real[3] cU <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Polynomial coefficients for curve fit for y &gt; yu&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real yL <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Lower value for damper curve&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real yU <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Upper value for damper curve&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real kThetaSqRt(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow coefficient, kThetaSqRT = =sqrt(kTheta) = sqrt(pressure drop/dynamic pressure)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  Real yC(min=0, max=1, unit=&quot;&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;y constrained to 0 &lt;= y &lt;= 1 to avoid numerical problems&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>y &lt; yL<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    yC :=<span style="color: red; font-weight: normal; font-style: normal;">max</span>(0, y);
    kThetaSqRt :=<span style="color: red; font-weight: normal; font-style: normal;"> sqrt</span>(<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.exp</span>(cL[3] + yC * (cL[2] + yC * cL[1])));
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(y &gt; yU)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      yC :=<span style="color: red; font-weight: normal; font-style: normal;"> min</span>(1, y);
      kThetaSqRt :=<span style="color: red; font-weight: normal; font-style: normal;"> sqrt</span>(<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.exp</span>(cU[3] + yC * (cU[2] + yC * cU[1])));
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      kThetaSqRt :=<span style="color: red; font-weight: normal; font-style: normal;"> sqrt</span>(<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.exp</span>(a+b*(1-y))) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;y=0 is closed&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>exponentialDamper;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:23:53 2015.
</address>
</body>
</html>
