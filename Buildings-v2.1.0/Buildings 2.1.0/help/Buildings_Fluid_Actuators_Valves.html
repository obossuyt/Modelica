<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Fluid.Actuators.Valves</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with valve models&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Valves<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Actuators.Valves"></a><a href="Buildings_Fluid_Actuators.html#Buildings.Fluid.Actuators"
>Buildings.Fluid.Actuators</a>.Valves</h2>
<p>
<b>Package with valve models</b><br>
</p>
<h3>Information</h3>

This package contains components models for two- and three-way valves.
For motor models, see
<a href="Buildings_Fluid_Actuators_Motors.html#Buildings.Fluid.Actuators.Motors"
>Buildings.Fluid.Actuators.Motors</a>.

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_VariantsPackage.html#Modelica.Icons.VariantsPackage"
>Modelica.Icons.VariantsPackage</a> (Icon for package containing variants).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators4de2da5e42559417inearS.png" alt="Buildings.Fluid.Actuators.Valves.ThreeWayEqualPercentageLinear" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.ThreeWayEqualPercentageLinear"
>ThreeWayEqualPercentageLinear</a>
</td>
<td>Three way valve with equal percentage and linear characteristics</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators4de2da5e42559417inearS.png" alt="Buildings.Fluid.Actuators.Valves.ThreeWayLinear" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.ThreeWayLinear"
>ThreeWayLinear</a>
</td>
<td>Three way valve with linear characteristics</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators456e270330611c66ntageS.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayEqualPercentage" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayEqualPercentage"
>TwoWayEqualPercentage</a>
</td>
<td>Two way valve with linear flow characteristics</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators456e270330611c66ntageS.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayLinear" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayLinear"
>TwoWayLinear</a>
</td>
<td>Two way valve with linear flow characteristics</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators8cb7bcfeadb96292ndentS.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayPressureIndependent" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayPressureIndependent"
>TwoWayPressureIndependent</a>
</td>
<td>Model of a pressure-independent two way valve</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuatorsa44f6f3648a352efeningS.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayQuickOpening" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayQuickOpening"
>TwoWayQuickOpening</a>
</td>
<td>Two way valve with linear flow characteristics</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuatorse3820fe79d829284TableS.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayTable" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayTable"
>TwoWayTable</a>
</td>
<td>Two way valve with linear flow characteristics</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators.Valves.DataS.png" alt="Buildings.Fluid.Actuators.Valves.Data" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves_Data.html#Buildings.Fluid.Actuators.Valves.Data"
>Data</a>
</td>
<td>Data files for valves</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Actuators00f3b269f16b49bfmplesS.png" alt="Buildings.Fluid.Actuators.Valves.Examples" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Actuators_Valves_Examples.html#Buildings.Fluid.Actuators.Valves.Examples"
>Examples</a>
</td>
<td>Collection of models that illustrate model use and test models</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ThreeWayEqualPercentageLinear<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators4de2da5e42559417inearI.png" alt="Buildings.Fluid.Actuators.Valves.ThreeWayEqualPercentageLinear" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.Valves.ThreeWayEqualPercentageLinear"></a><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves"
>Buildings.Fluid.Actuators.Valves</a>.ThreeWayEqualPercentageLinear</h2>
<p>
<b>Three way valve with equal percentage and linear characteristics</b>
<br>
<br><img src="Buildings.Fluid.Actuators4de2da5e42559417inearD.png" alt="Buildings.Fluid.Actuators.Valves.ThreeWayEqualPercentageLinear">
</p>
<h3>Information</h3>

<p>
Three way valve with equal percentage characteristics
between <code>port_1</code> and <code>port_2</code>
and linear opening characteristic between <code>port_1</code> and <code>port_2</code>.
Such opening characteristics were typical for valves from Landis &amp; Gyr (now
Siemens).
</p><p>
This model is based on the partial valve models
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve</a> and
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>.
See
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve</a>
for the implementation of the three way valve
and see
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>
for the implementation of the regularization near the origin.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>BaseClasses.PartialThreeWayValve</a> (Partial three way valve).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>fraK</td><td>0.7</td><td>Fraction Kv(port_3&amp;rarr;port_2)/Kv(port_1&amp;rarr;port_2)</td></tr>
<tr><td>Real</td><td>l[2]</td><td>{0,0}</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>R</td><td>50</td><td>Rangeability, R=50...100 typically</td></tr>
<tr><td>Real</td><td>delta0</td><td>0.01</td><td>Range of significant deviation from equal percentage law</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal[2]</td><td>{0,0}</td><td>Nominal pressure drop of pipes and other equipment in flow legs at port_1 and port_3 [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Boolean</td><td>dynamicBalance</td><td>true</td><td>Set to true to use a dynamic balance, which often leads to smaller systems of equations</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>10</td><td>Time constant at nominal flow for dynamic energy and momentum balance [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>true</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_1</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_1</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_2</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_2</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_3</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_3</td></tr>
<tr><td>Boolean</td><td>linearized[2]</td><td>{false,false}</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_1</td><td>First port, typically inlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_2</td><td>Second port, typically outlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_3</td><td>Third port, can be either inlet or outlet</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ThreeWayEqualPercentageLinear <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Three way valve with equal percentage and linear characteristics&quot;</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>BaseClasses.PartialThreeWayValve</a>(
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayEqualPercentage"
>TwoWayEqualPercentage</a> res1(R=R, delta0=delta0),
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayLinear"
>TwoWayLinear</a> res3);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real R = 50 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Rangeability, R=50...100 typically&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real delta0 = 0.01 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Range of significant deviation from equal percentage law&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(inv.y, res3.y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(y_actual, inv.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(y_actual, res1.y);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ThreeWayEqualPercentageLinear;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ThreeWayLinear<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators4de2da5e42559417inearI.png" alt="Buildings.Fluid.Actuators.Valves.ThreeWayLinear" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.Valves.ThreeWayLinear"></a><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves"
>Buildings.Fluid.Actuators.Valves</a>.ThreeWayLinear</h2>
<p>
<b>Three way valve with linear characteristics</b>
<br>
<br><img src="Buildings.Fluid.Actuatorsd8cd0dbeeb5ee13cinearD.png" alt="Buildings.Fluid.Actuators.Valves.ThreeWayLinear">
</p>
<h3>Information</h3>

<p>
Three way valve with linear opening characteristic.
</p><p>
This model is based on the partial valve models
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve</a> and
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>.
See
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve</a>
for the implementation of the three way valve
and see
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>
for the implementation of the regularization near the origin.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>BaseClasses.PartialThreeWayValve</a> (Partial three way valve).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>fraK</td><td>0.7</td><td>Fraction Kv(port_3&amp;rarr;port_2)/Kv(port_1&amp;rarr;port_2)</td></tr>
<tr><td>Real</td><td>l[2]</td><td>{0,0}</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal[2]</td><td>{0,0}</td><td>Nominal pressure drop of pipes and other equipment in flow legs at port_1 and port_3 [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Boolean</td><td>dynamicBalance</td><td>true</td><td>Set to true to use a dynamic balance, which often leads to smaller systems of equations</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>10</td><td>Time constant at nominal flow for dynamic energy and momentum balance [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>true</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_1</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_1</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_2</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_2</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_3</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_3</td></tr>
<tr><td>Boolean</td><td>linearized[2]</td><td>{false,false}</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_1</td><td>First port, typically inlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_2</td><td>Second port, typically outlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_3</td><td>Third port, can be either inlet or outlet</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ThreeWayLinear <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Three way valve with linear characteristics&quot;</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialThreeWayValve"
>BaseClasses.PartialThreeWayValve</a>(
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayLinear"
>TwoWayLinear</a> res1,
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayLinear"
>TwoWayLinear</a> res3);

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(inv.y, res3.y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(y_actual, inv.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(y_actual, res1.y);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ThreeWayLinear;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoWayEqualPercentage<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators456e270330611c66ntageI.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayEqualPercentage" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.Valves.TwoWayEqualPercentage"></a><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves"
>Buildings.Fluid.Actuators.Valves</a>.TwoWayEqualPercentage</h2>
<p>
<b>Two way valve with linear flow characteristics</b>
<br>
<br><img src="Buildings.Fluid.Actuators456e270330611c66ntageD.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayEqualPercentage">
</p>
<h3>Information</h3>

<p>
Two way valve with an equal percentage valve opening characteristic.
</p><p>
This model is based on the partial valve model
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>.
Check this model for more information, such
as the regularization near the origin.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a> (Partial model for a two way valve using a Kv characteristic).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>l</td><td>0.0001</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>phi</td><td>if homotopyInitialization th...</td><td>Ratio actual to nominal mass flow rate of valve, phi=Kv(y)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>R</td><td>50</td><td>Rangeability, R=50...100 typically</td></tr>
<tr><td>Real</td><td>delta0</td><td>0.01</td><td>Range of significant deviation from equal percentage law</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal</td><td>0</td><td>Pressure drop of pipe and other resistances that are in series [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> TwoWayEqualPercentage <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Two way valve with linear flow characteristics&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a>(phi=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>homotopyInitialization<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>
        <span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.Actuators.BaseClasses.equalPercentage</span>(
        y_actual,
        R,
        l,
        delta0), simplified=l + y_actual*(1 - l))<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
        <span style="color: red; font-weight: normal; font-style: normal;">Buildings.Fluid.Actuators.BaseClasses.equalPercentage</span>(
        y_actual,
        R,
        l,
        delta0));
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real R=50 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Rangeability, R=50...100 typically&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real delta0=0.01 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Range of significant deviation from equal percentage law&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Since the flow model Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow computes</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// 1/k^2, the parameter l must not be zero.</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(l &gt; 0, &quot;Valve leakage parameter l must be bigger than zero.&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(l &lt; 1/R, &quot;Wrong parameters in valve model.\n&quot;
                + &quot;  Rangeability R = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(R) + &quot;\n&quot;
                + &quot;  Leakage flow l = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(l) + &quot;\n&quot;
                + &quot;  Must have l &lt; 1/R = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(1/R));
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>TwoWayEqualPercentage;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoWayLinear<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators456e270330611c66ntageI.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayLinear" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.Valves.TwoWayLinear"></a><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves"
>Buildings.Fluid.Actuators.Valves</a>.TwoWayLinear</h2>
<p>
<b>Two way valve with linear flow characteristics</b>
<br>
<br><img src="Buildings.Fluid.Actuators456e270330611c66ntageD.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayLinear">
</p>
<h3>Information</h3>

<p>
Two way valve with linear opening characteristic.
</p><p>
This model is based on the partial valve model
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>.
Check this model for more information, such
as the regularization near the origin.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a> (Partial model for a two way valve using a Kv characteristic).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>l</td><td>0.0001</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>phi</td><td>l + y_actual*(1 - l)</td><td>Ratio actual to nominal mass flow rate of valve, phi=Kv(y)/Kv(y=1)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal</td><td>0</td><td>Pressure drop of pipe and other resistances that are in series [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> TwoWayLinear <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Two way valve with linear flow characteristics&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a>(phi=l + y_actual*(1 - l));

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Since the flow model Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow computes</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// 1/k^2, the parameter l must not be zero.</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(l &gt; 0, &quot;Valve leakage parameter l must be bigger than zero.&quot;);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>TwoWayLinear;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoWayPressureIndependent<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuators8cb7bcfeadb96292ndentI.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayPressureIndependent" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.Valves.TwoWayPressureIndependent"></a><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves"
>Buildings.Fluid.Actuators.Valves</a>.TwoWayPressureIndependent</h2>
<p>
<b>Model of a pressure-independent two way valve</b>
<br>
<br><img src="Buildings.Fluid.Actuators456e270330611c66ntageD.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayPressureIndependent">
</p>
<h3>Information</h3>

<p>
Two way valve with a pressure-independent valve opening characteristic.
The mass flow rate is controlled such that it is nearly equal to its
set point <code>y*m_flow_nominal</code>, unless the pressure
<code>dp</code> is too low, in which case a regular <code>Kv</code>
characteristic is used.
</p>
<h4>Main equations</h4>
<p>
First the minimum pressure head <code>dp_min</code>
required for delivering the requested mass flow rate
<code>y*m_flow_nominal</code> is computed. If
<code>dp &gt; dp_min</code> then the requested mass flow
rate is supplied. If <code>dp &lt; dp_min</code> then
<code>m_flow = Kv/sqrt(dp)</code>. Transition between
these two flow regimes happens in a smooth way.
</p>
<h4>Typical use and important parameters</h4>
<p>
This model is configured by setting <code>m_flow_nominal</code>
to the mass flow rate that the valve should supply when it is
completely open, i.e., <code>y = 1</code>. The pressure drop corresponding
to this working point can be set using <code>dpValve_nominal</code>,
or using a <code>Kv</code>, <code>Cv</code> or <code>Av</code>
value. The parameter <code>dpValve_fixed</code> can be used to add
additional pressure drops, although in this valve it is equivalent to
add these to <code>dpValve_nominal</code>.
</p>
<p>
The parameter <code>l2</code> represents the non-ideal
leakage behaviour of this valve for high pressures.
It is assumed that the mass flow rate will rise beyond
the requested mass flow rate <code>y*m_flow_nominal</code>
if <code>dp &gt; dpValve_nominal+dpFixed_nominal</code>.
The parameter <code>l2</code> represents the slope
of this rise:
<code>d(m_flow)/d(dp) = l2* m_flow_nominal/dp_nominal</code>.
In the ideal case <code>l2=0</code>, but
this may introduce singularities, for instance when
connecting this component with a fixed mass flow source.
</p>
<h4>Options</h4>
<p>
Parameter <code>deltax</code> sets the duration of
the transition region between the two flow regimes
as a fraction of <code>dp_nominal</code> or <code>m_flow_nominal</code>,
depending on the value of <code>from_dp</code>.
</p>
<h4>Implementation</h4>
<p>
Note that the result in the transition region when
using <code>from_dp = true</code> is not identical to
the result when using <code>from_dp = false</code>.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a> (Partial model for a two way valve).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>l</td><td>0.0001</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>phi</td><td>l + y_actual*(1 - l)</td><td>Ratio actual to nominal mass flow rate of valve, phi=Kv(y)/Kv(y=1)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal</td><td>0</td><td>Pressure drop of pipe and other resistances that are in series [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>true</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>l2</td><td>0.01</td><td>Gain for mass flow increase if pressure is above nominal pressure</td></tr>
<tr><td>Real</td><td>deltax</td><td>0.1</td><td>Transition interval for flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> TwoWayPressureIndependent <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Model of a pressure-independent two way valve&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>(
            <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearized = false,
            from_dp=true,
            phi=l + y_actual*(1 - l));

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real l2(min=1e-10) = 0.01 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Gain for mass flow increase if pressure is above nominal pressure&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real deltax = 0.1 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Transition interval for flow rate&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_set <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Requested mass flow rate&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp_min <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Minimum dp required for delivering requested mass flow rate&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  m_flow_set = m_flow_nominal*phi;

  dp_min =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow</span>(
              m_flow=m_flow_set,
              k=k,
              m_flow_turbulent=m_flow_turbulent);

 kVal = Kv_SI;
 <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(dpFixed_nominal &gt; Modelica.Constants.eps)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
   k =<span style="color: red; font-weight: normal; font-style: normal;"> sqrt</span>(1/(1/kFixed^2 + 1/kVal^2));
 <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
   k = kVal;
 <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

   <span style="color: blue; font-weight: normal; font-style: normal;">if </span>homotopyInitialization<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
     <span style="color: blue; font-weight: normal; font-style: normal;">if </span>from_dp<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
         m_flow=<span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.spliceFunction</span>(
                            x=dp-dp_min,
                            pos= m_flow_set + l2*(dp-dp_min)/dp_nominal*m_flow_nominal,
                            neg=<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_dp</span>(
                                  dp=dp,
                                  k=k,
                                  m_flow_turbulent=m_flow_turbulent),
                            deltax=dp_nominal_pos*deltax),
                         simplified=m_flow_nominal_pos*dp/dp_nominal_pos);
     <span style="color: blue; font-weight: normal; font-style: normal;">else</span>

         dp=<span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.spliceFunction</span>(
                            x=m_flow-m_flow_set,
                            pos= dp_min + (m_flow-m_flow_set)/m_flow_nominal*dp_nominal/l2,
                            neg=<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow</span>(
                                  m_flow=m_flow,
                                  k=k,
                                  m_flow_turbulent=m_flow_turbulent),
                            deltax=m_flow_nominal_pos*deltax*l2),
                     simplified=dp_nominal_pos*m_flow/m_flow_nominal_pos);
     <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
   <span style="color: blue; font-weight: normal; font-style: normal;">else</span><span style="color: #006400; font-weight: normal; font-style: normal;"> // do not use homotopy</span>
     <span style="color: blue; font-weight: normal; font-style: normal;">if </span>from_dp<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
       m_flow=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.spliceFunction</span>(
                            x=dp-dp_min,
                            pos= m_flow_set + l2*(dp-dp_min)/dp_nominal*m_flow_nominal,
                            neg=<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_dp</span>(
                                  dp=dp,
                                  k=k,
                                  m_flow_turbulent=m_flow_turbulent),
                            deltax=dp_nominal_pos*deltax);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        dp=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.spliceFunction</span>(
                            x=m_flow-m_flow_set,
                            pos= dp_min + (m_flow-m_flow_set)/m_flow_nominal*dp_nominal/l2,
                            neg=<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow</span>(
                                  m_flow=m_flow,
                                  k=k,
                                  m_flow_turbulent=m_flow_turbulent),
                            deltax=m_flow_nominal_pos*deltax*l2);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;"> // homotopyInitialization</span>
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>TwoWayPressureIndependent;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoWayQuickOpening<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuatorsa44f6f3648a352efeningI.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayQuickOpening" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.Valves.TwoWayQuickOpening"></a><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves"
>Buildings.Fluid.Actuators.Valves</a>.TwoWayQuickOpening</h2>
<p>
<b>Two way valve with linear flow characteristics</b>
<br>
<br><img src="Buildings.Fluid.Actuators456e270330611c66ntageD.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayQuickOpening">
</p>
<h3>Information</h3>

<p>
Two way valve with a power function for the valve opening characteristic.
Valves that need to open quickly typically have such a valve characteristics.
</p><p>
This model is based on the partial valve model
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>.
Check this model for more information, such
as the regularization near the origin.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a> (Partial model for a two way valve using a Kv characteristic).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>l</td><td>0.0001</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>phi</td><td>if homotopyInitialization th...</td><td>Ratio actual to nominal mass flow rate of valve, phi=Kv(y)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>alp</td><td>2</td><td>Parameter for valve characteristics, alp&gt;0</td></tr>
<tr><td>Real</td><td>delta0</td><td>0.01</td><td>Range of significant deviation from power law</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal</td><td>0</td><td>Pressure drop of pipe and other resistances that are in series [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> TwoWayQuickOpening <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Two way valve with linear flow characteristics&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a>(phi=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>homotopyInitialization<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>
        <span style="color: red; font-weight: normal; font-style: normal;">homotopy</span>(actual=l +<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Fluid.Utilities.regPow</span>(
        y_actual,
        alpInv,
        delta0)*(1 - l), simplified=l + y_actual*(1 - l))<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>l +
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regPow</span>(
        y_actual,
        alpInv,
        delta0)*(1 - l));
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real alp = 2 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Parameter for valve characteristics, alp&gt;0&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real delta0 = 0.01 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Range of significant deviation from power law&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
   <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real alpInv = 1/alp <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Inverse of alpha&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Since the flow model Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow computes</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// 1/k^2, the parameter l must not be zero.</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(l &gt; 0, &quot;Valve leakage parameter l must be bigger than zero.&quot;);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>TwoWayQuickOpening;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoWayTable<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Actuatorse3820fe79d829284TableI.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayTable" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Actuators.Valves.TwoWayTable"></a><a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves"
>Buildings.Fluid.Actuators.Valves</a>.TwoWayTable</h2>
<p>
<b>Two way valve with linear flow characteristics</b>
<br>
<br><img src="Buildings.Fluid.Actuatorse3820fe79d829284TableD.png" alt="Buildings.Fluid.Actuators.Valves.TwoWayTable">
</p>
<h3>Information</h3>

<p>
Two way valve with opening characteristic that is configured through
a table.
</p>
<p>
The mass flow rate for the fully open valve is determined based
on the value of the parameter <code>CvData</code>.
For the different valve positions <i>y &isin; [0, 1]</i>, this nominal flow rate is
scaled by the values of the parameter
<code>flowCharacteristics</code>.
The parameter <code>flowCharacteristics</code> declares a table of the form
</p>
<table summary="summary" border="1" cellspacing="0" cellpadding="2" style="border-collapse:collapse;">
<tr>
<td><i>y</i></td>  <td>0</td>  <td>...</td>  <td>1</td>
</tr>
<tr>
<td><i>&phi;</i></td>  <td><i>l</i></td>  <td>...</td>  <td>1</td>
</tr>
</table>
<p>
where <i>l = K<sub>v</sub>(y=0)/K<sub>v</sub>(y=1) &gt; 0</i> is the valve leakage.
The first row is the valve opening, and the second row is the
mass flow rate, relative to the mass flow rate of the fully open
valve, under the assumption of a constant pressure difference across the
valve.
A suggested value for the valve leakage is <i>l=0.0001</i>.
If <i>l = 0</i>, then this model will replace it with
<i>l = 10<sup>-8</sup></i> for numerical reasons.
For example, if a valve has <i>K<sub>v</sub>=0.5</i> [m<sup>3</sup>/h/bar<sup>1/2</sup>] and
a linear opening characteristics and
a valve leakage of <i>l=0.0001</i>, then one would set
</p>
<pre>
 CvData=Buildings.Fluid.Types.CvTypes.Kv
 Kv = 0.5
 flowCharacteristics(y={0,1}, phi={0.0001,1})
 </pre>
<p>
Note, however, that
<a href="Buildings_Fluid_Actuators_Valves.html#Buildings.Fluid.Actuators.Valves.TwoWayLinear"
>
Buildings.Fluid.Actuators.Valves.TwoWayLinear</a> provides a more
efficient implementation for this simple case.
</p>
<p>
The parameter <code>flowCharacteristics</code> must meet the following
requirements, otherwise the model stops with an error:
</p>
<ul>
<li>
The arrays in
<code>flowCharacteristics.y</code> and <code>flowCharacteristics.phi</code>
must be strictly monotonic increasing.
</li>
<li>
The first value must satisfy
<code>flowCharacteristics.y[1]=0</code>, and
<code>flowCharacteristics.phi[1]</code> must be equal to the
leakage flow rate, which must be bigger than zero.
Otherwise, a default value of <code>1E-8</code> is used.
</li>
<li>
The last values must satisfy
<code>flowCharacteristics.y[end]=1</code> and
<code>flowCharacteristics.phi[end]=1</code>.
</li>
</ul>
<p>
This model is based on the partial valve model
<a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve"
>
Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValve</a>.
Check this model for more information, such
as the regularization near the origin.
</p>
<p>
For an example that specifies an opening characteristics, see
<a href="Buildings_Fluid_Actuators_Valves_Examples.html#Buildings.Fluid.Actuators.Valves.Examples.TwoWayValveTable"
>
Buildings.Fluid.Actuators.Valves.Examples.TwoWayValveTable</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a> (Partial model for a two way valve using a Kv characteristic).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Real</td><td>l</td><td>phiLooUp.table[1, 2]</td><td>Valve leakage, l=Kv(y=0)/Kv(y=1)</td></tr>
<tr><td>Real</td><td>phi</td><td>phiLooUp.y[1]</td><td>Ratio actual to nominal mass flow rate of valve, phi=Kv(y)/Kv(y=1)</td></tr>
<tr><td><a href="Buildings_Fluid_Actuators_Valves_Data.html#Buildings.Fluid.Actuators.Valves.Data.Generic"
>Generic</a></td><td>flowCharacteristics</td><td>&nbsp;</td><td>Table with flow characteristics</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpValve_nominal</td><td>&nbsp;</td><td>Nominal pressure drop of fully open valve, used if CvData=Buildings.Fluid.Types.CvTypes.OpPoint [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dpFixed_nominal</td><td>0</td><td>Pressure drop of pipe and other resistances that are in series [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Flow Coefficient</td></tr>
<tr><td><a href="Buildings_Fluid_Types.html#Buildings.Fluid.Types.CvTypes"
>CvTypes</a></td><td>CvData</td><td>Buildings.Fluid.Types.CvType...</td><td>Selection of flow coefficient</td></tr>
<tr><td>Real</td><td>Kv</td><td>&nbsp;</td><td>Kv (metric) flow coefficient [m3/h/(bar)^(1/2)]</td></tr>
<tr><td>Real</td><td>Cv</td><td>&nbsp;</td><td>Cv (US) flow coefficient [USG/min/(psi)^(1/2)]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>Av</td><td>&nbsp;</td><td>Av (metric) flow coefficient [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Pressure-flow linearization</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.02</td><td>Fraction of nominal flow rate where linearization starts, if y=1</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rhoStd</td><td>Medium.density_pTX(101325, 2...</td><td>Inlet density for which valve coefficients are defined [kg/m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Filtered opening</td></tr>
<tr><td>Boolean</td><td>filteredOpening</td><td>true</td><td>= true, if opening is filtered with a 2nd order CriticalDamping filter</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>riseTime</td><td>120</td><td>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Types.html#Modelica.Blocks.Types.Init"
>Init</a></td><td>init</td><td>Modelica.Blocks.Types.Init.I...</td><td>Type of initialization (no init/steady state/initial state/initial output)</td></tr>
<tr><td>Real</td><td>y_start</td><td>1</td><td>Initial value of output</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>y</td><td>Actuator position (0: closed, 1: open)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y_actual</td><td>Actual valve position</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> TwoWayTable <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Two way valve with linear flow characteristics&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Actuators_BaseClasses.html#Buildings.Fluid.Actuators.BaseClasses.PartialTwoWayValveKv"
>BaseClasses.PartialTwoWayValveKv</a>(
    phi=phiLooUp.y[1],
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>l = phiLooUp.table[1, 2]);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Fluid_Actuators_Valves_Data.html#Buildings.Fluid.Actuators.Valves.Data.Generic"
>Data.Generic</a> flowCharacteristics <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Table with flow characteristics&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Since the flow model Buildings.Fluid.BaseClasses.FlowModels.basicFlowFunction_m_flow computes</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// 1/k^2, the flowCharacteristics.phi[1] must not be zero.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// We therefore set a lower bound.</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable1D"
>Modelica.Blocks.Tables.CombiTable1D</a> phiLooUp(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tableOnFile=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>table=[flowCharacteristics.y,<span style="color: red; font-weight: normal; font-style: normal;"> cat</span>(
        1,
        {<span style="color: red; font-weight: normal; font-style: normal;">max</span>(flowCharacteristics.phi[1], 1E-8)},
        {flowCharacteristics.phi[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>2:<span style="color: red; font-weight: normal; font-style: normal;">size</span>(flowCharacteristics.phi, 1)})],
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>columns=2:2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Normalized mass flow rate for the given valve position under the assumption of a constant pressure&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(flowCharacteristics.y[1] == 0, &quot;flowCharateristics.y[1] must be 0.&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(flowCharacteristics.y[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(flowCharacteristics.y, 1)] == 1, &quot;flowCharateristics.y[end] must be 1.&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(flowCharacteristics.phi[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(flowCharacteristics.phi, 1)] == 1, &quot;flowCharateristics.phi[end] must be 1.&quot;);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assert that the sequences are strictly monotonic increasing</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.isMonotonic</span>(
           x=flowCharacteristics.y,
           strict=true),
         &quot;The values for y in flowCharacteristics must be strictly monotone increasing.&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.isMonotonic</span>(
           x=flowCharacteristics.phi,
           strict=true),
         &quot;The values for phi in flowCharacteristics must be strictly monotone increasing.&quot;);

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(phiLooUp.u[1], y_actual);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>TwoWayTable;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:23:50 2015.
</address>
</body>
</html>
