<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.HeatTransfer.Conduction</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with models for heat conduction&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Conduction<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.HeatTransfer.Conduction"></a><a href="Buildings_HeatTransfer.html#Buildings.HeatTransfer"
>Buildings.HeatTransfer</a>.Conduction</h2>
<p>
<b>Package with models for heat conduction</b><br>
</p>
<h3>Information</h3>

<p>
This package provides component models to compute heat conduction.
</p>
<h4>Implementation</h4>
<p>
The package declares the constant <code>nSupPCM</code>,
which is equal to the number of support points that are used
to approximate the specific internal energy versus temperature relation.
This approximation is used by
<code>Buildings.HeatTransfer.Conduction.SingleLayer</code>
to replace the piece-wise linear function by a cubic hermite spline, with
linear extrapolation, in order to avoid state events during the simulation.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_VariantsPackage.html#Modelica.Icons.VariantsPackage"
>Modelica.Icons.VariantsPackage</a> (Icon for package containing variants).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.HeatTransfer.Co57ad46f24fbd0c15LayerS.png" alt="Buildings.HeatTransfer.Conduction.MultiLayer" width="20" height="20" align="top">&nbsp;<a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.MultiLayer"
>MultiLayer</a>
</td>
<td>Model for heat conductance through a solid with multiple material layers</td>
</tr>
<tr>
<td><img src="Buildings.HeatTransfer.Cob4c036f3e70672a0LayerS.png" alt="Buildings.HeatTransfer.Conduction.SingleLayer" width="20" height="20" align="top">&nbsp;<a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayer"
>SingleLayer</a>
</td>
<td>Model for single layer heat conductance</td>
</tr>
<tr>
<td><img src="Buildings.HeatTransfer.Coe2a9524198d40e33inderS.png" alt="Buildings.HeatTransfer.Conduction.SingleLayerCylinder" width="20" height="20" align="top">&nbsp;<a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayerCylinder"
>SingleLayerCylinder</a>
</td>
<td>Heat conduction in a cylinder</td>
</tr>
<tr>
<td>nSupPCM=6</td>
<td>Number of support points to approximate u(T) releation, used only for phase change material</td>
</tr>
<tr>
<td><img src="Buildings.HeatTransfer.Co3383096b379a47baassesS.png" alt="Buildings.HeatTransfer.Conduction.BaseClasses" width="20" height="20" align="top">&nbsp;<a href="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses"
>BaseClasses</a>
</td>
<td>Package with base classes for Buildings.HeatTransfer.Conduction</td>
</tr>
</table>
<h3>Types and constants</h3>
<pre>  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Integer nSupPCM = 6 <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Number of support points to approximate u(T) releation, used only for phase change material&quot;</span>;</pre>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE MultiLayer<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.HeatTransfer.Co57ad46f24fbd0c15LayerI.png" alt="Buildings.HeatTransfer.Conduction.MultiLayer" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.HeatTransfer.Conduction.MultiLayer"></a><a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction"
>Buildings.HeatTransfer.Conduction</a>.MultiLayer</h2>
<p>
<b>Model for heat conductance through a solid with multiple material layers</b>
<br>
<br><img src="Buildings.HeatTransfer.Co57ad46f24fbd0c15LayerD.png" alt="Buildings.HeatTransfer.Conduction.MultiLayer">
</p>
<h3>Information</h3>

<p>
This is a model of a heat conductor with multiple material layers and energy storage.
The construction has at least one material layer, and each layer has
at least one temperature node. The layers are modeled using an instance of
<a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayer"
>
Buildings.HeatTransfer.Conduction.SingleLayer</a>.
</p>
<p>
The construction material is defined by a record of the package
<a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions"
>
Buildings.HeatTransfer.Data.OpaqueConstructions</a>.
This record allows specifying materials that store energy, and material
that are a thermal conductor only with no heat storage.
To assign the material properties to this model, do the following:
</p>
<ol>
<li>
Create an instance of a record of
<a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions"
>
Buildings.HeatTransfer.Data.OpaqueConstructions</a>, for example
by dragging the record into the schematic model editor.
</li>
<li>
Make sure the instance has the attribute <code>parameter</code>, which may not be
assigned automatically when you drop the model in a graphical editor. For
example, an instanciation may look like
<pre>
 parameter Data.OpaqueConstructions.Insulation100Concrete200 layers
   "Material layers of construction"
   annotation (Placement(transformation(extent={{-80,60},{-60,80}})));
</pre>
</li>
<li>
Assign the instance of the material to the instance of the heat transfer
model as shown in
<a href="Buildings_HeatTransfer_Examples.html#Buildings.HeatTransfer.Examples.ConductorMultiLayer"
>
Buildings.HeatTransfer.Examples.ConductorMultiLayer</a>.
</li>
</ol>
<p>
To obtain the surface temperature of the construction, use <code>port_a.T</code> (or <code>port_b.T</code>)
and not the variable <code>T[1]</code> because there is a thermal resistance between the surface
and the temperature state.
</p>

<p>Extends from <a href="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</a> (Partial model for heat conductor), <a href="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction</a> (Partial model for multi-layer constructions).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A</td><td>&nbsp;</td><td>Heat transfer area [m2]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>ThermalResistance</a></td><td>R</td><td>sum(layers.material[i].R for...</td><td>Thermal resistance of construction [K/W]</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Generic"
>Generic</a></td><td>layers</td><td>redeclare parameter Building...</td><td>Construction definition from Data.OpaqueConstructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td>Boolean</td><td>steadyStateInitial</td><td>false</td><td>=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_a_start</td><td>293.15</td><td>Initial temperature at port_a, used if steadyStateInitial = false [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_b_start</td><td>293.15</td><td>Initial temperature at port_b, used if steadyStateInitial = false [K]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>port_a</td><td>Heat port at surface a</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</a></td><td>port_b</td><td>Heat port at surface b</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> MultiLayer <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Model for heat conductance through a solid with multiple material layers&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</a>(
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>R=<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(layers.material[i].R <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:<span style="color: red; font-weight: normal; font-style: normal;">size</span>(layers.material, 1)));
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T[<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(nSta)](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal = 300) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature at the states&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow[<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(nSta)+nLay] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat flow rate from state i to i+1&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConstruction</a>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.SingleLayer"
>Buildings.HeatTransfer.Conduction.SingleLayer</a>[nLay] lay(
   <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=A,
   material = {layers.material[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:<span style="color: red; font-weight: normal; font-style: normal;">size</span>(layers.material, 1)},
   T_a_start = { T_b_start+(T_a_start-T_b_start) * 1/R *
    <span style="color: red; font-weight: normal; font-style: normal;">sum</span>(layers.material[k].R <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>i:<span style="color: red; font-weight: normal; font-style: normal;">size</span>(layers.material, 1)) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:<span style="color: red; font-weight: normal; font-style: normal;">size</span>(layers.material, 1)},
   T_b_start = { T_a_start+(T_b_start-T_a_start) * 1/R *
    <span style="color: red; font-weight: normal; font-style: normal;">sum</span>(layers.material[k].R <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:i) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:<span style="color: red; font-weight: normal; font-style: normal;">size</span>(layers.material, 1)},
   <span style="color: blue; font-weight: normal; font-style: normal;">each </span>steadyStateInitial = steadyStateInitial) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Material layer&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// This section assigns the temperatures and heat flow rates of the layer models to</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// an array that makes plotting the results easier.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nLay<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta[i]<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      T[<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(nSta[k] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:(i-1)) +j] = lay[i].T[j];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta[i]+1<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Q_flow[<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(nSta[k] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:i-1)+(i-1)+j] = lay[i].Q_flow[j];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_a, lay[1].port_a);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nLay-1<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(lay[i].port_b, lay[i+1].port_a);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(lay[nLay].port_b, port_b);

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>MultiLayer;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE SingleLayer<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.HeatTransfer.Cob4c036f3e70672a0LayerI.png" alt="Buildings.HeatTransfer.Conduction.SingleLayer" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.HeatTransfer.Conduction.SingleLayer"></a><a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction"
>Buildings.HeatTransfer.Conduction</a>.SingleLayer</h2>
<p>
<b>Model for single layer heat conductance</b>
<br>
<br><img src="Buildings.HeatTransfer.Cob4c036f3e70672a0LayerD.png" alt="Buildings.HeatTransfer.Conduction.SingleLayer">
</p>
<h3>Information</h3>

This is a model of a heat conductor for a single layer of homogeneous material
that computes transient or steady-state heat conduction.

<h4>Transient heat conduction in materials without phase change</h4>
<p>
If the material is a record that extends
<a href="Buildings_HeatTransfer_Data_Solids.html#Buildings.HeatTransfer.Data.Solids"
>
Buildings.HeatTransfer.Data.Solids</a> and its
specific heat capacity (as defined by the record <code>material.c</code>)
is non-zero, then this model computes <i>transient</i> heat conduction, i.e., it
computes a numerical approximation to the solution of the heat equation
</p>
<p align="center" style="font-style:italic;">
   &rho; c (&part; T(s,t) &frasl; &part;t) =
    k (&part;&sup2; T(s,t) &frasl; &part;s&sup2;),
</p>
<p>
where
<i>&rho;</i>
is the mass density,
<i>c</i>
is the specific heat capacity per unit mass,
<i>T</i>
is the temperature at location <i>s</i> and time <i>t</i> and
<i>k</i> is the heat conductivity.
At the locations <i>s=0</i> and <i>s=x</i>, where <i>x</i> is the
material thickness, the temperature and heat flow rate is equal to the
temperature and heat flow rate of the heat ports.
</p>
<h4>Transient heat conduction in phase change materials</h4>
<p>
If the material is declared using a record of type
<a href="Buildings_HeatTransfer_Data_SolidsPCM.html#Buildings.HeatTransfer.Data.SolidsPCM"
>
Buildings.HeatTransfer.Data.SolidsPCM</a>, the heat transfer
in a phase change material is computed.
The record <a href="Buildings_HeatTransfer_Data_SolidsPCM.html#Buildings.HeatTransfer.Data.SolidsPCM"
>
Buildings.HeatTransfer.Data.SolidsPCM</a>
declares the solidus temperature <code>TSol</code>,
the liquidus temperature <code>TLiq</code> and the latent heat of
phase transformation <code>LHea</code>.
For heat transfer with phase change, the specific internal energy <i>u</i>
is the dependent variable, rather than the temperature.
Therefore, the governing equation is
</p>
<p align="center" style="font-style:italic;">
   &rho; (&part; u(s,t) &frasl; &part;t) =
    k (&part;&sup2; T(s,t) &frasl; &part;s&sup2;).
</p>
<p>
The constitutive
relation between specific internal energy <i>u</i> and temperature <i>T</i> is defined in
<a href="modelica://Buildings.HeatTransfer.Conduction.BaseClasses.enthalpyTemperature">
Buildings.HeatTransfer.Conduction.BaseClasses.enthalyTemperature</a> by using
cubic hermite spline interpolation with linear extrapolation.
</p>
<h4>Steady-state heat conduction</h4>
<p>
If <code>material.c=0</code>, or if the material extends
<a href="Buildings_HeatTransfer_Data_Resistances.html#Buildings.HeatTransfer.Data.Resistances"
>
Buildings.HeatTransfer.Data.Resistances</a>,
then steady-state heat conduction is computed. In this situation, the heat
flow between its heat ports is
</p>
<p align="center" style="font-style:italic;">
   Q = A &nbsp; k &frasl; x &nbsp; (T<sub>a</sub>-T<sub>b</sub>),
</p>
<p>
where
<i>A</i> is the cross sectional area,
<i>x</i> is the layer thickness,
<i>T<sub>a</sub></i> is the temperature at port a and
<i>T<sub>b</sub></i> is the temperature at port b.
</p>
<h4>Spatial discretization</h4>
<p>
To spatially discretize the heat equation, the construction is
divided into compartments with <code>material.nSta &ge; 1</code> state variables.
The state variables are connected to each other through thermal conductors.
There is also a thermal conductor
between the surfaces and the outermost state variables. Thus, to obtain
the surface temperature, use <code>port_a.T</code> (or <code>port_b.T</code>)
and not the variable <code>T[1]</code>.
Each compartment has the same material properties.
To build multi-layer constructions,
use
<a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction.MultiLayer"
>
Buildings.HeatTransfer.Conduction.MultiLayer</a> instead of this model.
</p>


<p>Extends from <a href="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</a> (Partial model for heat conductor).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A</td><td>&nbsp;</td><td>Heat transfer area [m2]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalResistance"
>ThermalResistance</a></td><td>R</td><td>if (material.R == 0) then ma...</td><td>Thermal resistance of construction [K/W]</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_BaseClasses.html#Buildings.HeatTransfer.Data.BaseClasses.Material"
>Material</a></td><td>material</td><td>redeclare parameter Data.Bas...</td><td>Material from Data.Solids, Data.SolidsPCM or Data.Resistances</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td>Boolean</td><td>steadyStateInitial</td><td>false</td><td>=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_a_start</td><td>293.15</td><td>Initial temperature at port_a, used if steadyStateInitial = false [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_b_start</td><td>293.15</td><td>Initial temperature at port_b, used if steadyStateInitial = false [K]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>port_a</td><td>Heat port at surface a</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</a></td><td>port_b</td><td>Heat port at surface b</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> SingleLayer <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Model for single layer heat conductance&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_HeatTransfer_Conduction_BaseClasses.html#Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor"
>Buildings.HeatTransfer.Conduction.BaseClasses.PartialConductor</a>(
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>R=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(material.R == 0)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>material.x/material.k/A<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>material.R/A);
  <span style="color: #006400; font-weight: normal; font-style: normal;"> // if material.R == 0, then the material specifies material.k, and this model specifies x</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;"> // For resistances, material.k need not be specified, and hence we use material.R</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The value T[:].start is used by the solver when finding initial states</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// that satisfy dT/dt=0, which requires solving a system of nonlinear equations</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// if the convection coefficient is a function of temperature.</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T[nSta](start=
     {T_a_start+(T_b_start-T_a_start) * UA *
        <span style="color: red; font-weight: normal; font-style: normal;">sum</span>(1/(<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(k==1<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>k==nSta+1)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>UAnSta2<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>UAnSta) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:i) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta},
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal = 300) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Temperature at the states&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow[nSta+1] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat flow rate from state i to i+1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificInternalEnergy"
>Modelica.SIunits.SpecificInternalEnergy</a> u[nSta](start=
     material.c*{T_a_start+(T_b_start-T_a_start) * UA *
        <span style="color: red; font-weight: normal; font-style: normal;">sum</span>(1/(<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(k==1<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>k==nSta+1)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>UAnSta2<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>UAnSta) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:i) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta},
        <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal = 270000) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Definition of specific internal energy (enthalpy in solids)!&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Data_BaseClasses.html#Buildings.HeatTransfer.Data.BaseClasses.Material"
>Data.BaseClasses.Material</a> material <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Material from Data.Solids, Data.SolidsPCM or Data.Resistances&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean steadyStateInitial=false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T_a_start=293.15 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial temperature at port_a, used if steadyStateInitial = false&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T_b_start=293.15 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial temperature at port_b, used if steadyStateInitial = false&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nSta(min=1) = material.nSta <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of state variables&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</a> UAnSta = UA*nSta <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal conductance between nodes&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</a> UAnSta2 = 2*UAnSta <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal conductance between nodes and surface boundary&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a> m = A*material.x*material.d/material.nSta <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Mass associated with the temperature state&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>Modelica.SIunits.HeatCapacity</a> C = m*material.c <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat capacity associated with the temperature state&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificInternalEnergy"
>Modelica.SIunits.SpecificInternalEnergy</a> ud[Buildings.HeatTransfer.Conduction.nSupPCM](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Support points for derivatives (used for PCM)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> Td[Buildings.HeatTransfer.Conduction.nSupPCM](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Support points for derivatives (used for PCM)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real dT_du[Buildings.HeatTransfer.Conduction.nSupPCM](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;kg.K2/J&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Derivatives dT/du at the support points (used for PCM)&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The initialization is only done for materials that store energy.</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>material.steadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>steadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">if </span>material.phasechange<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">  der</span>(u) =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(nSta);
        <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: red; font-weight: normal; font-style: normal;">  der</span>(T) =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(nSta);
        <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
          T[i] = T_a_start+(T_b_start-T_a_start) * UA *
            <span style="color: red; font-weight: normal; font-style: normal;">sum</span>(1/(<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(k==1<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>k==nSta+1)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>UAnSta2<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>UAnSta) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:i);
        <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

   <span style="color: blue; font-weight: normal; font-style: normal;">if </span>material.phasechange<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
     (ud, Td, dT_du) =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.HeatTransfer.Conduction.BaseClasses.der_temperature_u</span>(
       c=   material.c,
       TSol=material.TSol,
       TLiq=material.TLiq,
       LHea=material.LHea,
       ensureMonotonicity=material.ensureMonotonicity);
   <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
     ud    =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(Buildings.HeatTransfer.Conduction.nSupPCM);
     Td    =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(Buildings.HeatTransfer.Conduction.nSupPCM);
     dT_du =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(Buildings.HeatTransfer.Conduction.nSupPCM);
   <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
    port_a.Q_flow = +Q_flow[1];
    port_b.Q_flow = -Q_flow[nSta+1];

    port_a.T-T[1] = Q_flow[1]/UAnSta2;
    T[nSta] -port_b.T = Q_flow[nSta+1]/UAnSta2;

    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>2:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">   // Q_flow[i] is heat flowing from (i-1) to (i)</span>
       T[i-1]-T[i] = Q_flow[i]/UAnSta;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">  // Steady-state heat balance</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>material.steadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>2:nSta+1<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
        Q_flow[i] = Q_flow[1];
        <span style="color: blue; font-weight: normal; font-style: normal;">if </span>material.phasechange<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: #006400; font-weight: normal; font-style: normal;">  // Phase change material</span>
          T[i-1]=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.HeatTransfer.Conduction.BaseClasses.temperature_u</span>(
                    ud=ud,
                    Td=Td,
                    dT_du=dT_du,
                    u=u[i-1]);
        <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: #006400; font-weight: normal; font-style: normal;">  // Regular material</span>
          u[i-1]=material.c*T[i-1];
        <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
      <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">  // Transient heat conduction</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>material.phasechange<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: #006400; font-weight: normal; font-style: normal;">  // Phase change material</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
        <span style="color: red; font-weight: normal; font-style: normal;">  der</span>(u[i]) = (Q_flow[i]-Q_flow[i+1])/m;
        <span style="color: #006400; font-weight: normal; font-style: normal;">  // Recalculation of temperature based on specific internal energy</span>
          T[i]=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.HeatTransfer.Conduction.BaseClasses.temperature_u</span>(
                    ud=ud,
                    Td=Td,
                    dT_du=dT_du,
                    u=u[i]);
        <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: #006400; font-weight: normal; font-style: normal;">  // Regular material</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
        <span style="color: red; font-weight: normal; font-style: normal;">  der</span>(T[i]) = (Q_flow[i]-Q_flow[i+1])/C;
          u[i]=material.c*T[i];
        <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>SingleLayer;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE SingleLayerCylinder<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.HeatTransfer.Coe2a9524198d40e33inderI.png" alt="Buildings.HeatTransfer.Conduction.SingleLayerCylinder" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.HeatTransfer.Conduction.SingleLayerCylinder"></a><a href="Buildings_HeatTransfer_Conduction.html#Buildings.HeatTransfer.Conduction"
>Buildings.HeatTransfer.Conduction</a>.SingleLayerCylinder</h2>
<p>
<b>Heat conduction in a cylinder</b>
<br>
<br><img src="Buildings.HeatTransfer.Coe2a9524198d40e33inderD.png" alt="Buildings.HeatTransfer.Conduction.SingleLayerCylinder">
</p>
<h3>Information</h3>

Model for radial heat transfer in a hollow cylinder.
<p>
If the heat capacity of the material is non-zero, then this model computes transient heat conduction, i.e., it
computes a numerical approximation to the solution of the heat equation
</p>
<p align="center" style="font-style:italic;">
   &rho; c ( &part; T(r,t) &frasl; &part;t ) =
    k ( &part;&sup2; T(r,t) &frasl; &part;r&sup2; + 1 &frasl; r &nbsp;  &part; T(r,t) &frasl; &part;r ),
</p>
<p>
where
<i>&rho;</i>
is the mass density,
<i>c</i>
is the specific heat capacity per unit mass,
<i>T</i>
is the temperature at location <i>r</i> and time <i>t</i> and
<i>k</i> is the heat conductivity.
At the locations <i>r=r<sub>a</sub></i> and <i>r=r<sub>b</sub></i>,
the temperature and heat flow rate are equal to the
temperature and heat flow rate of the heat ports.
</p>
<p>
If the heat capacity of the material is set to zero, then steady-state heat flow is computed using
</p>
<p align="center" style="font-style:italic;">
   Q = 2 &pi; k (T<sub>a</sub>-T<sub>b</sub>)&frasl; ln(r<sub>a</sub> &frasl; r<sub>b</sub>),
</p>
<p>
where
<i>r<sub>a</sub></i> is the internal radius,
<i>r<sub>b</sub></i> is the external radius,
<i>T<sub>a</sub></i> is the temperature at port a and
<i>T<sub>b</sub></i> is the temperature at port b.
</p>
<h4>Implementation</h4>
<p>
To spatially discretize the heat equation, the construction is
divided into compartments with <code>material.nSta &ge; 1</code> state variables.
The state variables are connected to each other through thermal conductors.
There is also a thermal conductor
between the surfaces and the outermost state variables. Thus, to obtain
the surface temperature, use <code>port_a.T</code> (or <code>port_b.T</code>)
and not the variable <code>T[1]</code>.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Generic</a></td><td>material</td><td>redeclare parameter Building...</td><td>Material thermal properties</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</a></td><td>h</td><td>&nbsp;</td><td>Height of the cylinder [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</a></td><td>r_a</td><td>&nbsp;</td><td>Internal radius [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Radius</a></td><td>r_b</td><td>&nbsp;</td><td>External radius [m]</td></tr>
<tr><td>Integer</td><td>nSta</td><td>&nbsp;</td><td>Number of state variables</td></tr>
<tr><td>Real</td><td>griFac</td><td>2</td><td>Grid factor for spacing</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>TInt_start</td><td>293.15</td><td>Initial temperature at port_a, used if steadyStateInitial = false [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>TExt_start</td><td>293.15</td><td>Initial temperature at port_b, used if steadyStateInitial = false [K]</td></tr>
<tr><td>Boolean</td><td>steadyStateInitial</td><td>false</td><td>true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>port_a</td><td>Heat port at surface a</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>HeatPort_b</a></td><td>port_b</td><td>Heat port at surface b</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> SingleLayerCylinder <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat conduction in a cylinder&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Data_Soil.html#Buildings.HeatTransfer.Data.Soil.Generic"
>Buildings.HeatTransfer.Data.Soil.Generic</a> material <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Material thermal properties&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Modelica.SIunits.Height</a> h <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Height of the cylinder&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</a> r_a <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Internal radius&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</a> r_b <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;External radius&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nSta(min=1) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of state variables&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TInt_start=293.15 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial temperature at port_a, used if steadyStateInitial = false&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TExt_start=293.15 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial temperature at port_b, used if steadyStateInitial = false&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean steadyStateInitial=false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real griFac(min=1) = 2 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Grid factor for spacing&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.TemperatureDifference"
>Modelica.SIunits.TemperatureDifference</a> dT <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;port_a.T - port_b.T&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> port_a <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port at surface a&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_b</a> port_b <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port at surface b&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T[nSta](start=
     {TInt_start+ (TExt_start-TInt_start)/<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(r_b/r_a)
       *<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>((r_a+(r_b-r_a)/(nSta)*(i-0.5))/r_a) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta}) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature of the states&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow[nSta+1] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat flow rate from state i to i+1&quot;</span>;

<span style="color: #006400; font-weight: normal; font-style: normal;">//  Modelica.SIunits.TemperatureSlope der_T[nSta]</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//    &quot;Time derivative of temperature (= der(T))&quot;;</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</a> r[nSta+1](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radius to the boundary of the i-th domain&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Radius"
>Modelica.SIunits.Radius</a> rC[nSta](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radius to the center of the i-th domain&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</a> c= material.c <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Specific heat capacity&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>Modelica.SIunits.ThermalConductivity</a> k= material.k <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal conductivity of the material&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> d = material.d <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Density of the material&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductance"
>Modelica.SIunits.ThermalConductance</a> G[nSta+1](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat conductance between the temperature nodes&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>Modelica.SIunits.HeatCapacity</a> C[nSta](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat capacity of each state&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(r_a &lt; r_b, &quot;Error: Model requires r_a &lt; r_b.&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(0 &lt; r_a,   &quot;Error: Model requires 0 &lt; r_a.&quot;);
  r[1] = r_a;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>2:nSta+1<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
     r[i]= r[i-1] + ( r_b - r_a)  * (1-griFac)/(1-griFac^(nSta)) * griFac^(i-2);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(r[nSta+1]-r_b) &lt; 1E-10, &quot;Error: Wrong computation of radius. r[nSta+1]=&quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(r[nSta+1]));

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Radii to the center of the domain</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    rC[i] = (r[i]+r[i+1])/2;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Conductance between nodes (which are in the center of the domain)</span>
  G[1]      = 2*Modelica.Constants.pi*k*h/<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(rC[1]/r_a);
  G[nSta+1] = 2*Modelica.Constants.pi*k*h/<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(r_b/rC[nSta]);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>2:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    G[i]      = 2*Modelica.Constants.pi*k*h/<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(rC[i]/rC[i-1]);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Heat capacity of each segment</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
   C[i] = (d*Modelica.Constants.pi*c*h*((r[i+1])^2-(r[i])^2));
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The initialization is only done for materials that store energy.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>material.steadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>steadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">der</span>(T) =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(nSta);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
        T[i]=TInt_start+ (TExt_start-TInt_start)/<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.log</span>(r_b/r_a) *<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Math.log</span>(rC[i]/r_a);
      <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  dT = port_a.T - port_b.T;
  port_a.Q_flow = +Q_flow[1];
  port_b.Q_flow = -Q_flow[nSta+1];
  Q_flow[1]      = G[1]      * (port_a.T-T[1]);
  Q_flow[nSta+1] = G[nSta+1] * (T[nSta]-port_b.T);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>2:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    Q_flow[i]=G[i]*(T[i-1]-T[i]);
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Q_flow[i] represents the heat flowing between two nodes</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>material.steadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>2:nSta+1<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Q_flow[i]=Q_flow[1];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSta<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">  der</span>(T[i])= (Q_flow[i]-Q_flow[i+1])/C[i];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>SingleLayerCylinder;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:26:31 2015.
</address>
</body>
</html>
