<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Rooms.BaseClasses</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with base classes for Buildings.Rooms&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Rooms.BaseClasses"></a><a href="Buildings_Rooms.html#Buildings.Rooms"
>Buildings.Rooms</a>.BaseClasses</h2>
<p>
<b>Package with base classes for Buildings.Rooms</b><br>
</p>
<h3>Information</h3>

<p>
This package contains base classes that are used to construct the models in
<a href="Buildings_Rooms.html#Buildings.Rooms"
>Buildings.Rooms</a>.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</a> (Icon for packages containing base classes).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassec3a68bf25e1afb7MixedS.png" alt="Buildings.Rooms.BaseClasses.AirHeatMassBalanceMixed" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.AirHeatMassBalanceMixed"
>AirHeatMassBalanceMixed</a>
</td>
<td>Heat and mass balance of the air, assuming completely mixed air</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassb12cfbf9582b10a2lanceS.png" alt="Buildings.Rooms.BaseClasses.CFDAirHeatMassBalance" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDAirHeatMassBalance"
>CFDAirHeatMassBalance</a>
</td>
<td>Heat and mass balance of the air based on computational fluid dynamics</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClasses.CFDExchangeS.png" alt="Buildings.Rooms.BaseClasses.CFDExchange" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDExchange"
>CFDExchange</a>
</td>
<td>Block that exchanges data with the CFD code</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass8aec9b62b9547120rfaceS.png" alt="Buildings.Rooms.BaseClasses.CFDFluidInterface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDFluidInterface"
>CFDFluidInterface</a>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClasses.CFDHeatGainS.png" alt="Buildings.Rooms.BaseClasses.CFDHeatGain" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDHeatGain"
>CFDHeatGain</a>
</td>
<td>Model to convert internal heat gain signals</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClasse29360c724dffdf7rfaceS.png" alt="Buildings.Rooms.BaseClasses.CFDSurfaceInterface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass463e41028452bddftionsS.png" alt="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions"
>ExteriorBoundaryConditions</a>
</td>
<td>Model for convection and radiation bounary condition of exterior constructions</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassc134fdd45fd20611indowS.png" alt="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow"
>ExteriorBoundaryConditionsWithWindow</a>
</td>
<td>Model for exterior boundary conditions for constructions with a window</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass39076b6d16b239c0hangeS.png" alt="Buildings.Rooms.BaseClasses.InfraredRadiationExchange" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.InfraredRadiationExchange"
>InfraredRadiationExchange</a>
</td>
<td>Infrared radiation heat exchange between the room facing surfaces</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassef6fd50d43dced46utionS.png" alt="Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution"
>InfraredRadiationGainDistribution</a>
</td>
<td>Infrared radiative heat gain distribution between the room facing surfaces</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass5b7bd65ce2105337tGainS.png" alt="Buildings.Rooms.BaseClasses.MixedAirHeatGain" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.MixedAirHeatGain"
>MixedAirHeatGain</a>
</td>
<td>Model to convert internal heat gain signals</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass361a47c3d45bb74dlanceS.png" alt="Buildings.Rooms.BaseClasses.MixedAirHeatMassBalance" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.MixedAirHeatMassBalance"
>MixedAirHeatMassBalance</a>
</td>
<td>Heat and mass balance of the air, assuming completely mixed air</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassef5869d92b857a6flanceS.png" alt="Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"
>PartialAirHeatMassBalance</a>
</td>
<td>Partial model for heat and mass balance of the air</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassfed177a79783e66erfaceS.png" alt="Buildings.Rooms.BaseClasses.PartialSurfaceInterface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterface"
>PartialSurfaceInterface</a>
</td>
<td>Partial model that is used for infrared radiation balance</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassfed177a79783e66erfaceS.png" alt="Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>PartialSurfaceInterfaceRadiative</a>
</td>
<td>Partial model that is used for infrared radiation balance</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass396027b42b0f60aaapterS.png" alt="Buildings.Rooms.BaseClasses.RadiationAdapter" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.RadiationAdapter"
>RadiationAdapter</a>
</td>
<td>Model to connect between signals and heat port for radiative gains of the room</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass0cb9284165e146d7atureS.png" alt="Buildings.Rooms.BaseClasses.RadiationTemperature" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.RadiationTemperature"
>RadiationTemperature</a>
</td>
<td>Radiative temperature of the room</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass6f44246b960e047clanceS.png" alt="Buildings.Rooms.BaseClasses.RoomHeatMassBalance" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.RoomHeatMassBalance"
>RoomHeatMassBalance</a>
</td>
<td>Base model for a room</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClassfb194bf94115eed8hangeS.png" alt="Buildings.Rooms.BaseClasses.SkyRadiationExchange" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SkyRadiationExchange"
>SkyRadiationExchange</a>
</td>
<td>Radiative heat exchange with the sky and the ambient</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass124701a598175785hangeS.png" alt="Buildings.Rooms.BaseClasses.SolarRadiationExchange" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SolarRadiationExchange"
>SolarRadiationExchange</a>
</td>
<td>Solar radiation heat exchange between the room facing surfaces</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass497d981c98bc523ceDataS.png" alt="Buildings.Rooms.BaseClasses.cfdExchangeData" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.cfdExchangeData"
>cfdExchangeData</a>
</td>
<td>Exchange data between CFD and Modelica</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass497d981c98bc523ceDataS.png" alt="Buildings.Rooms.BaseClasses.cfdReceiveFeedback" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.cfdReceiveFeedback"
>cfdReceiveFeedback</a>
</td>
<td>Receive the feedback from CFD</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass497d981c98bc523ceDataS.png" alt="Buildings.Rooms.BaseClasses.cfdSendStopCommand" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.cfdSendStopCommand"
>cfdSendStopCommand</a>
</td>
<td>Send the stop command to CFD</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass497d981c98bc523ceDataS.png" alt="Buildings.Rooms.BaseClasses.cfdStartCosimulation" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.cfdStartCosimulation"
>cfdStartCosimulation</a>
</td>
<td>Start the coupled simulation with CFD</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClasses.to_WS.png" alt="Buildings.Rooms.BaseClasses.to_W" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.to_W"
>to_W</a>
</td>
<td>Add unit [W] to data</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass7e6dd80f57131c1cifierS.png" alt="Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier"
>CFDSurfaceIdentifier</a>
</td>
<td>Data record to identify surfaces in the CFD code</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass0dc001abb17b498embersS.png" alt="Buildings.Rooms.BaseClasses.ConstructionNumbers" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionNumbers"
>ConstructionNumbers</a>
</td>
<td>Data records for construction data</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass0dc001abb17b498embersS.png" alt="Buildings.Rooms.BaseClasses.ConstructionRecords" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>ConstructionRecords</a>
</td>
<td>Data records for construction data</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceS.png" alt="Buildings.Rooms.BaseClasses.OpaqueSurface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a>
</td>
<td>Record for exterior constructions that have no window</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceS.png" alt="Buildings.Rooms.BaseClasses.Overhang" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.Overhang"
>Overhang</a>
</td>
<td>Record for window overhang</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceS.png" alt="Buildings.Rooms.BaseClasses.ParameterConstruction" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a>
</td>
<td>Record for exterior constructions that have no window</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceS.png" alt="Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a>
</td>
<td>Record for exterior constructions that have a window</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceS.png" alt="Buildings.Rooms.BaseClasses.PartialParameterConstruction" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialParameterConstruction"
>PartialParameterConstruction</a>
</td>
<td>Partial record for constructions</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceS.png" alt="Buildings.Rooms.BaseClasses.SideFins" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SideFins"
>SideFins</a>
</td>
<td>Record for window side fins</td>
</tr>
<tr>
<td><img src="Buildings.Rooms.BaseClasses.ExamplesS.png" alt="Buildings.Rooms.BaseClasses.Examples" width="20" height="20" align="top">&nbsp;<a href="Buildings_Rooms_BaseClasses_Examples.html#Buildings.Rooms.BaseClasses.Examples"
>Examples</a>
</td>
<td>Collection of models that illustrate model use and test models</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE AirHeatMassBalanceMixed<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassec3a68bf25e1afb7MixedI.png" alt="Buildings.Rooms.BaseClasses.AirHeatMassBalanceMixed" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.AirHeatMassBalanceMixed"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.AirHeatMassBalanceMixed</h2>
<p>
<b>Heat and mass balance of the air, assuming completely mixed air</b>
<br>
<br><img src="Buildings.Rooms.BaseClassec3a68bf25e1afb7MixedD.png" alt="Buildings.Rooms.BaseClasses.AirHeatMassBalanceMixed">
</p>
<h3>Information</h3>

<p>
This model computes the heat and mass balance of the air.
The model assumes a completely mixed air volume.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a> (Data records for construction data), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a> (Declarations for lumped volumes).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</a></td><td>V</td><td>&nbsp;</td><td>Volume [m3]</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Set to true if at least one window has an interior or exterior shade</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Convective heat transfer</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.InteriorConvection"
>InteriorConvection</a></td><td>conMod</td><td>&nbsp;</td><td>Convective heat transfer model for opaque constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</a></td><td>hFixed</td><td>&nbsp;</td><td>Constant convection coefficient for opaque constructions [W/(m2.K)]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Real</td><td>mSenFac</td><td>1</td><td>Factor for scaling the sensible thermal mass of the volume</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>&nbsp;</td><td>= true, use homotopy method</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>uSha[NConExtWin]</td><td>Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>QRadAbs_flow[NConExtWin]</td><td>Total net radiation that is absorbed by the shade (positive if absorbed) [W]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>TSha[NConExtWin]</td><td>Shade temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>heaPorAir</td><td>Heat port to air volume</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaUns[NConExtWin]</td><td>Heat port that connects to room-side surface of unshaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaSha[NConExtWin]</td><td>Heat port that connects to room-side surface of shaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> AirHeatMassBalanceMixed <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Heat and mass balance of the air, assuming completely mixed air&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Port definitions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nPorts=0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of ports&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Modelica.SIunits.Volume</a> V <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.InteriorConvection"
>Buildings.HeatTransfer.Types.InteriorConvection</a> conMod <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective heat transfer model for opaque constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</a> hFixed <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Constant convection coefficient for opaque constructions&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if at least one window has an interior or exterior shade&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Input/output signals</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> uSha[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> QRadAbs_flow[NConExtWin](
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;W&quot;) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total net radiation that is absorbed by the shade (positive if absorbed)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> TSha[NConExtWin](
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;K&quot;,
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;ThermodynamicTemperature&quot;) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
      haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Shade temperature&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Fluid port</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b</a> ports[nPorts](
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fluid inlets and outlets&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Heat ports</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> heaPorAir <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port to air volume&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExt[NConExt] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of exterior constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExtWin[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of exterior constructions that contain a window&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaUns[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of unshaded glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaSha[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port that connects to room-side surface of shaded glass&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExtWinFra[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of window frame&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conPar_a[NConPar] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface a of partition constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conPar_b[NConPar] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface b of partition constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conBou[NConBou] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of constructions that expose their other surface to the outside&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conSurBou[NSurBou] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port to surfaces of models that compute the heat conduction outside of this room&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Mixing volume</span>
  <a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Fluid.MixingVolumes.MixingVolume</a> vol(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>energyDynamics=energyDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>massDynamics=massDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>V=V,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>p_start=p_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_start=T_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>X_start=X_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_start=C_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_nominal=C_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal = m_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>prescribedHeatFlowRate = true,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nPorts=nPorts,
    m_flow_small=1E-4*<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(m_flow_nominal),
    allowFlowReversal=true) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Room air volume&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Convection models</span>
  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConExt[NConExt](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConExt.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConExtWin[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConExtWinOpa,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConExtWin.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.InteriorHeatTransferConvective"
>HeatTransfer.Windows.InteriorHeatTransferConvective</a> convConWin[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>fFra=datConExtWin.fFra,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveExteriorShade={datConExtWin[i].glaSys.haveExteriorShade <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveInteriorShade={datConExtWin[i].glaSys.haveInteriorShade <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConExtWinGla + AConExtWinFra) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Model for convective heat transfer at window&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConPar_a[nConPar](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til=Modelica.Constants.pi .- datConPar.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConPar_b[nConPar](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConPar.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConBou[nConBou](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConBou.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convSurBou[nSurBou](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=ASurBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = surBou.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Surface areas</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExt[NConExt] = datConExt.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinOpa[NConExtWin] = datConExtWin.AOpa <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Opaque areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinGla[NConExtWin] = (1 .- datConExtWin.fFra) .* datConExtWin.AWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Glass areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinFra[NConExtWin] = datConExtWin.fFra .* datConExtWin.AWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Frame areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConPar[NConPar] = datConPar.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of partition constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConBou[NConBou] = datConBou.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> ASurBou[NSurBou] = surBou.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Area of surface models of constructions that are modeled outside of this room&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Thermal collectors</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConExt(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConExt) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConExtWin(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConExtWin) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConWin(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConExtWin) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConPar_a(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConPar) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConPar_b(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConPar) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConBou(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConBou) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConSurBou(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nSurBou) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_a.fluid,theConConPar_a. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_b.fluid,theConConPar_b. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConBou.fluid,theConConBou. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convSurBou.fluid,theConSurBou. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConPar_a.port_b,vol. heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConPar_b.port_b,vol. heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConBou.port_b,vol. heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConSurBou.port_b,vol. heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWinFra,convConWin. frame);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExt.solid, conExt);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExt.fluid,theConConExt. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConExt.port_b,vol. heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConExtWin.port_b,vol. heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExtWin.fluid,theConConExtWin. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExtWin.solid, conExtWin);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConWin.port_b,vol. heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.air,theConConWin. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.glaSha, glaSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.glaUns, glaUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_a.solid, conPar_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_b.solid, conPar_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConBou.solid, conBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convSurBou.solid, conSurBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol.ports, ports);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(heaPorAir, vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(uSha, convConWin.uSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.QRadAbs_flow, QRadAbs_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.TSha, TSha);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>AirHeatMassBalanceMixed;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE CFDAirHeatMassBalance<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassb12cfbf9582b10a2lanceI.png" alt="Buildings.Rooms.BaseClasses.CFDAirHeatMassBalance" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.CFDAirHeatMassBalance"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.CFDAirHeatMassBalance</h2>
<p>
<b>Heat and mass balance of the air based on computational fluid dynamics</b>
<br>
<br><img src="Buildings.Rooms.BaseClassb12cfbf9582b10a2lanceD.png" alt="Buildings.Rooms.BaseClasses.CFDAirHeatMassBalance">
</p>
<h3>Information</h3>

<p>
This model computes the heat and mass balance of the air using Computational Fluid Dynamics program.
</p>
<p>
For a documentation of the exchange parameters and variables, see
<a href="Buildings_Rooms_UsersGuide.html#Buildings.Rooms.UsersGuide.CFD"
>
Buildings.Rooms.UsersGuide.CFD</a>.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"
>Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance</a> (Partial model for heat and mass balance of the air).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Set to true if at least one window has an interior or exterior shade</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</a></td><td>V</td><td>&nbsp;</td><td>Volume [m3]</td></tr>
<tr><td>String</td><td>cfdFilNam</td><td>&nbsp;</td><td>CFD input file name</td></tr>
<tr><td>Boolean</td><td>useCFD</td><td>true</td><td>Set to false to deactivate the CFD interface and use instead yFixed as output</td></tr>
<tr><td>Boolean</td><td>haveSensor</td><td>&nbsp;</td><td>Flag, true if the model has at least one sensor</td></tr>
<tr><td>Integer</td><td>nSen</td><td>&nbsp;</td><td>Number of sensors that are connected to CFD output</td></tr>
<tr><td>String</td><td>sensorName[nSen]</td><td>&nbsp;</td><td>Names of sensors as declared in the CFD input file</td></tr>
<tr><td>String</td><td>portName[nPorts]</td><td>&nbsp;</td><td>Names of fluid ports as declared in the CFD input file</td></tr>
<tr><td>Real</td><td>uSha_fixed[nConExtWin]</td><td>&nbsp;</td><td>Constant control signal for the shading device (0: unshaded; 1: fully shaded)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Sampling</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>samplePeriod</td><td>&nbsp;</td><td>Sample period of component [s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>&nbsp;</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>&nbsp;</td><td>Start value of pressure [Pa]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>uSha[NConExtWin]</td><td>Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>QRadAbs_flow[NConExtWin]</td><td>Total net radiation that is absorbed by the shade (positive if absorbed) [W]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>TSha[NConExtWin]</td><td>Shade temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>heaPorAir</td><td>Heat port to air volume</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaUns[NConExtWin]</td><td>Heat port that connects to room-side surface of unshaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaSha[NConExtWin]</td><td>Heat port that connects to room-side surface of shaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Medium in the component</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>yCFD[nSen]</td><td>Sensor for output from CFD</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>QCon_flow</td><td>Convective sensible heat gains of the room</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>QLat_flow</td><td>Latent heat gains for the room</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> CFDAirHeatMassBalance <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Heat and mass balance of the air based on computational fluid dynamics&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"
>Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
    <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium in the component&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assumptions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of mass balance&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Initialization</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium.AbsolutePressure</a> p_start <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Start value of pressure&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String cfdFilNam <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;CFD input file name&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean useCFD=true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to false to deactivate the CFD interface and use instead yFixed as output&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> samplePeriod(min=100*Modelica.Constants.eps) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sample period of component&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveSensor <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if the model has at least one sensor&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nSen(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of sensors that are connected to CFD output&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String sensorName[nSen] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Names of sensors as declared in the CFD input file&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String portName[nPorts] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Names of fluid ports as declared in the CFD input file&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real uSha_fixed[nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Constant control signal for the shading device (0: unshaded; 1: fully shaded)&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDExchange"
>CFDExchange</a> cfd(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>cfdFilNam=cfdFilNam,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>startTime=startTime,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>activateInterface=useCFD,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>samplePeriod=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>useCFD<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>samplePeriod<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>Modelica.Constants.inf,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>uStart=uStart,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nWri=kFluIntC_inflow + Medium.nC*nPorts,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nRea=kSen + nSen,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nSur=nSur,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>surIde=surIde,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveShade=haveShade,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveSensor=haveSensor,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>sensorName=sensorName,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>portName=portName,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>yFixed=yFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nXi=Medium.nXi,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nC=Medium.nC,
    rho_start=rho_start,
    nConExtWin=NConExtWin) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Block that exchanges data with the CFD simulation&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> yCFD[nSen] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveSensor <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sensor for output from CFD&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Values that are used for uStart</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
   <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> startTime(fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;First sample time instant.&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real uStart[kFluIntC_inflow + Medium.nC*nPorts](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Values used for uStart in CFDExchange&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Values that are used for yFixed</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real yFixed[kSen + nSen](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Values used for yFixed in CFDExchange&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow_fixed[kSurBou + nSurBou]=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(
      0, kSurBou + nSurBou) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface heat flow rate used for yFixed&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TRooAve_fixed=Medium.T_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Average room air temperature used for yFixed&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TSha_fixed[NConExtWin]=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(Medium.T_default,
      NConExtWin) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Shade temperature used for yFixed&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T_outflow_fixed[nPorts]=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(Medium.T_default,
      nPorts) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature of the fluid that flows into the HVAC system used for yFixed&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real Xi_outflow_fixed[nPorts*Medium.nXi](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Species concentration of the fluid that flows into the HVAC system used for yFixed&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real C_outflow_fixed[nPorts*Medium.nC](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Trace substances of the fluid that flows into the HVAC system used for yFixed&quot;</span>;

   <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_start=<span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(
   <span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(
     T=Medium.T_default,
     p=p_start,
     X=Medium.X_default)) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Density, used to compute fluid mass&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier"
>CFDSurfaceIdentifier</a> surIde[kSurBou + nSurBou]=
      <span style="color: red; font-weight: normal; font-style: normal;">assignSurfaceIdentifier</span>(
      nConExt=nConExt,
      nConExtWin=nConExtWin,
      nConPar=nConPar,
      nConBou=nConBou,
      nSurBou=nSurBou,
      nSur=nSur,
      haveShade=haveShade,
      nameConExt=datConExt.name,
      AConExt=datConExt.A,
      tilConExt=datConExt.til,
      bouConConExt=datConExt.boundaryCondition,
      nameConExtWin=datConExtWin.name,
      AConExtWin=datConExtWin.AOpa,
      tilConExtWin=datConExtWin.til,
      bouConConExtWin=datConExtWin.boundaryCondition,
      AGla=datConExtWin.AGla,
      AFra=datConExtWin.AFra,
      uSha=uSha_fixed,
      nameConPar=datConPar.name,
      AConPar=datConPar.A,
      tilConPar=datConPar.til,
      bouConConPar=datConPar.boundaryCondition,
      nameConBou=datConBou.name,
      AConBou=datConBou.A,
      tilConBou=datConBou.til,
      bouConConBou=datConBou.boundaryCondition,
      nameSurBou=surBou.name,
      ASurBou=surBou.A,
      tilSurBou=surBou.til,
      bouConSurBou=surBou.boundaryCondition) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Names of all surfaces in the order in which their properties are sent to CFD&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Interfaces between the CFD block and the heat ports of this model</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Here, we directly access datConExt instead of surIde. The reason is</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the Dymola thinks that surIde.bouCon is not fixed at translation time</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// and then refuses to use this parameter to conditionally remove connectors</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// in CFDSurfaceInterface.</span>
  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdConExt[NConExt](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConExt[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
      haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Interface to heat port of exterior constructions&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdConExtWin[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConExtWin[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Interface to heat port of opaque part of exterior constructions with window&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdGlaUns[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConExtWin[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Interface to heat port of unshaded part of glass&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdGlaSha[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConExtWin[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Interface to heat port of shaded part of glass&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdConExtWinFra[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConExtWin[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Interface to heat port of window frame&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdConPar_a[NConPar](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConPar[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Interface to heat port of surface a of partition constructions&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdConPar_b[NConPar](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConPar[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Interface to heat port of surface b of partition constructions&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdConBou[NConBou](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=datConBou[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Interface to heat port that connects to room-side surface of constructions that expose their other surface to the outside&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceInterface"
>CFDSurfaceInterface</a> cfdSurBou[NSurBou](<span style="color: blue; font-weight: normal; font-style: normal;">final </span>bouCon=surBou[:].boundaryCondition) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Interface to heat port of surfaces of models that compute the heat conduction outside of this room&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Sources.html#Modelica.Thermal.HeatTransfer.Sources.PrescribedTemperature"
>Modelica.Thermal.HeatTransfer.Sources.PrescribedTemperature</a> cfdHeaPorAir <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Interface to heat port of air node&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDFluidInterface"
>CFDFluidInterface</a> fluInt(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.CFDAirHeatMassBalance.Medium"
>Medium</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>massDynamics=massDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nPorts=nPorts,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>V=V,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>p_start=p_start,
    rho_start=rho_start) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fluid interface&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// The following list declares the first index minus 1</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// of the input and output signals to the CFD block.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// These parameters are then used to loop over the connectors, such</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// as</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//    for i in kConExt+1:kConExt+nConExt loop</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//      ...</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//    end for;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kConExt=0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to conExt&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kConExtWin=kConExt + nConExt <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to conExtWin&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kGlaUns=kConExtWin + nConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to glaUns&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kGlaSha=kGlaUns + nConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to glaSha&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kConExtWinFra=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>kGlaSha + nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;">
       else </span>kGlaSha <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Offset used to connect CFD signals to glaSha&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kConPar_a=kConExtWinFra + nConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to conPar_a&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kConPar_b=kConPar_a + nConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to conPar_b&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kConBou=kConPar_b + nConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to conBou&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kSurBou=kConBou + nConBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to surBou&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kHeaPorAir=kSurBou + nSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD output signal to air heat port (to send average temperature from CFD to Modelica)&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">//  final parameter Integer kUSha = kHeaPorAir + 1</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kUSha=kSurBou + nSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signal of shade&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kQRadAbs_flow=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>kUSha + nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;">
       else </span>kUSha <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signal that contains the radiation absorbed by the shade&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Because heaPorAir is only receiving T from CFD, but does not send Q_flow to CFD, there is no &#39;+1&#39; increment</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// for kTSha</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kTSha=kHeaPorAir + 1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to output signal that contains the shade temperature&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kQConGai_flow=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>kQRadAbs_flow +
      nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>kQRadAbs_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signal for connect convective sensible heat gain&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kQLatGai_flow=kQConGai_flow + 1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signal for connect radiative heat gain&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntP=kQLatGai_flow + 1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signal for pressure from the fluid ports&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntM_flow=kFluIntP + 1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signals for mass flow rate from the fluid ports&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntT_inflow=kFluIntM_flow + nPorts <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signals for inflowing temperature from the fluid ports&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntXi_inflow=kFluIntT_inflow + nPorts <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signals for inflowing species concentration from the fluid ports&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntC_inflow=kFluIntXi_inflow + nPorts*Medium.nXi <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to input signals for inflowing trace substances from the fluid ports&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Input signals to fluInt block</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntT_outflow=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>kTSha + nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;">
       else </span>kTSha <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to outgoing temperature for the fluid ports&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntXi_outflow=kFluIntT_outflow + nPorts <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to outgoing species concentration for the fluid ports&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kFluIntC_outflow=kFluIntXi_outflow + nPorts*Medium.nXi <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to outgoing trace substances for the fluid ports&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer kSen=kFluIntC_outflow + nPorts*Medium.nC <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Offset used to connect CFD signals to output sensor&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nSur=kSurBou + nSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of surfaces&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">function</span> assignSurfaceIdentifier

    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nConExt(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of exterior constructions&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nConExtWin(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of window constructions&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nConPar(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of partition constructions&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nConBou(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Number of constructions that have their outside surface exposed to the boundary of this room&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nSurBou(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Number of surface heat transfer models that connect to constructions that are modeled outside of this room&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nSur(min=2) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Total number of surfaces&quot;</span>;

    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Flag, set to true if any of the window in this room has a shade&quot;</span>;
    <span style="color: #006400; font-weight: normal; font-style: normal;">/*
    // Declaration of counters used in the loop.
    // This could be computed (again) in this function, but using it
    // as a function arguments avoids code duplication.
    input Integer kConExt &quot;Offset used to connect CFD signals to conExt&quot;;
    input Integer kConExtWin &quot;Offset used to connect CFD signals to conExtWin&quot;;
    input Integer kGlaUns &quot;Offset used to connect CFD signals to glaUns&quot;;
    input Integer kGlaSha &quot;Offset used to connect CFD signals to glaSha&quot;;
    input Integer kConExtWinFra &quot;Offset used to connect CFD signals to glaSha&quot;;
    input Integer kConPar_a &quot;Offset used to connect CFD signals to conPar_a&quot;;
    input Integer kConPar_b &quot;Offset used to connect CFD signals to conPar_b&quot;;
    input Integer kConBou &quot;Offset used to connect CFD signals to conBou&quot;;
    input Integer kSurBou &quot;Offset used to connect CFD signals to surBou&quot;;
*/</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Declaration of construction data</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String nameConExt[nConExt] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface name&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExt[nConExt] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface area&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> tilConExt[nConExt] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> bouConConExt[nConExt] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Boundary condition&quot;</span>;

    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String nameConExtWin[nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface name&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWin[nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface area&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> tilConExtWin[nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> bouConConExtWin[
      nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Boundary condition&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AGla[nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface area&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AFra[nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface area&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real uSha[nConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Shade ratio&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String nameConPar[nConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface name&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConPar[nConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface area&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> tilConPar[nConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> bouConConPar[nConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Boundary condition&quot;</span>;

    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String nameConBou[nConBou] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface name&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConBou[nConBou] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface area&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> tilConBou[nConBou] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> bouConConBou[nConBou] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Boundary condition&quot;</span>;

    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String nameSurBou[nSurBou] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface name&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> ASurBou[nSurBou] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface area&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> tilSurBou[nSurBou] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> bouConSurBou[nSurBou] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Boundary condition&quot;</span>;

    <span style="color: blue; font-weight: normal; font-style: normal;">output </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier"
>CFDSurfaceIdentifier</a> id[nSur] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Name of all surfaces&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
    id := <span style="color: red; font-weight: normal; font-style: normal;">cat</span>(
        1,
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConExt[i],
          A=AConExt[i],
          til=tilConExt[i],
          bouCon=bouConConExt[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExt},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConExtWin[i],
          A=AConExtWin[i],
          til=tilConExtWin[i],
          bouCon=bouConConExtWin[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConExtWin[i] + &quot; (glass, unshaded)&quot;,
          A=AGla[i]*(1-uSha[i]),
          til=tilConExtWin[i],
          bouCon=bouConConExtWin[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConExtWin[i] + &quot; (glass, shaded)&quot;,
          A=AGla[i]*uSha[i],
          til=tilConExtWin[i],
          bouCon=bouConConExtWin[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:(<span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;">
         else </span>0)},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConExtWin[i] + &quot; (frame)&quot;,
          A=AFra[i],
          til=tilConExtWin[i],
          bouCon=bouConConExtWin[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConPar[i] + &quot; (surface a)&quot;,
          A=AConPar[i],
          til=tilConPar[i],
          bouCon=bouConConPar[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConPar},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConPar[i] + &quot; (surface b)&quot;,
          A=AConPar[i],
          til=tilConPar[i] + Modelica.Constants.pi/180,
          bouCon=bouConConPar[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConPar},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameConBou[i],
          A=AConBou[i],
          til=tilConBou[i],
          bouCon=bouConConBou[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConBou},
        {<span style="color: red; font-weight: normal; font-style: normal;">CFDSurfaceIdentifier</span>(
          name=nameSurBou[i],
          A=ASurBou[i],
          til=tilSurBou[i],
          bouCon=bouConSurBou[i]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSurBou});
  <span style="color: blue; font-weight: normal; font-style: normal;">end </span>assignSurfaceIdentifier;

<span style="color: blue; font-weight: normal; font-style: normal;">public </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> QCon_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective sensible heat gains of the room&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> QLat_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Latent heat gains for the room&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> QTotCon_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total sensible convective heat flow rate added to the room&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Sensors.html#Modelica.Thermal.HeatTransfer.Sensors.HeatFlowSensor"
>Modelica.Thermal.HeatTransfer.Sensors.HeatFlowSensor</a> senHeaFlo <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sensor for heat flow added through the port heaPorAir&quot;</span>;
  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.to_W"
>to_W</a> QTotCon_flow_W;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
   startTime = time;

  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Xi_outflow_fixed[(i - 1)*Medium.nXi + j] = Medium.X_default[j];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      C_outflow_fixed[(i - 1)*Medium.nC + j] = 0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assignment of uStart</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:kUSha<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    uStart[i] = Medium.T_default;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      uStart[kUSha + i] = 0;
      uStart[kQRadAbs_flow + i] = 0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  uStart[kQConGai_flow + 1] = 0;
  uStart[kQLatGai_flow + 1] = 0;
  uStart[kFluIntP + 1] = p_start;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    uStart[kFluIntM_flow + i] = 0;
    uStart[kFluIntT_inflow + i] = Medium.T_default;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      uStart[kFluIntXi_inflow + (i - 1)*Medium.nXi + j] = Medium.X_default[j];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      uStart[kFluIntC_inflow + (i - 1)*Medium.nC + j] = 0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assignment of yFixed</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:kSurBou + nSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    yFixed[i] = Q_flow_fixed[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  yFixed[kHeaPorAir + 1] = TRooAve_fixed;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      yFixed[kTSha + i] = TSha_fixed[i];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    yFixed[kFluIntT_outflow + i] = T_outflow_fixed[i];
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      yFixed[kFluIntXi_outflow + (i - 1)*Medium.nXi + j] = Xi_outflow_fixed[(i
         - 1)*Medium.nXi + j];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      yFixed[kFluIntC_outflow + (i - 1)*Medium.nC + j] = C_outflow_fixed[(i - 1)
        *Medium.nC + j];
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSen<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    yFixed[kSen + i] = 0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Data exchange with CFD block</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExt<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>datConExt[i].boundaryCondition == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConExt + i], cfdConExt[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConExt + i], cfdConExt[i].Q_flow_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConExt + i], cfdConExt[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConExt + i], cfdConExt[i].T_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>datConExtWin[i].boundaryCondition == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConExtWin + i], cfdConExtWin[i].T_out);

        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConExtWin + i], cfdConExtWin[i].Q_flow_in);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kGlaUns + i], cfdGlaUns[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kGlaUns + i], cfdGlaUns[i].Q_flow_in);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConExtWinFra + i], cfdConExtWinFra[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConExtWinFra + i], cfdConExtWinFra[i].Q_flow_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConExtWin + i], cfdConExtWin[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConExtWin + i], cfdConExtWin[i].T_in);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kGlaUns + i], cfdGlaUns[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kGlaUns + i], cfdGlaUns[i].T_in);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConExtWinFra + i], cfdConExtWinFra[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConExtWinFra + i], cfdConExtWinFra[i].T_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>datConExtWin[i].boundaryCondition == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kGlaSha + i], cfdGlaSha[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kGlaSha + i], cfdGlaSha[i].Q_flow_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kGlaSha + i], cfdGlaSha[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kGlaSha + i], cfdGlaSha[i].T_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConPar<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>datConPar[i].boundaryCondition == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConPar_a + i], cfdConPar_a[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConPar_a + i], cfdConPar_a[i].Q_flow_in);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConPar_b + i], cfdConPar_b[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConPar_b + i], cfdConPar_b[i].Q_flow_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConPar_a + i], cfdConPar_a[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConPar_a + i], cfdConPar_a[i].T_in);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConPar_b + i], cfdConPar_b[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConPar_b + i], cfdConPar_b[i].T_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>datConBou[i].boundaryCondition == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConBou + i], cfdConBou[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConBou + i], cfdConBou[i].Q_flow_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kConBou + i], cfdConBou[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kConBou + i], cfdConBou[i].T_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>surBou[i].boundaryCondition == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kSurBou + i], cfdSurBou[i].T_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kSurBou + i], cfdSurBou[i].Q_flow_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kSurBou + i], cfdSurBou[i].Q_flow_out);
        <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kSurBou + i], cfdSurBou[i].T_in);
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdConExt.port, conExt);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdConExtWin.port, conExtWin);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdGlaUns.port, glaUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdGlaSha.port, glaSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdConExtWinFra.port, conExtWinFra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdConPar_a.port, conPar_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdConPar_b.port, conPar_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdConBou.port, conBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfdSurBou.port, conSurBou);
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connections to heat port of air volume</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kHeaPorAir + 1], cfdHeaPorAir.T);
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connections to shade</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kUSha + i], uSha[i]);
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kQRadAbs_flow + i], QRadAbs_flow[i]);
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kTSha + i], TSha[i]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connection for heat gain that is added to the room</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// (averaged over the whole room air volume)</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(QTotCon_flow_W.y, cfd.u[kQConGai_flow + 1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(QLat_flow, cfd.u[kQLatGai_flow + 1]);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connections to fluid port</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(ports, fluInt.ports);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Output signals from fluInt block</span>

  <span style="color: #006400; font-weight: normal; font-style: normal;">// The pressure of the air volume will be sent from Modelica to CFD</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kFluIntP + 1], fluInt.p);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kFluIntM_flow + i], fluInt.m_flow[i]);
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kFluIntT_inflow + i], fluInt.T_inflow[i]);
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kFluIntXi_inflow + (i - 1)*Medium.nXi + j], fluInt.Xi_inflow[
        (i - 1)*Medium.nXi + j]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.u[kFluIntC_inflow + (i - 1)*Medium.nC + j], fluInt.C_inflow[(
        i - 1)*Medium.nC + j]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Input signals to fluInt block</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The pressures of ports[2:nPorts] will be sent from CFD to Modelica</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kFluIntT_outflow + i], fluInt.T_outflow[i]);
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kFluIntXi_outflow + (i - 1)*Medium.nXi + j], fluInt.Xi_outflow[
        (i - 1)*Medium.nXi + j]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kFluIntC_outflow + (i - 1)*Medium.nC + j], fluInt.C_outflow[
        (i - 1)*Medium.nC + j]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connections for sensor signal</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveSensor<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSen<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(cfd.y[kSen + i], yCFD[i]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(heaPorAir, senHeaFlo.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(senHeaFlo.port_b, cfdHeaPorAir.port);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(senHeaFlo.Q_flow, QTotCon_flow.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(QCon_flow, QTotCon_flow.u2);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(QTotCon_flow.y, QTotCon_flow_W.u);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>CFDAirHeatMassBalance;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE CFDExchange<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClasses.CFDExchangeI.png" alt="Buildings.Rooms.BaseClasses.CFDExchange" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.CFDExchange"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.CFDExchange</h2>
<p>
<b>Block that exchanges data with the CFD code</b>
<br>
<br><img src="Buildings.Rooms.BaseClasses.CFDExchangeD.png" alt="Buildings.Rooms.BaseClasses.CFDExchange">
</p>
<h3>Information</h3>

<p>
This block samples interface variables and exchanges data with the CFD code.
</p>
<p>
For a documentation of the exchange parameters and variables, see
<a href="Buildings_Rooms_UsersGuide.html#Buildings.Rooms.UsersGuide.CFD"
>
Buildings.Rooms.UsersGuide.CFD</a>.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.DiscreteBlock"
>Modelica.Blocks.Interfaces.DiscreteBlock</a> (Base class of discrete control blocks).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>samplePeriod</td><td>&nbsp;</td><td>Sample period of component [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>startTime</td><td>0</td><td>First sample time instant [s]</td></tr>
<tr><td>String</td><td>cfdFilNam</td><td>&nbsp;</td><td>CFD input file name</td></tr>
<tr><td>Boolean</td><td>activateInterface</td><td>true</td><td>Set to false to deactivate interface and use instead yFixed as output</td></tr>
<tr><td>Integer</td><td>nXi</td><td>&nbsp;</td><td>Number of independent species concentration of the inflowing medium</td></tr>
<tr><td>Integer</td><td>nC</td><td>&nbsp;</td><td>Number of trace substances of the inflowing medium</td></tr>
<tr><td>Integer</td><td>nWri</td><td>&nbsp;</td><td>Number of values to write to the CFD simulation</td></tr>
<tr><td>Integer</td><td>nRea</td><td>&nbsp;</td><td>Number of double values to be read from the CFD simulation</td></tr>
<tr><td>Integer</td><td>flaWri[nWri]</td><td>ones(nWri)</td><td>Flag for double values (0: use current value, 1: use average over interval, 2: use integral over interval)</td></tr>
<tr><td>Real</td><td>uStart[nWri]</td><td>&nbsp;</td><td>Initial input signal, used during first data transfer with CFD simulation</td></tr>
<tr><td>Real</td><td>yFixed[nRea]</td><td>&nbsp;</td><td>Fixed output, used if activateInterface=false</td></tr>
<tr><td>Integer</td><td>nSur</td><td>&nbsp;</td><td>Number of surfaces</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>number of exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier"
>CFDSurfaceIdentifier</a></td><td>surIde[nSur]</td><td>&nbsp;</td><td>Surface identifiers</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Set to true if at least one window in the room has a shade</td></tr>
<tr><td>Boolean</td><td>haveSensor</td><td>&nbsp;</td><td>Flag, true if the model has at least one sensor</td></tr>
<tr><td>String</td><td>sensorName[:]</td><td>&nbsp;</td><td>Names of sensors as declared in the CFD input file</td></tr>
<tr><td>String</td><td>portName[:]</td><td>&nbsp;</td><td>Names of fluid ports as declared in the CFD input file</td></tr>
<tr><td>Boolean</td><td>verbose</td><td>false</td><td>Set to true for verbose output</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rho_start</td><td>&nbsp;</td><td>Density at initial state [kg/m3]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>u[nWri]</td><td>Inputs to CFD</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y[nRea]</td><td>Outputs received from CFD</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">block</span> CFDExchange <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Block that exchanges data with the CFD code&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.DiscreteBlock"
>Modelica.Blocks.Interfaces.DiscreteBlock</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String cfdFilNam <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;CFD input file name&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean activateInterface=true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to false to deactivate interface and use instead yFixed as output&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nXi <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of independent species concentration of the inflowing medium&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nC <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of trace substances of the inflowing medium&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nWri(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of values to write to the CFD simulation&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nRea(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of double values to be read from the CFD simulation&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer flaWri[nWri] =<span style="color: red; font-weight: normal; font-style: normal;"> ones</span>(nWri) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag for double values (0: use current value, 1: use average over interval, 2: use integral over interval)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real uStart[nWri] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial input signal, used during first data transfer with CFD simulation&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real yFixed[nRea] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fixed output, used if activateInterface=false&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nSur(min=2) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nConExtWin(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;number of exterior construction with window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier"
>CFDSurfaceIdentifier</a> surIde[nSur] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface identifiers&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if at least one window in the room has a shade&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveSensor <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if the model has at least one sensor&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String sensorName[:] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Names of sensors as declared in the CFD input file&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String portName[:] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Names of fluid ports as declared in the CFD input file&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean verbose=false <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Set to true for verbose output&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_start <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Density at initial state&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> u[nWri] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Inputs to CFD&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> y[nRea] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Outputs received from CFD&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real uInt[nWri] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Value of integral&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real uIntPre[nWri] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Value of integral at previous sampling instance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real uWri[nWri] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Value to be sent to the CFD interface&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nSen(min=0) =<span style="color: red; font-weight: normal; font-style: normal;"> size</span>(sensorName, 1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of sensors that are connected to CFD output&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nPorts=<span style="color: red; font-weight: normal; font-style: normal;">size</span>(portName, 1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of fluid ports for the HVAC inlet and outlets&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real _uStart[nWri]={<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(flaWri[i] &lt;= 1)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>uStart[i]<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
      uStart[i]*samplePeriod <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nWri} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial input signal, used during first data transfer with CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> modTimRea <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Current model time received from CFD&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Integer retVal <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Return value from CFD&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">///////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Function that sends the parameters of the model from Modelica to CFD</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">function</span> sendParameters
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String cfdFilNam <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;CFD input file name&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String[nSur] name <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface names&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a>[nSur] A <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface areas&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a>[nSur] til <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a>[nSur] bouCon <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Type of boundary condition&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nPorts(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Number of fluid ports for the HVAC inlet and outlets&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String portName[nPorts] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Names of fluid ports as declared in the CFD input file&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean haveSensor <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag, true if the model has at least one sensor&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String sensorName[nSen] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Names of sensors as declared in the CFD input file&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag, true if the windows have a shade&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nSur(min=2) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of surfaces&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nSen(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Number of sensors that are connected to CFD output&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nConExtWin(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;number of exterior construction with window&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean verbose <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Set to true for verbose output&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nXi <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Number of independent species concentration of the inflowing medium&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nC <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of trace substances of the inflowing medium&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_start <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Density at initial state&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
    Integer coSimFlag=0;
  <span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>verbose<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(&quot;CFDExchange:sendParameter&quot;);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSur<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(A[i] &gt; 0, &quot;Surface must be bigger than zero.&quot;);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

    <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(string=&quot;Start cosimulation&quot;);
    coSimFlag := <span style="color: red; font-weight: normal; font-style: normal;">cfdStartCosimulation</span>(
        cfdFilNam,
        name,
        A,
        til,
        bouCon,
        nPorts,
        portName,
        haveSensor,
        sensorName,
        haveShade,
        nSur,
        nSen,
        nConExtWin,
        nXi,
        nC,
        rho_start);
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(coSimFlag &lt; 0.5, &quot;Could not start the cosimulation.&quot;);

  <span style="color: blue; font-weight: normal; font-style: normal;">end </span>sendParameters;

  <span style="color: #006400; font-weight: normal; font-style: normal;">///////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Function that exchanges data during the time stepping between</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Modelica and CFD.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">function</span> exchange
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer flag <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Communication flag to write to CFD&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> t <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Current simulation time in seconds to write&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> dt(min=100*Modelica.Constants.eps) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Requested time step length&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real[nU] u <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Input for CFD&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nU <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of inputs for CFD&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real[nY] yFixed <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fixed values (used for debugging only)&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nY <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of outputs from CFD&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">output </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> modTimRea <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Current model time in seconds read from CFD&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean verbose <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Set to true for verbose output&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real[nY] y <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Output computed by CFD&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Integer retVal <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;The exit value, which is negative if an error occurred&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>verbose<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(&quot;CFDExchange:exchange at t=&quot; + <span style="color: red; font-weight: normal; font-style: normal;">String</span>(t));
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

    (modTimRea,y,retVal) := <span style="color: red; font-weight: normal; font-style: normal;">cfdExchangeData</span>(
        flag,
        t,
        dt,
        u,
        nU,
        nY);
  <span style="color: blue; font-weight: normal; font-style: normal;">end </span>exchange;

  <span style="color: #006400; font-weight: normal; font-style: normal;">///////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Function that returns strings that are not unique.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">function</span> returnNonUniqueStrings
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer n(min=2) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number entries&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean ideNam[n - 1] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Flag that is set to true if the name is used more than once&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String names[n] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Names&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">output </span>String s <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;String with non-unique names&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
    s := &quot;&quot;;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:n - 1<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ideNam[i]<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        s := s + &quot;\n  &#39;&quot; + names[i] + &quot;&#39;&quot;;
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end </span>returnNonUniqueStrings;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// This function does not work because Dymola 2014 has problems with</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// handling strings in an algorithm section</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">function</span> assertStringsAreUnique
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String descriptiveName <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Descriptive name of what is tested, such as &#39;sensor&#39; or &#39;ports&#39;&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer n(min=2) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of strings&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String names[n] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Names&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
    Boolean ideNam[n-1] <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Flag that is set to true if the name is used more than once&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">  // Loop over all names to verify that they are unique</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>n &gt; 1<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:n-1<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>i+1:n<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
          ideNam[i] := <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Strings.isEqual</span>(names[i], names[j]);
          <span style="color: blue; font-weight: normal; font-style: normal;">if </span>ideNam[i]<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
            break;
          <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
        <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>; <span style="color: #006400; font-weight: normal; font-style: normal;">// j</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>; <span style="color: #006400; font-weight: normal; font-style: normal;">// i</span>

      <span style="color: red; font-weight: normal; font-style: normal;">assert</span>( <span style="color: blue; font-weight: normal; font-style: normal;">not </span><span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.BooleanVectors.anyTrue</span>(ideNam),
      &quot;For the CFD interface, all &quot; + descriptiveName +
      &quot; must have a name that is unique within each room.
      The following &quot;
        + descriptiveName + &quot; names are used more than once in the room model:&quot; +
      <span style="color: red; font-weight: normal; font-style: normal;">returnNonUniqueStrings</span>(n, ideNam, names));
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      ideNam :=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(false, <span style="color: red; font-weight: normal; font-style: normal;">max</span>(0, n - 1));
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end </span>assertStringsAreUnique;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Diagnostics output</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>verbose<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
   <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(string=&quot;
CFDExchange has the following surfaces:&quot;);
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSur<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(string=&quot;
  name = &quot; + surIde[i].name + &quot;
  A    = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(surIde[i].A) + &quot; [m2]
  tilt = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(surIde[i].til*180/Modelica.Constants.pi) + &quot; [deg]&quot;);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveSensor<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(string=&quot;
CFDExchange has the following sensors:&quot;);
      <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSen<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
        <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(string=&quot;  &quot; + sensorName[i]);
      <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(string=&quot;CFDExchange has no sensors.&quot;);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assert that the surface, sensor and ports have a name,</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// and that that name is unique.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Otherwise, stop with an error.</span>

  <span style="color: red; font-weight: normal; font-style: normal;">assertStringsAreUnique</span>(descriptiveName=&quot;surface&quot;,
                         n=nSur,
                         names={surIde[i].name <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSur});
  <span style="color: red; font-weight: normal; font-style: normal;">assertStringsAreUnique</span>(descriptiveName=&quot;sensor&quot;,
                         n=nSen,
                         names=sensorName);
  <span style="color: red; font-weight: normal; font-style: normal;">assertStringsAreUnique</span>(descriptiveName=&quot;ports&quot;,
                         n=nPorts,
                         names=portName);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Send parameters to the CFD interface</span>
  <span style="color: red; font-weight: normal; font-style: normal;">sendParameters</span>(
    cfdFilNam=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.BoundaryConditions.WeatherData.BaseClasses.getAbsolutePath</span>(cfdFilNam),
    name=surIde[:].name,
    A=surIde[:].A,
    til=surIde[:].til,
    bouCon=surIde[:].bouCon,
    haveSensor=haveSensor,
    portName=portName,
    sensorName=sensorName,
    haveShade=haveShade,
    nSur=nSur,
    nSen=nSen,
    nConExtWin=nConExtWin,
    nPorts=nPorts,
    nXi=nXi,
    nC=nC,
    rho_start=rho_start,
    verbose=verbose);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assignment of parameters and start values</span>
  uInt =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(nWri);
  uIntPre =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(nWri);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nWri<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(flaWri[i] &gt;= 0<span style="color: blue; font-weight: normal; font-style: normal;"> and </span>flaWri[i] &lt;= 2,
      &quot;Parameter flaWri out of range for &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(i) + &quot;-th component.&quot;);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign uWri and y. This avoids a translation warning in Dymola</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// as otherwise, not all initial values are specified.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// However, uWri and y are only used below in the body of the &#39;when&#39;</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// block after they have been assigned.</span>
  uWri =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, nWri);
  y=yFixed;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nWri<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">der</span>(uInt[i]) = <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(flaWri[i] &gt; 0)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>u[i]<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">when </span>sampleTrigger<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Compute value that will be sent to the CFD interface</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nWri<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(flaWri[i] == 0)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        uWri[i] :=<span style="color: red; font-weight: normal; font-style: normal;"> pre</span>(u[i]);
      <span style="color: blue; font-weight: normal; font-style: normal;">elseif </span>(flaWri[i] == 1)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(time&lt;startTime+0.1*samplePeriod)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
           uWri[i] :=<span style="color: red; font-weight: normal; font-style: normal;"> pre</span>(u[i]);
          <span style="color: #006400; font-weight: normal; font-style: normal;"> // Set the correct initial data</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
           uWri[i] := (uInt[i] - uIntPre[i])/samplePeriod;
        <span style="color: #006400; font-weight: normal; font-style: normal;">// Average value over the sampling interval</span>
        <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        uWri[i] := uInt[i] - uIntPre[i];
        <span style="color: #006400; font-weight: normal; font-style: normal;">// Integral over the sampling interval</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

    <span style="color: #006400; font-weight: normal; font-style: normal;">// Exchange data</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(activateInterface<span style="color: blue; font-weight: normal; font-style: normal;"> and </span>(<span style="color: blue; font-weight: normal; font-style: normal;">not </span><span style="color: red; font-weight: normal; font-style: normal;">terminal</span>()))<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      (modTimRea,y,retVal) :=<span style="color: red; font-weight: normal; font-style: normal;"> exchange</span>(
        flag=0,
        t=time,
        dt=samplePeriod,
        u=uWri,
        nU=<span style="color: red; font-weight: normal; font-style: normal;">size</span>(u, 1),
        yFixed=yFixed,
        nY=<span style="color: red; font-weight: normal; font-style: normal;">size</span>(y, 1),
        verbose=verbose);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      modTimRea := time;
      y := yFixed;
      retVal := 0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

    <span style="color: #006400; font-weight: normal; font-style: normal;">// Check for valid return flags</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(retVal &gt;= 0,
      &quot;Obtained negative return value during data transfer with CFD.\n&quot; +
      &quot;   Aborting simulation. Check CFD log file.\n&quot; +
      &quot;   Received: retVal = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(retVal));

    <span style="color: #006400; font-weight: normal; font-style: normal;">// Store current value of integral</span>
    uIntPre := uInt;

  <span style="color: blue; font-weight: normal; font-style: normal;">end when</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">when </span><span style="color: red; font-weight: normal; font-style: normal;">terminal</span>()<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(
      <span style="color: red; font-weight: normal; font-style: normal;">rem</span>(time - startTime, samplePeriod) &lt; 0.00001,
      &quot;Warning: The simulation time is not a multiple of sampling time.&quot;,
      level=AssertionLevel.warning);
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>verbose<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Streams.print</span>(&quot;CFDExchange:terminate at t=&quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(
        time));
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Send the stopping singal to CFD</span>
    <span style="color: red; font-weight: normal; font-style: normal;">cfdSendStopCommand</span>();

    <span style="color: #006400; font-weight: normal; font-style: normal;">// Last exchange of data</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>activateInterface<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      (modTimRea,y,retVal) :=<span style="color: red; font-weight: normal; font-style: normal;"> exchange</span>(
        flag=0,
        t=time,
        dt=samplePeriod,
        u=uWri,
        nU=<span style="color: red; font-weight: normal; font-style: normal;">size</span>(u, 1),
        yFixed=yFixed,
        nY=<span style="color: red; font-weight: normal; font-style: normal;">size</span>(y, 1),
        verbose=verbose);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      modTimRea := time;
      y := yFixed;
      retVal := 0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Check if CFD has successfully stopped</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">cfdReceiveFeedback</span>() &lt; 0.5, &quot;Could not terminate the cosimulation.&quot;);

  <span style="color: blue; font-weight: normal; font-style: normal;">end when</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>CFDExchange;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE CFDFluidInterface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass8aec9b62b9547120rfaceI.png" alt="Buildings.Rooms.BaseClasses.CFDFluidInterface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.CFDFluidInterface"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.CFDFluidInterface</h2>
<p>
<br><img src="Buildings.Rooms.BaseClass8aec9b62b9547120rfaceD.png" alt="Buildings.Rooms.BaseClasses.CFDFluidInterface">
</p>
<h3>Information</h3>

<p>
This model is used to connect the fluid port with
the block that communicates with the CFD program.
</p>
<p>
This model also implements the pressure balance of the medium, as the
FFD implementation uses a constant pressure that is independent of the
pressure of the Modelica model.
If the parameter <code>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState</code>,
then there is a steady-state mass balance and the pressure of the room
is an algebraic variable.
Otherwise, the time derivative of the pressure is
</p>
<p align="center" style="font-style:italic;">
dp&frasl;dt = p_<sub>start</sub> &nbsp; &sum; m&#775;<sub>i</sub> &frasl; m<sub>start</sub>,
</p>
<p>
where
<i>p_<sub>start</sub></i> is the initial pressure,
<i>&sum; m&#775;<sub>i</sub></i> is the sum of the mass flow rates over all ports, and
<i>m<sub>start</sub></i> is the initial mass of the room.
</p>

<p>Extends from <a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a> (Base icon).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rho_start</td><td>&nbsp;</td><td>Density, used to compute fluid mass [kg/m3]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</a></td><td>V</td><td>&nbsp;</td><td>Volume [m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Medium in the component</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>T_outflow[nPorts]</td><td>Temperature if m_flow &lt; 0 [K]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>Xi_outflow[nPorts*Medium.nXi]</td><td>Species concentration if m_flow &lt; 0 [1]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>C_outflow[nPorts*Medium.nC]</td><td>Trace substances if m_flow &lt; 0</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>p</td><td>Room-averaged total pressure [Pa]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>m_flow[nPorts]</td><td>Mass flow rates [kg/s]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>T_inflow[nPorts]</td><td>Temperature if m_flow &gt;= 0 [K]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>Xi_inflow[nPorts*Medium.nXi]</td><td>Species concentration if m_flow &gt;= 0 [1]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>C_inflow[nPorts*Medium.nC]</td><td>Trace substances if m_flow &gt;= 0</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> CFDFluidInterface
 <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a>;

   <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
    <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium in the component&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assumptions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics=Modelica.Fluid.Types.Dynamics.DynamicFreeInitial <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of mass balance&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Initialization</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium.AbsolutePressure</a> p_start = Medium.p_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of pressure&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Parameters for the model</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nPorts(min=0)=0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of ports&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_start <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Density, used to compute fluid mass&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Modelica.SIunits.Volume</a> V <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a> m_start = rho_start * V <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial mass of air inside the room.&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> T_outflow[nPorts](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=Medium.T_default,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=300,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;K&quot;,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>displayUnit=&quot;degC&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Temperature if m_flow &lt; 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Xi_outflow[nPorts*Medium.nXi](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;1&quot;) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>Medium.nXi &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Species concentration if m_flow &lt; 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> C_outflow[nPorts*Medium.nC](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>Medium.nC &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Trace substances if m_flow &lt; 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> p(
    start=p_start,
    min=80000,
    nominal=100000,
    max=120000,
    unit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Room-averaged total pressure&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> m_flow[nPorts](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>quantity=&quot;MassFlowRate&quot;,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;kg/s&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Mass flow rates&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> T_inflow[nPorts](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=Medium.T_default,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=200,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=373.15,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=300,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;K&quot;,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>displayUnit=&quot;degC&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Temperature if m_flow &gt;= 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> Xi_inflow[nPorts*Medium.nXi](
  min=0,
  max=1,
  unit=&quot;1&quot;) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     Medium.nXi &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Species concentration if m_flow &gt;= 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> C_inflow[nPorts*Medium.nC](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     Medium.nC &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Trace substances if m_flow &gt;= 0&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Fluid port</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b</a> ports[nPorts](
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.CFDFluidInterface.Medium"
>Medium</a>) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fluid inlets and outlets&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> Xi_inflow_internal[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(nPorts, nPorts*Medium.nXi)](
  min=0,
  max=1,
  unit=&quot;1&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Species concentration if m_flow &gt;= 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> C_inflow_internal[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(nPorts, nPorts*Medium.nC)](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Trace substances if m_flow &gt;= 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Xi_outflow_internal[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(nPorts, nPorts*Medium.nXi)](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1,
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;1&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Species concentration if m_flow &lt; 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> C_outflow_internal[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(nPorts, nPorts*Medium.nC)](
  <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Trace substances if m_flow &lt; 0&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a>[Medium.nXi] mbXi_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Substance mass flows across boundaries&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> ports_mXi_flow[nPorts,Medium.nXi];

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//Disable it for shoebox model test</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//assert(nPorts &gt;= 2, &quot;The CFD model requires at least two fluid connections.&quot;);</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    p = p_start;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">der</span>(p) = 0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Internal connectors</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>Medium.nXi &gt; 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(Xi_inflow_internal,  Xi_inflow);
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(Xi_outflow_internal, Xi_outflow);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    Xi_inflow_internal  =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, nPorts);
    Xi_outflow_internal =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, nPorts);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>Medium.nC &gt; 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(C_inflow_internal,  C_inflow);
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(C_outflow_internal, C_outflow);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    C_inflow_internal  =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, nPorts);
    C_outflow_internal =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, nPorts);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Mass and pressure balance of bulk volume.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The assumption is that change in temperature does not change the pressure.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Otherwise, we would need to use the BaseProperties of the medium model.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    ports_mXi_flow[i,:] = ports[i].m_flow *<span style="color: red; font-weight: normal; font-style: normal;"> actualStream</span>(ports[i].Xi_outflow);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    mbXi_flow[i] =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(ports_mXi_flow[:,i]);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    0 =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(ports.m_flow) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(mbXi_flow);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// For the change in pressure, we neglect the term sum(mbXi_flow)</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// as this term is small compared to sum(ports.m_flow) but it</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// introduces a nonlinear equation</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">//    der(p) = p_start*(sum(ports.m_flow) + sum(mbXi_flow))/m_start;</span>
    <span style="color: red; font-weight: normal; font-style: normal;">der</span>(p) = p_start*(<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(ports.m_flow))/m_start;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connection of input signals to ports.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connect pressures.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    ports[i].p = p;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connect enthalpy, mass fraction and trace substances.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    ports[i].h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.specificEnthalpy_pTX</span>(
       p=p,
       T=T_outflow[i],
       X=Xi_outflow_internal[(i-1)*Medium.nXi+1:i*Medium.nXi]);
    ports[i].Xi_outflow = Xi_outflow_internal[(i-1)*Medium.nXi+1:i*Medium.nXi];
    ports[i].C_outflow  = C_outflow_internal[ (i-1)*Medium.nC +1:i*Medium.nC];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Connection of ports to output signals.</span>
   <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
     m_flow[i] = ports[i].m_flow;
     T_inflow[i] =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.temperature</span>(<span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_phX</span>(
       p=  p,
       h=<span style="color: red; font-weight: normal; font-style: normal;">  inStream</span>(ports[i].h_outflow),
       X=<span style="color: red; font-weight: normal; font-style: normal;">  inStream</span>(ports[i].Xi_outflow)));

     <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
       Xi_inflow_internal[(i-1)*Medium.nXi+j] =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(ports[i].Xi_outflow[j]);
     <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

     <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
       C_inflow_internal[(i-1)*Medium.nC+j]    =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(ports[i].C_outflow[j]);
     <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

   <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>CFDFluidInterface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE CFDHeatGain<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClasses.CFDHeatGainI.png" alt="Buildings.Rooms.BaseClasses.CFDHeatGain" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.CFDHeatGain"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.CFDHeatGain</h2>
<p>
<b>Model to convert internal heat gain signals</b>
<br>
<br><img src="Buildings.Rooms.BaseClasses.CFDHeatGainD.png" alt="Buildings.Rooms.BaseClasses.CFDHeatGain">
</p>
<h3>Information</h3>

This model computes the radiant, convective and latent heat flow.
Input into this model are these three components in units of [W/m2].
The inputs need to be positive quantities if heat or moisture is added
to the room.
The outputs are
<ul>
<li>
the radiant heat flow in Watts,
</li>
<li>
the convective heat flow in Watts, and
</li>
<li>
the water vapor released into the air.
</li>
</ul>

<p>Extends from <a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a> (Base icon).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>AFlo</td><td>&nbsp;</td><td>Floor area [m2]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>qGai_flow[3]</td><td>Radiant, convective and latent heat input into room (positive if heat gain)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>QRad_flow</td><td>Radiant heat input into room (positive if heat gain) [W]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>QCon_flow</td><td>Convective sensible heat input into room (positive if heat gain) [W]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>QLat_flow</td><td>Latent heat input into room (positive if heat gain) [W]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> CFDHeatGain <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Model to convert internal heat gain signals&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AFlo <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Floor area&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> qGai_flow[3] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiant, convective and latent heat input into room (positive if heat gain)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> QRad_flow(unit=&quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiant heat input into room (positive if heat gain)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> QCon_flow(unit=&quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective sensible heat input into room (positive if heat gain)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> QLat_flow(unit=&quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Latent heat input into room (positive if heat gain)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  {QRad_flow, QCon_flow, QLat_flow} = AFlo .* qGai_flow;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>CFDHeatGain;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE CFDSurfaceInterface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClasse29360c724dffdf7rfaceI.png" alt="Buildings.Rooms.BaseClasses.CFDSurfaceInterface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.CFDSurfaceInterface"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.CFDSurfaceInterface</h2>
<p>
<br><img src="Buildings.Rooms.BaseClasse29360c724dffdf7rfaceD.png" alt="Buildings.Rooms.BaseClasses.CFDSurfaceInterface">
</p>
<h3>Information</h3>

<p>
This model is used to connect temperatures and heat flow rates between the
block that communicates with the CFD program
and the heat port of the model that encapsulates the air heat and mass balance.
</p>

<p>Extends from <a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a> (Base icon).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>CFDBoundaryConditions</a></td><td>bouCon</td><td>&nbsp;</td><td>Boundary condition used in the CFD simulation</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>Q_flow_in</td><td>Surface heat flow rate, used for temperature boundary condition</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>T_out</td><td>Surface temperature, used for temperature boundary condition</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>Q_flow_out</td><td>Surface heat flow rate, used for temperature boundary condition</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>T_in</td><td>Surface temperature, used for temperature boundary condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>port</td><td>Heat ports</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> CFDSurfaceInterface
 <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> bouCon <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Boundary condition used in the CFD simulation&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Q_flow_in <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    bouCon == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface heat flow rate, used for temperature boundary condition&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> T_out <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    bouCon == Buildings.Rooms.Types.CFDBoundaryConditions.Temperature <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface temperature, used for temperature boundary condition&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> Q_flow_out <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    bouCon == Buildings.Rooms.Types.CFDBoundaryConditions.HeatFlowRate <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface heat flow rate, used for temperature boundary condition&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> T_in <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    bouCon == Buildings.Rooms.Types.CFDBoundaryConditions.HeatFlowRate <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface temperature, used for temperature boundary condition&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> port <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat ports&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Internal connectors to change causality depending on the specifie</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// boundary condition</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Q_flow_internal <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface heat flow rate&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> T_internal <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface temperature&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T_internal,      T_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(Q_flow_internal, Q_flow_in);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T_internal,      T_in);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(Q_flow_internal, Q_flow_out);
  T_internal      = port.T;
  Q_flow_internal = port.Q_flow;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>CFDSurfaceInterface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ExteriorBoundaryConditions<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass463e41028452bddftionsI.png" alt="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.ExteriorBoundaryConditions</h2>
<p>
<b>Model for convection and radiation bounary condition of exterior constructions</b>
<br>
<br><img src="Buildings.Rooms.BaseClass463e41028452bddftionsD.png" alt="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions">
</p>
<h3>Information</h3>

This model computes the boundary conditions for the outside-facing surface of
opaque constructions.
<p>
The model computes the infrared, solar, and convective heat exchange
between these surfaces and the exterior temperature and the sky temperature.
Input into this model are weather data that may be obtained from
<a href="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData"
>
Buildings.BoundaryConditions.WeatherData</a>.
</p>
<p>
In this model, the solar radiation data are converted from horizontal irradiation to
irradiation on tilted surfaces using models from the package
<a href="Buildings_BoundaryConditions_SolarIrradiation.html#Buildings.BoundaryConditions.SolarIrradiation"
>
Buildings.BoundaryConditions.SolarIrradiation</a>.
The convective heat transfer between the exterior surface of the opaque constructions
is computed using
<a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection"
>
Buildings.HeatTransfer.Convection</a>.
</p>
<p>
The heat transfer of windows are not computed in this model. They are implemented in
<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow"
>
Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow</a>.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>lat</td><td>&nbsp;</td><td>Latitude [rad]</td></tr>
<tr><td>Boolean</td><td>linearizeRadiation</td><td>&nbsp;</td><td>Set to true to linearize emissive power</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>conPar[nCon]</td><td>redeclare parameter Paramete...</td><td>Records for construction</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nCon</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Convective heat transfer</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.ExteriorConvection"
>ExteriorConvection</a></td><td>conMod</td><td>Buildings.HeatTransfer.Types...</td><td>Convective heat transfer model for opaque part of the constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</a></td><td>hFixed</td><td>10.0</td><td>Constant convection coefficient for opaque part of the constructions [W/(m2.K)]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>opa_a[nCon]</td><td>Heat port at surface a of opaque construction</td></tr>
<tr><td><a href="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Bus</a></td><td>weaBus</td><td>&nbsp;</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ExteriorBoundaryConditions <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Model for convection and radiation bounary condition of exterior constructions&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nCon(min=1) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> lat <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Latitude&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean linearizeRadiation <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to linearize emissive power&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a> conPar[nCon] <span style="color: blue; font-weight: normal; font-style: normal;">constrainedby </span>
    ParameterConstruction <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Records for construction&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> opa_a[nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port at surface a of opaque construction&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.ExteriorConvection"
>Buildings.HeatTransfer.Types.ExteriorConvection</a> conMod=
  Buildings.HeatTransfer.Types.ExteriorConvection.TemperatureWind <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective heat transfer model for opaque part of the constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</a> hFixed=10.0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Constant convection coefficient for opaque part of the constructions&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// The convection coefficients are not final to allow a user to individually</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// assign them.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// We reassign the tilt since a roof has been declared in the room model as the</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// ceiling (of the room)</span>
  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Exterior"
>HeatTransfer.Convection.Exterior</a> conOpa[nCon](
    A=AOpa,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til=Modelica.Constants.pi*<span style="color: red; font-weight: normal; font-style: normal;">ones</span>(nCon) .- conPar[:].til,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>azi=conPar[:].azi,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convection model for opaque part of the wall&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SkyRadiationExchange"
>SkyRadiationExchange</a> skyRadExc(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>n=nCon,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AOpa,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>absIR=conPar[:].layers.absIR_a,
    vieFacSky={(Modelica.Constants.pi - conPar[i].til)./Modelica.Constants.pi <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nCon}) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Infrared radiative heat exchange with sky&quot;</span>;
  <a href="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>BoundaryConditions.WeatherData.Bus</a> weaBus;

  <a href="Buildings_BoundaryConditions_SolarIrradiation.html#Buildings.BoundaryConditions.SolarIrradiation.DirectTiltedSurface"
>BoundaryConditions.SolarIrradiation.DirectTiltedSurface</a> HDirTil[
            nCon](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>lat=lat,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til=conPar[:].til,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>azi=conPar[:].azi) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Direct solar irradiation on the surface&quot;</span>;
  <a href="Buildings_BoundaryConditions_SolarIrradiation.html#Buildings.BoundaryConditions.SolarIrradiation.DiffusePerez"
>BoundaryConditions.SolarIrradiation.DiffusePerez</a> HDifTil[nCon](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>lat=lat,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til=conPar[:].til,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>azi=conPar[:].azi) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Diffuse solar irradiation&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> HTotConExt[nCon](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>k1=conPar[:].layers.absSol_a .* AOpa,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>k2=conPar[:].layers.absSol_a .* AOpa) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Total solar irradiation&quot;</span>;
  <a href="Buildings_HeatTransfer_Sources.html#Buildings.HeatTransfer.Sources.PrescribedHeatFlow"
>Buildings.HeatTransfer.Sources.PrescribedHeatFlow</a> solHeaGaiConExt[nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total solar heat gain of the surface&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AOpa[nCon]=conPar[:].A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Area of opaque construction&quot;</span>;

  <a href="Buildings_HeatTransfer_Sources.html#Buildings.HeatTransfer.Sources.PrescribedTemperature"
>Buildings.HeatTransfer.Sources.PrescribedTemperature</a> TAirConExt[
    nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Outside air temperature for exterior constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Routing.html#Modelica.Blocks.Routing.Replicator"
>Modelica.Blocks.Routing.Replicator</a> repConExt(nout=nCon) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Signal replicator&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Routing.html#Modelica.Blocks.Routing.Replicator"
>Modelica.Blocks.Routing.Replicator</a> repConExt1(
                                               nout=nCon) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Signal replicator&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Routing.html#Modelica.Blocks.Routing.Replicator"
>Modelica.Blocks.Routing.Replicator</a> repConExt2(
                                               nout=nCon) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Signal replicator&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conOpa.solid, opa_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(skyRadExc.port, opa_a);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(TAirConExt.port, conOpa.fluid);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExt.y, TAirConExt.T);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExt.u, weaBus.TDryBul);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(skyRadExc.TOut, weaBus.TDryBul);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(skyRadExc.TBlaSky, weaBus.TBlaSky);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nCon<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(weaBus, HDirTil[i].weaBus);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDifTil[i].weaBus, weaBus);
   <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HTotConExt.y, solHeaGaiConExt.Q_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(solHeaGaiConExt.port, opa_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDirTil.H, HTotConExt.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDifTil.H, HTotConExt.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExt2.u, weaBus.winDir);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExt1.u, weaBus.winSpe);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExt1.y, conOpa.v);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExt2.y, conOpa.dir);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ExteriorBoundaryConditions;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ExteriorBoundaryConditionsWithWindow<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassc134fdd45fd20611indowI.png" alt="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.ExteriorBoundaryConditionsWithWindow</h2>
<p>
<b>Model for exterior boundary conditions for constructions with a window</b>
<br>
<br><img src="Buildings.Rooms.BaseClassc134fdd45fd20611indowD.png" alt="Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow">
</p>
<h3>Information</h3>

This model computes the boundary conditions for the outside-facing surface of
opaque constructions and of windows.
<p>
The model computes the infrared, solar, and convective heat exchange
between these surfaces and the exterior temperature and the sky temperature.
Input into this model are weather data that may be obtained from
<a href="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData"
>
Buildings.BoundaryConditions.WeatherData</a>.
</p>
<p>
This model extends
<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions"
>
Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions</a>,
which models the boundary conditions for the opaque constructions,
and then implements the boundary condition for windows by using
the model
<a href="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.ExteriorHeatTransfer"
>
Buildings.HeatTransfer.Windows.ExteriorHeatTransfer</a>.

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions"
>Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions</a> (Model for convection and radiation bounary condition of exterior constructions).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>lat</td><td>&nbsp;</td><td>Latitude [rad]</td></tr>
<tr><td>Boolean</td><td>linearizeRadiation</td><td>&nbsp;</td><td>Set to true to linearize emissive power</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nCon</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Convective heat transfer</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.ExteriorConvection"
>ExteriorConvection</a></td><td>conMod</td><td>Buildings.HeatTransfer.Types...</td><td>Convective heat transfer model for opaque part of the constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</a></td><td>hFixed</td><td>10.0</td><td>Constant convection coefficient for opaque part of the constructions [W/(m2.K)]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>opa_a[nCon]</td><td>Heat port at surface a of opaque construction</td></tr>
<tr><td><a href="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Bus</a></td><td>weaBus</td><td>&nbsp;</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>uSha[nCon]</td><td>Control signal for the shading device, 0: unshaded; 1: fully shaded</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>QAbsSolSha_flow[nCon]</td><td>Solar radiation absorbed by shade [W]</td></tr>
<tr><td>output <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</a></td><td>JOutUns[nCon]</td><td>Outgoing radiosity that connects to unshaded part of glass at exterior side [W]</td></tr>
<tr><td>input <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</a></td><td>JInUns[nCon]</td><td>Incoming radiosity that connects to unshaded part of glass at exterior side [W]</td></tr>
<tr><td>output <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</a></td><td>JOutSha[nCon]</td><td>Outgoing radiosity that connects to shaded part of glass at exterior side [W]</td></tr>
<tr><td>input <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</a></td><td>JInSha[nCon]</td><td>Incoming radiosity that connects to shaded part of glass at exterior side [W]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaUns[nCon]</td><td>Heat port at unshaded glass of exterior-facing surface</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaSha[nCon]</td><td>Heat port at shaded glass of exterior-facing surface</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>fra[nCon]</td><td>Heat port at frame of exterior-facing surface</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>HDir[nCon]</td><td>Direct solar irradition on tilted surface [W/m2]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>HDif[nCon]</td><td>Diffuse solar irradiation on tilted surface [W/m2]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>inc[nCon]</td><td>Incidence angle [rad]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ExteriorBoundaryConditionsWithWindow <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Model for exterior boundary conditions for constructions with a window&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions"
>Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions</a>(
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>AOpa=conPar[:].AOpa,
   <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow</a> conPar);

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AWin[nCon] = conPar[:].hWin .* conPar[:].wWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Window area&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveExteriorShade[nCon] = conPar[:].glaSys.haveExteriorShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if window has exterior shade (at surface a)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveInteriorShade[nCon] = conPar[:].glaSys.haveInteriorShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if window has interior shade (at surface b)&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveShade=
    <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.BooleanVectors.anyTrue</span>(haveExteriorShade)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
    <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.BooleanVectors.anyTrue</span>(haveInteriorShade) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if window system has a shade&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveOverhangOrSideFins=
    <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.BooleanVectors.anyTrue</span>(conPar.haveOverhangOrSideFins) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if the room has at least one window with either an overhang or side fins&quot;</span>;

  <a href="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.FixedShade"
>Buildings.HeatTransfer.Windows.FixedShade</a> sha[nCon](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>conPar=conPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>lat=lat,
    azi=conPar.azi) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveOverhangOrSideFins <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Shade due to overhang or side fins&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> uSha[nCon](min=0, max=1) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Control signal for the shading device, 0: unshaded; 1: fully shaded&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> QAbsSolSha_flow[nCon](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;W&quot;,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>quantity=&quot;Power&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Solar radiation absorbed by shade&quot;</span>;

  <a href="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.ExteriorHeatTransfer"
>HeatTransfer.Windows.ExteriorHeatTransfer</a> conExtWin[nCon](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=conPar[:].AWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>fFra=conPar[:].fFra,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearizeRadiation = linearizeRadiation,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>vieFacSky={(Modelica.Constants.pi - conPar[i].til) ./ Modelica.Constants.pi <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nCon},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>absIRSha_air=conPar[:].glaSys.shade.absIR_a,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>absIRSha_glass=conPar[:].glaSys.shade.absIR_b,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauIRSha_air=conPar[:].glaSys.shade.tauIR_a,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauIRSha_glass=conPar[:].glaSys.shade.tauIR_b,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveExteriorShade=haveExteriorShade,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveInteriorShade=haveInteriorShade) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Exterior convection of the window&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SkyRadiationExchange"
>SkyRadiationExchange</a> skyRadExcWin(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>n=nCon,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>absIR=conPar[:].glaSys.absIRFra,
    vieFacSky={(Modelica.Constants.pi - conPar[i].til) ./ Modelica.Constants.pi <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>
            1:nCon},
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=conPar[:].AWin .* conPar[:].fFra) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Infrared radiative heat exchange between window frame and sky&quot;</span>;
  <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>HeatTransfer.Interfaces.RadiosityOutflow</a> JOutUns[nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outgoing radiosity that connects to unshaded part of glass at exterior side&quot;</span>;
  <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>HeatTransfer.Interfaces.RadiosityInflow</a> JInUns[nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Incoming radiosity that connects to unshaded part of glass at exterior side&quot;</span>;
  <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>HeatTransfer.Interfaces.RadiosityOutflow</a> JOutSha[nCon] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outgoing radiosity that connects to shaded part of glass at exterior side&quot;</span>;
  <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>HeatTransfer.Interfaces.RadiosityInflow</a> JInSha[nCon] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Incoming radiosity that connects to shaded part of glass at exterior side&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaUns[nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port at unshaded glass of exterior-facing surface&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaSha[nCon] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port at shaded glass of exterior-facing surface&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> fra[nCon](T(<span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=
          300, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=283.15)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port at frame of exterior-facing surface&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> HTotConExtWinFra[nCon](
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>k1=conPar[:].fFra .* conPar[:].glaSys.absSolFra .* conPar[:].AWin,
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>k2=conPar[:].fFra .* conPar[:].glaSys.absSolFra .* conPar[:].AWin) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total solar irradiation on window frame&quot;</span>;
  <a href="Buildings_HeatTransfer_Sources.html#Buildings.HeatTransfer.Sources.PrescribedHeatFlow"
>Buildings.HeatTransfer.Sources.PrescribedHeatFlow</a> solHeaGaiConWin[nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total solar heat gain of the window frame&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> HDir[nCon](
     <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;RadiantEnergyFluenceRate&quot;,
     <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;W/m2&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Direct solar irradition on tilted surface&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> HDif[nCon](
     <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;RadiantEnergyFluenceRate&quot;,
     <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;W/m2&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Diffuse solar irradiation on tilted surface&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> inc[nCon](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;Angle&quot;,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;rad&quot;,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>displayUnit=&quot;deg&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Incidence angle&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="Buildings_HeatTransfer_Sources.html#Buildings.HeatTransfer.Sources.PrescribedTemperature"
>Buildings.HeatTransfer.Sources.PrescribedTemperature</a> TAirConExtWin[
    nCon] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Outside air temperature for window constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Routing.html#Modelica.Blocks.Routing.Replicator"
>Modelica.Blocks.Routing.Replicator</a> repConExtWin(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>nout=nCon) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Signal replicator&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Routing.html#Modelica.Blocks.Routing.Replicator"
>Modelica.Blocks.Routing.Replicator</a> repConExtWinVWin(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>nout=nCon) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Signal replicator&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Routing.html#Modelica.Blocks.Routing.Replicator"
>Modelica.Blocks.Routing.Replicator</a> repConExtWinTSkyBla(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>nout=nCon) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Signal replicator&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(uSha, conExtWin.uSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(JInUns,conExtWin. JInUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.JOutUns,JOutUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.glaUns,glaUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.glaSha,glaSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.JOutSha,JOutSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.JInSha,JInSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.frame,fra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(TAirConExtWin.port,conExtWin. air);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(TAirConExtWin.T,repConExtWin. y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExtWin.u, weaBus.TDryBul);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExtWinVWin.y,conExtWin. vWin);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExtWinVWin.u, weaBus.winSpe);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HTotConExtWinFra.y, solHeaGaiConWin.Q_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(solHeaGaiConWin.port, fra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDifTil.H, HDif);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDirTil.inc, inc);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HTotConExtWinFra.u2, HDifTil.H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(skyRadExcWin.TOut, weaBus.TDryBul);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(skyRadExcWin.TBlaSky, weaBus.TBlaSky);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(skyRadExcWin.port, fra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExtWin.y, conExtWin.TOut);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExtWinTSkyBla.y, conExtWin.TBlaSky);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(repConExtWinTSkyBla.u, weaBus.TBlaSky);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nCon<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sha[i].weaBus, weaBus);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDirTil.inc, sha.incAng);
  <span style="color: #006400; font-weight: normal; font-style: normal;">// OpenModelica does not remove the connect statement if conExtWin.QSolAbs_flow</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// is removed.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(QAbsSolSha_flow, conExtWin.QSolAbs_flow);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sha.HDirTilUns, HDirTil.H);

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveOverhangOrSideFins<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sha.HDirTil, HTotConExtWinFra.u1);
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sha.HDirTil, HDir);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDirTil.H, HTotConExtWinFra.u1);
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HDirTil.H, HDir);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ExteriorBoundaryConditionsWithWindow;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE InfraredRadiationExchange<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass39076b6d16b239c0hangeI.png" alt="Buildings.Rooms.BaseClasses.InfraredRadiationExchange" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.InfraredRadiationExchange"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.InfraredRadiationExchange</h2>
<p>
<b>Infrared radiation heat exchange between the room facing surfaces</b>
<br>
<br><img src="Buildings.Rooms.BaseClass39076b6d16b239c0hangeD.png" alt="Buildings.Rooms.BaseClasses.InfraredRadiationExchange">
</p>
<h3>Information</h3>

<p>
This model computes the infrared radiative heat transfer between the interior
surfaces of a room. Each opaque surface emits radiation according to
</p>
<p align="center" style="font-style:italic;">
  E<sup>i</sup> = &sigma; &nbsp; A<sup>i</sup> &nbsp; &epsilon;<sup>i</sup> &nbsp;
(T<sup>i</sup>)<sup>4</sup>,
</p>
<p>
where
<i>&sigma;</i>
is the Stefan-Boltzmann constant,
<i>A<sup>i</sup> </i>
is the surface area,
<i>&epsilon;<sup>i</sup> </i>
is the absorptivity in the infrared spectrum, and
<i>T<sup>i</sup></i>
is the surface temperature.
If the parameter <code>linearizeRadidation</code> is set to <code>true</code>,
then the term <i>(T<sup>i</sup>)<sup>4</sup></i> is replaced with
<i>T<sub>0</sub><sup>3</sup> T<sup>i</sup></i>,
where <i>T<sub>0</sub> = 20&deg;C</i> is a parameter.
</p>
<p>
The incoming radiation at surface <i>i</i> is
</p>
<p align="center" style="font-style:italic;">
  G<sup>i</sup> = -&sum;<sub>j</sub> &nbsp; F<sup>j,i</sup> &nbsp; J<sup>j</sup>
</p>
<p>
where
<i>F<sup>j,i</sup></i>
is the view factor from surface
<i>j</i> to surface <i>i</i>,
<i>J<sup>j</sup></i>
is the radiosity leaving surface <i>j</i>
and the sum is over all surfaces.
For opaque surfaces, it follows from the first law
that the radiosity
<i>J<sup>i</sup></i>
is
</p>
<p align="center" style="font-style:italic;">
 J<sup>i</sup> = -E<sup>i</sup>  - (1-&epsilon;<sup>i</sup>) &nbsp; G<sup>i</sup>.
</p>
<p>
For windows, the outgoing radiosity is an input into this model
because the window model computes this quantity directly.
</p>
<p>
For each surface <i>i</i>, the heat balance is
</p>
<p align="center" style="font-style:italic;">
  0 = Q<sup>i</sup> + J<sup>i</sup> + G<sup>i</sup>.
</p>
<p>
For opaque surfaces, the heat flow rate
<i>Q<sup>i</sup></i>
is set to be equal to the heat flow rate at the heat port.
For the glass of the windows, the radiosity outflow at the connector is
set to the radiosity
<i>G<sup>i</sup></i>
that is leaving the surface.
</p>
<p>
The view factor from surface <i>i</i> to <i>j</i> is approximated as
<p align="center" style="font-style:italic;">
  F<sup>i,j</sup> = A<sup>j</sup> &frasl; &sum;<sub>k </sub> A<sup>k</sup>.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a> (Partial model that is used for infrared radiation balance).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td>Boolean</td><td>linearizeRadiation</td><td>&nbsp;</td><td>Set to true to linearize emissive power</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
<tr><td>input <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>RadiosityInflow</a></td><td>JInConExtWin[NConExtWin]</td><td>Incoming radiosity that connects to non-frame part of the window [W]</td></tr>
<tr><td>output <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</a></td><td>JOutConExtWin[NConExtWin]</td><td>Outgoing radiosity that connects to non-frame part of the window [W]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> InfraredRadiationExchange <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Infrared radiation heat exchange between the room facing surfaces&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean linearizeRadiation <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to linearize emissive power&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization=true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;
  <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>HeatTransfer.Interfaces.RadiosityInflow</a> JInConExtWin[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
      haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Incoming radiosity that connects to non-frame part of the window&quot;</span>;
  <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>HeatTransfer.Interfaces.RadiosityOutflow</a> JOutConExtWin[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outgoing radiosity that connects to non-frame part of the window&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NOpa=NConExt + 2*NConExtWin + 2*NConPar + NConBou +
      NSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of opaque surfaces, including the window frame&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nOpa=nConExt + 2*nConExtWin + 2*nConPar + nConBou +
      nSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of opaque surfaces, including the window frame&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NWin=NConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of window surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nWin=nConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of window surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NTot=NOpa + NWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Total number of surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nTot=nOpa + nWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Total number of surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real epsOpa[nOpa](
    min=0,
    max=1,
    fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Absorptivity of opaque surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real rhoOpa[nOpa](
    min=0,
    max=1,
    fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Reflectivity of opaque surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AOpa[nOpa](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface area of opaque surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A[nTot](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface areas&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real kOpa[nOpa](unit=&quot;W/K4&quot;, fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Product sigma*epsilon*A for opaque surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real F[nTot, nTot](
    min=0,
    max=1,
    fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;View factor from surface i to j&quot;</span>;

   <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityInflow"
>Buildings.HeatTransfer.Interfaces.RadiosityInflow</a> JInConExtWin_internal[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Incoming radiosity that connects to non-frame part of the window&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> J[nTot](
    max=0,
    start=A .* 0.8*Modelica.Constants.sigma*293.15^4,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=10*0.8*Modelica.Constants.sigma*293.15^4) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiosity leaving the surface&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> G[nTot](
    min=0,
    start=A .* 0.8*Modelica.Constants.sigma*293.15^4,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=10*0.8*Modelica.Constants.sigma*293.15^4) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiosity entering the surface&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Real T30(unit=&quot;K3&quot;) = 293.15^3 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Nominal temperature&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Real T40(unit=&quot;K4&quot;) = 293.15^4 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Nominal temperature&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TOpa[nOpa](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=293.15, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=
        293.15) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Temperature of opaque surfaces&quot;</span>;
  Real T4Opa[nOpa](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;K4&quot;,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=T40,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=293.15^4) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Forth power of temperature of opaque surfaces&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow[nTot] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat flow rate at surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T0=293.15 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature used to linearize radiative heat transfer&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real T03(
    min=0,
    unit=&quot;K3&quot;) = T0^3 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;3rd power of temperature T0&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> sumEBal <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Sum of energy balance, should be zero&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The next loops build the array epsOpa, AOpa and kOpa that simplify</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the model equations.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// These arrays store the values of the constructios in the following order</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// [x[1:NConExt] x[1:NConPar] x[1: NConPar] x[1: NConBou] x[1: NSurBou] x[1: NConExtWin] x[1: NConExtWin]]</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// where x is epsOpa, AOpa or kOpa.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The last two entries are for the opaque wall that contains a window, and for the window frame.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsOpa[i] = epsConExt[i];
    AOpa[i] = AConExt[i];
    kOpa[i] = Modelica.Constants.sigma*epsConExt[i]*AOpa[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsOpa[i + nConExt] = epsConPar_a[i];
    AOpa[i + nConExt] = AConPar[i];
    kOpa[i + nConExt] = Modelica.Constants.sigma*epsConPar_a[i]*AOpa[i +
      nConExt];
    epsOpa[i + nConExt + nConPar] = epsConPar_b[i];
    AOpa[i + nConExt + nConPar] = AConPar[i];
    kOpa[i + nConExt + nConPar] = Modelica.Constants.sigma*epsConPar_b[i]*AOpa[
      i + nConExt + nConPar];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsOpa[i + nConExt + 2*nConPar] = epsConBou[i];
    AOpa[i + nConExt + 2*nConPar] = AConBou[i];
    kOpa[i + nConExt + 2*nConPar] = Modelica.Constants.sigma*epsConBou[i]*AOpa[
      i + nConExt + 2*nConPar];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsOpa[i + nConExt + 2*nConPar + nConBou] = epsSurBou[i];
    AOpa[i + nConExt + 2*nConPar + nConBou] = ASurBou[i];
    kOpa[i + nConExt + 2*nConPar + nConBou] = Modelica.Constants.sigma*
      epsSurBou[i]*AOpa[i + nConExt + 2*nConPar + nConBou];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Opaque part of construction that has a window embedded</span>
    epsOpa[i + nConExt + 2*nConPar + nConBou + nSurBou] = epsConExtWinOpa[i];
    AOpa[i + nConExt + 2*nConPar + nConBou + nSurBou] = AConExtWinOpa[i];
    kOpa[i + nConExt + 2*nConPar + nConBou + nSurBou] = Modelica.Constants.sigma
      *epsConExtWinOpa[i]*AOpa[i + nConExt + 2*nConPar + nConBou + nSurBou];
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Window frame</span>
    epsOpa[i + nConExt + 2*nConPar + nConBou + nSurBou + nConExtWin] =
      epsConExtWinFra[i];
    AOpa[i + nConExt + 2*nConPar + nConBou + nSurBou + nConExtWin] =
      AConExtWinFra[i];
    kOpa[i + nConExt + 2*nConPar + nConBou + nSurBou + nConExtWin] = Modelica.Constants.sigma
      *epsConExtWinFra[i]*AOpa[i + nConExt + 2*nConPar + nConBou + nSurBou +
      nConExtWin];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Vector with all surface areas.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The next loops build the array A that simplifies</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the model equations.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// These array stores the values of the constructios in the following order</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// [AOpa[1:nConExt] AOpa[1:nConPar] AOpa[1: nConPar] AOpa[1: nConBou] AOpa[1: nSurBou]</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//  AOpa[1: nConExtWin] AOpa[1: nConExtWin] AGla[1: nConExtWin]]</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// since nWin=nConExtWin.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nOpa<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    A[i] = AOpa[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    A[i + nOpa] = AConExtWinGla[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Reflectivity for opaque surfaces</span>
  rhoOpa = 1 .- epsOpa;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// View factors from surface i to surface j</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nTot<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nTot<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      F[i, j] = A[j]/<span style="color: red; font-weight: normal; font-style: normal;">sum</span>((A[k]) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>k<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nTot);
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Test whether the view factors add up to one, or the sum is zero in case there</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// is only one construction</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nTot<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>((<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(1 -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(F[i, j] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nTot))) &lt; 1E-10,
      &quot;Program error: Sum 1 of view factors is &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(F[i, j] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>
      1:nTot)));
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">////////////////////////////////////////////////////////////////////</span>
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Conditional connector</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(JInConExtWin, JInConExtWin_internal);
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>haveConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    JInConExtWin_internal =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, NConExtWin);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign temperature of opaque surfaces</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i] = conExt[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i + nConExt] = conPar_a[i].T;
    TOpa[i + nConExt + nConPar] = conPar_b[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i + nConExt + 2*nConPar] = conBou[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i + nConExt + 2*nConPar + nConBou] = conSurBou[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i + nConExt + 2*nConPar + nConBou + nSurBou] = conExtWin[i].T;
    TOpa[i + nConExt + 2*nConPar + nConBou + nConExtWin + nSurBou] =
      conExtWinFra[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Incoming radiosity at each surface</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// is equal to the negative of the outgoing radiosity of</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// all other surfaces times the view factor</span>
  G = -<span style="color: red; font-weight: normal; font-style: normal;">transpose</span>(F)*J;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Outgoing radiosity</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Opaque surfaces.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// If kOpa[j]=absIR[j]*A[j] &lt; 1E-28, then A &lt; 1E-20 and the surface is</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// from a dummy construction. In this situation, we set T40=293.15^4 to</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// avoid a singularity.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nOpa<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">//   T4Opa[j] = if (kOpa[j] &gt; 1E-28) then (Q_flow[j]-epsOpa[j] * G[j])/kOpa[j] else T40;</span>
    T4Opa[j] = (-J[j] - rhoOpa[j]*G[j])/kOpa[j];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// 4th power of temperature</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>linearizeRadiation<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    TOpa = (T4Opa .+ 3*T40)/(4*T30);
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Based on T4 = 4*T30*T-3*T40</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>homotopyInitialization<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      TOpa =<span style="color: red; font-weight: normal; font-style: normal;"> homotopy</span>(actual=<span style="color: red; font-weight: normal; font-style: normal;">Buildings.Utilities.Math.Functions.powerLinearized</span>(
        x=T4Opa,
        x0=243.15^4,
        n=0.25), simplified=(T4Opa .+ 3*T40)/(4*T30));
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      TOpa =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.powerLinearized</span>(
        x=T4Opa,
        x0=243.15^4,
        n=0.25);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign radiosity that comes from window</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// and that leaves window.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// J &lt; 0 because it leaves the surface</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// G &gt; 0 because it strikes the surface</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    J[j + nOpa] = -JInConExtWin_internal[j];
    G[j + nOpa] = +JOutConExtWin[j];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Net heat exchange</span>
  Q_flow = -J - G;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign heat exchange to connectors</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    Q_flow[i] = conExt[i].Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>nConExt == 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conExt[1].T = T0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    Q_flow[i + nConExt] = conPar_a[i].Q_flow;
    Q_flow[i + nConExt + nConPar] = conPar_b[i].Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>nConPar == 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conPar_a[1].T = T0;
    conPar_b[1].T = T0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    Q_flow[i + nConExt + 2*nConPar] = conBou[i].Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>nConBou == 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conBou[1].T = T0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    Q_flow[i + nConExt + 2*nConPar + nConBou] = conSurBou[i].Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>nSurBou == 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conSurBou[1].T = T0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    Q_flow[i + nConExt + 2*nConPar + nConBou + nSurBou] = conExtWin[i].Q_flow;
    Q_flow[i + nConExt + 2*nConPar + nConBou + nSurBou + nConExtWin] =
      conExtWinFra[i].Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>nConExtWin == 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conExtWin[1].T = T0;
    conExtWinFra[1].T = T0;
    JOutConExtWin[1] = 0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Sum of energy balance</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Remove sumEBal and assert statement for final release</span>
  sumEBal =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(conExt.Q_flow) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(conPar_a.Q_flow) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(conPar_b.Q_flow) +
    <span style="color: red; font-weight: normal; font-style: normal;">sum</span>(conBou.Q_flow) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(conSurBou.Q_flow) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(conExtWin.Q_flow) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(
    conExtWinFra.Q_flow) + (<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(JInConExtWin_internal) -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(JOutConExtWin));
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(sumEBal) &lt; 1E-1,
    &quot;Program error: Energy is not conserved in InfraredRadiationExchange.
               Sum of all energy is &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(sumEBal));
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>InfraredRadiationExchange;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE InfraredRadiationGainDistribution<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassef6fd50d43dced46utionI.png" alt="Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.InfraredRadiationGainDistribution</h2>
<p>
<b>Infrared radiative heat gain distribution between the room facing surfaces</b>
<br>
<br><img src="Buildings.Rooms.BaseClassef6fd50d43dced46utionD.png" alt="Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution">
</p>
<h3>Information</h3>

This model computes the distribution of the infrared radiant heat gain
to the room surfaces.
The infrared radiant heat gain <i>Q</i> is an input to this model.
It is distributed to the individual surfaces according to
<p align="center" style="font-style:italic;">
  Q<sup>i</sup> = Q &nbsp; A<sup>i</sup> &nbsp; &epsilon;<sup>i</sup> &frasl;
 &sum;<sub>k</sub> A<sup>k</sup> &nbsp; &epsilon;<sup>k</sup>.
</p>
For opaque surfaces, the heat flow rate
<i>Q<sup>i</sup></i>
is set to be equal to the heat flow rate at the heat port.
For the glass of the windows, the heat flow rate
<i>Q<sup>i</sup></i> is set to the radiosity
<i>J<sup>i</sup></i>
that will strike the glass or the window shade.

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a> (Partial model that is used for infrared radiation balance).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Set to true if a shade is present</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>uSha[NConExtWin]</td><td>Control signal for the shading device (removed if no shade is present)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>Q_flow</td><td>Radiative heat input into room (positive if heat gain)</td></tr>
<tr><td>output <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>RadiosityOutflow</a></td><td>JOutConExtWin[NConExtWin]</td><td>Outgoing radiosity that connects to shaded and unshaded part of glass [W]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> InfraredRadiationGainDistribution <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Infrared radiative heat gain distribution between the room facing surfaces&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Set to true if a shade is present&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> uSha[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Control signal for the shading device (removed if no shade is present)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Q_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiative heat input into room (positive if heat gain)&quot;</span>;
  <a href="Buildings_HeatTransfer_Interfaces.html#Buildings.HeatTransfer.Interfaces.RadiosityOutflow"
>Buildings.HeatTransfer.Interfaces.RadiosityOutflow</a>[NConExtWin] JOutConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outgoing radiosity that connects to shaded and unshaded part of glass&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  Real fraConExt[NConExt] = AEpsConExt/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by exterior constructions&quot;</span>;
  Real fraConExtWinOpa[NConExtWin] = AEpsConExtWinOpa/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by opaque part of exterior constructions that have a window&quot;</span>;
  Real fraConExtWinGla[NConExtWin] = (AEpsConExtWinSha + AEpsConExtWinUns)/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by opaque part of glass constructions that have a window&quot;</span>;
  Real fraConExtWinFra[NConExtWin] = AEpsConExtWinFra/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by window frame of exterior constructions that have a window&quot;</span>;

  Real fraConPar_a[NConPar] = AEpsConPar_a/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by partition constructions surface a&quot;</span>;
  Real fraConPar_b[NConPar] = AEpsConPar_b/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by partition constructions surface b&quot;</span>;
  Real fraConBou[NConBou] = AEpsConBou/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
  Real fraSurBou[NSurBou] = AEpsSurBou/sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of infrared radiant heat gain absorbed by surface models of constructions that are modeled outside of this room&quot;</span>;

 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real AEpsConExt[NConExt] = {AConExt[i]*epsConExt[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExt} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of exterior constructions&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real AEpsConExtWinOpa[NConExtWin] = {AConExtWinOpa[i]*epsConExtWinOpa[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of opaque part of exterior constructions that contain a window&quot;</span>;
 Real AEpsConExtWinUns[NConExtWin] = {shaSig[i].yCom * AConExtWinGla[i]*epsConExtWinUns[i]
     <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of unshaded window constructions&quot;</span>;
 Real AEpsConExtWinSha[NConExtWin] = {shaSig[i].y    * AConExtWinGla[i]*epsConExtWinSha[i]
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of shaded window constructions&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real AEpsConExtWinFra[NConExtWin] = {AConExtWinFra[i]*epsConExtWinFra[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of window frame&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real AEpsConPar_a[NConPar] = {AConPar[i]*epsConPar_a[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of partition constructions surface a&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real AEpsConPar_b[NConPar] = {AConPar[i]*epsConPar_b[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of partition constructions surface b&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real AEpsConBou[NConBou] = {AConBou[i]*epsConBou[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConBou} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real AEpsSurBou[NSurBou] = {ASurBou[i]*epsSurBou[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NSurBou} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity times area of surface models of constructions that are modeled outside of this room&quot;</span>;

 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real sumAEpsNoWin(fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sum of absorptivity times area of all constructions except for windows&quot;</span>;
 Real sumAEps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sum of absorptivity times area of all constructions including windows&quot;</span>;

 <a href="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal"
>Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal</a> shaSig[NConExtWin](
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveShade=haveShade) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Block to constrain the shading control signal to be strictly within (0, 1) if a shade is present&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  sumAEpsNoWin =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(AEpsConExt)+<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(AEpsConExtWinOpa)+<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(AEpsConExtWinFra)
                +<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(AEpsConPar_a)+<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(AEpsConPar_b)+<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(AEpsConBou)+<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(AEpsSurBou);
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(uSha, shaSig.u);

  sumAEps      = sumAEpsNoWin +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(AEpsConExtWinUns) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(AEpsConExtWinSha);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Infrared radiative heat flow</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// If a construction is not present, we assign the temperature of the connector to 20 degC.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExt<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conExt.Q_flow    = -fraConExt*Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conExt[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conExtWin.Q_flow = -fraConExtWinOpa*Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conExtWin[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConPar<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conPar_a.Q_flow  = -fraConPar_a*Q_flow;
    conPar_b.Q_flow  = -fraConPar_b*Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conPar_a[1].T = 293.15;
    conPar_b[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conBou.Q_flow    = -fraConBou*Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conBou[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    conSurBou.Q_flow    = -fraSurBou*Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conSurBou[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// This model makes the simplification that the shade, the glass and the frame have</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the same absorptivity in the infrared region</span>
  JOutConExtWin        = +fraConExtWinGla*Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
     conExtWinFra.Q_flow  = -fraConExtWinFra*Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
     conExtWinFra[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Check for conservation of energy</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(1 -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraConExt) -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraConExtWinOpa)-<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraConExtWinGla) -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraConExtWinFra)
           -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraConPar_a) -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraConPar_b)
           -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraConBou) -<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(fraSurBou))  &lt; 1E-5,
           &quot;Programming error: Radiation balance is wrong. Check equations.&quot;);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>InfraredRadiationGainDistribution;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE MixedAirHeatGain<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass5b7bd65ce2105337tGainI.png" alt="Buildings.Rooms.BaseClasses.MixedAirHeatGain" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.MixedAirHeatGain"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.MixedAirHeatGain</h2>
<p>
<b>Model to convert internal heat gain signals</b>
<br>
<br><img src="Buildings.Rooms.BaseClass5b7bd65ce2105337tGainD.png" alt="Buildings.Rooms.BaseClasses.MixedAirHeatGain">
</p>
<h3>Information</h3>

This model computes the radiant, convective and latent heat flow.
Input into this model are these three components in units of [W/m2].
The inputs need to be positive quantities if heat or moisture is added
to the room.
The outputs are
<ul>
<li>
the radiant heat flow in Watts,
</li>
<li>
the convective heat flow in Watts, and
</li>
<li>
the water vapor released into the air.
</li>
</ul>
If the medium model does not contain water vapor, then
the water vapor released into the air is zero, i.e.,
the mass flow rate at the fluid port is equal to zero.

<p>Extends from <a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a> (Base icon).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>AFlo</td><td>&nbsp;</td><td>Floor area [m2]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>TWat</td><td>273.15 + 34</td><td>Temperature at which water vapor is released [K]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>QCon_flow</td><td>Convective heat gain</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>qGai_flow[3]</td><td>Radiant, convective and latent heat input into room (positive if heat gain)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>QRad_flow</td><td>Radiative heat gain</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>QLat_flow</td><td>Latent heat gain</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> MixedAirHeatGain <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Model to convert internal heat gain signals&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
     <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium in the component&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AFlo <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Floor area&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TWat=273.15+34 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature at which water vapor is released&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> QCon_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective heat gain&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">public </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> qGai_flow[3] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiant, convective and latent heat input into room (positive if heat gain)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> QRad_flow <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Radiative heat gain&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>Modelica.Fluid.Interfaces.FluidPort_b</a> QLat_flow(<span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span>
      Medium =
        <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.MixedAirHeatGain.Medium"
>Medium</a>) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Latent heat gain&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mWat_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Water vapor flow rate released by latent gain&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnergy"
>Modelica.SIunits.SpecificEnergy</a> h_fg =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.enthalpyOfCondensingGas</span>(TWat) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Latent heat of water vapor&quot;</span>;
 <span style="color: #006400; font-weight: normal; font-style: normal;">// constant Medium.MassFraction Xi[Medium.nXi] = {1}</span>
 <span style="color: #006400; font-weight: normal; font-style: normal;">//   &quot;Species concentration (water vapor only)&quot;;</span>

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real s[Medium.nX](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Vector with zero everywhere except where water vapor is&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nX<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Utilities.Strings.isEqual</span>(string1=Medium.substanceNames[i],
                                            string2=&quot;water&quot;,
                                            caseSensitive=false))<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      s[i] :=1;
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      s[i] :=0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
   <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: red; font-weight: normal; font-style: normal;"> assert</span>(Medium.nX == 1<span style="color: blue; font-weight: normal; font-style: normal;"> or </span><span style="color: red; font-weight: normal; font-style: normal;">abs</span>(1-<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(s)) &lt; 1E-4, &quot;Substance &#39;water&#39; is not present in medium &#39;&quot;
                  + Medium.mediumName + &quot;&#39;.\n&quot;
                  + &quot;Change medium model to one that has &#39;water&#39; as a substance.&quot;);
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  QRad_flow = qGai_flow[1]*AFlo;
  QCon_flow.Q_flow = -qGai_flow[2]*AFlo;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Interface to fluid port</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// If a medium does not contain water vapor, then h_fg is equal to zero.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>Medium.nXi == 0<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>(h_fg == 0)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    mWat_flow = 0;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    mWat_flow = qGai_flow[3]*AFlo/h_fg;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  QLat_flow.C_outflow  =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, Medium.nC);
  QLat_flow.h_outflow  = h_fg;
  QLat_flow.Xi_outflow = s[1:Medium.nXi];
  QLat_flow.m_flow     = <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(h_fg &gt; 0)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>
                           -qGai_flow[3]*AFlo/h_fg<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
                            0;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>MixedAirHeatGain;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE MixedAirHeatMassBalance<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass361a47c3d45bb74dlanceI.png" alt="Buildings.Rooms.BaseClasses.MixedAirHeatMassBalance" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.MixedAirHeatMassBalance"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.MixedAirHeatMassBalance</h2>
<p>
<b>Heat and mass balance of the air, assuming completely mixed air</b>
<br>
<br><img src="Buildings.Rooms.BaseClass361a47c3d45bb74dlanceD.png" alt="Buildings.Rooms.BaseClasses.MixedAirHeatMassBalance">
</p>
<h3>Information</h3>

<p>
This model computes the heat and mass balance of the air.
The model assumes a completely mixed air volume.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"
>Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance</a> (Partial model for heat and mass balance of the air), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a> (Declarations for lumped volumes).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Set to true if at least one window has an interior or exterior shade</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</a></td><td>V</td><td>&nbsp;</td><td>Volume [m3]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Convective heat transfer</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.InteriorConvection"
>InteriorConvection</a></td><td>conMod</td><td>&nbsp;</td><td>Convective heat transfer model for opaque constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</a></td><td>hFixed</td><td>&nbsp;</td><td>Constant convection coefficient for opaque constructions [W/(m2.K)]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Real</td><td>mSenFac</td><td>1</td><td>Factor for scaling the sensible thermal mass of the volume</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>&nbsp;</td><td>= true, use homotopy method</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>uSha[NConExtWin]</td><td>Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>QRadAbs_flow[NConExtWin]</td><td>Total net radiation that is absorbed by the shade (positive if absorbed) [W]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>TSha[NConExtWin]</td><td>Shade temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>heaPorAir</td><td>Heat port to air volume</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaUns[NConExtWin]</td><td>Heat port that connects to room-side surface of unshaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaSha[NConExtWin]</td><td>Heat port that connects to room-side surface of shaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>QLat_flow</td><td>Connector for latent heat gain</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> MixedAirHeatMassBalance <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Heat and mass balance of the air, assuming completely mixed air&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"
>Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance</a>(nPorts=1);
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Port definitions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.InteriorConvection"
>Buildings.HeatTransfer.Types.InteriorConvection</a> conMod <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective heat transfer model for opaque constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</a> hFixed <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Constant convection coefficient for opaque constructions&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Mixing volume</span>
  <a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Fluid.MixingVolumes.MixingVolume</a> vol(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance.Medium"
>Medium</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>energyDynamics=energyDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>massDynamics=massDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>V=V,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>p_start=p_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_start=T_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>X_start=X_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_start=C_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_nominal=C_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal = m_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>prescribedHeatFlowRate = true,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nPorts=nPorts+1,
    m_flow_small=1E-4*<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(m_flow_nominal),
    allowFlowReversal=true) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Room air volume&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Convection models</span>
  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConExt[NConExt](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConExt.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConExtWin[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConExtWinOpa,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConExtWin.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.InteriorHeatTransferConvective"
>HeatTransfer.Windows.InteriorHeatTransferConvective</a> convConWin[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>fFra=datConExtWin.fFra,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveExteriorShade={datConExtWin[i].glaSys.haveExteriorShade <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveInteriorShade={datConExtWin[i].glaSys.haveInteriorShade <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til=datConExtWin.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConExtWinGla + AConExtWinFra) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Model for convective heat transfer at window&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConPar_a[nConPar](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til=Modelica.Constants.pi .- datConPar.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConPar_b[nConPar](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConPar.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convConBou[nConBou](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=AConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = datConBou.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <a href="Buildings_HeatTransfer_Convection.html#Buildings.HeatTransfer.Convection.Interior"
>HeatTransfer.Convection.Interior</a> convSurBou[nSurBou](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=ASurBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til = surBou.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>conMod=conMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hFixed=hFixed,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat transfer&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Fluid port for latent heat gain</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> QLat_flow(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance.Medium"
>Medium</a>) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Connector for latent heat gain&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Thermal collectors</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConExt(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConExt) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConExtWin(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConExtWin) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConWin(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConExtWin) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConPar_a(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConPar) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConPar_b(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConPar) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConConBou(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nConBou) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Components.html#Modelica.Thermal.HeatTransfer.Components.ThermalCollector"
>Modelica.Thermal.HeatTransfer.Components.ThermalCollector</a> theConSurBou(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>m=nSurBou) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Thermal collector to convert from vector to scalar connector&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_a.fluid,theConConPar_a.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_b.fluid,theConConPar_b.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConBou.fluid,theConConBou.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convSurBou.fluid,theConSurBou.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConPar_a.port_b,vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConPar_b.port_b,vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConBou.port_b,vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConSurBou.port_b,vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWinFra,convConWin.frame);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExt.solid, conExt);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExt.fluid,theConConExt.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConExt.port_b,vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConExtWin.port_b,vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExtWin.fluid,theConConExtWin.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConExtWin.solid, conExtWin);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(theConConWin.port_b,vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.air,theConConWin.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.glaSha, glaSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.glaUns, glaUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_a.solid, conPar_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConPar_b.solid, conPar_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConBou.solid, conBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convSurBou.solid, conSurBou);
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol.ports[i], ports[i]);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(QLat_flow, vol.ports[nPorts+1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(heaPorAir, vol.heatPort);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(uSha, convConWin.uSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.QRadAbs_flow, QRadAbs_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(convConWin.TSha, TSha);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>MixedAirHeatMassBalance;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialAirHeatMassBalance<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassef5869d92b857a6flanceI.png" alt="Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.PartialAirHeatMassBalance</h2>
<p>
<b>Partial model for heat and mass balance of the air</b>
<br>
<br><img src="Buildings.Rooms.BaseClassef5869d92b857a6flanceD.png" alt="Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance">
</p>
<h3>Information</h3>

<p>
This is a partial model that is used to implement the heat and mass balance of the air.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a> (Data records for construction data).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium in the component</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Set to true if at least one window has an interior or exterior shade</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</a></td><td>V</td><td>&nbsp;</td><td>Volume [m3]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Medium in the component</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>uSha[NConExtWin]</td><td>Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>QRadAbs_flow[NConExtWin]</td><td>Total net radiation that is absorbed by the shade (positive if absorbed) [W]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>TSha[NConExtWin]</td><td>Shade temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>heaPorAir</td><td>Heat port to air volume</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaUns[NConExtWin]</td><td>Heat port that connects to room-side surface of unshaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaSha[NConExtWin]</td><td>Heat port that connects to room-side surface of shaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialAirHeatMassBalance <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model for heat and mass balance of the air&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
    <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium in the component&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Port definitions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nPorts=0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of ports&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if at least one window has an interior or exterior shade&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Modelica.SIunits.Volume</a> V <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Input/output signals</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> uSha[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Input connector, used to scale the surface area to take into account an operable shading device, 0: unshaded; 1: fully shaded&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> QRadAbs_flow[NConExtWin](
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;W&quot;) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total net radiation that is absorbed by the shade (positive if absorbed)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> TSha[NConExtWin](
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;K&quot;,
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;ThermodynamicTemperature&quot;) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
      haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Shade temperature&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Fluid port</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b</a> ports[nPorts](
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance.Medium"
>Medium</a>) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fluid inlets and outlets&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Heat ports</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> heaPorAir <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port to air volume&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExt[NConExt] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of exterior constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExtWin[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of exterior constructions that contain a window&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaUns[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of unshaded glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaSha[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port that connects to room-side surface of shaded glass&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExtWinFra[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of window frame&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conPar_a[NConPar] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface a of partition constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conPar_b[NConPar] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface b of partition constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conBou[NConBou] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of constructions that expose their other surface to the outside&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conSurBou[NSurBou] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port to surfaces of models that compute the heat conduction outside of this room&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Surface areas</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExt[NConExt] = datConExt.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinOpa[NConExtWin] = datConExtWin.AOpa <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Opaque areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinGla[NConExtWin] = (1 .- datConExtWin.fFra) .* datConExtWin.AWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Glass areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinFra[NConExtWin] = datConExtWin.fFra .* datConExtWin.AWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Frame areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConPar[NConPar] = datConPar.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of partition constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConBou[NConBou] = datConBou.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> ASurBou[NSurBou] = surBou.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Area of surface models of constructions that are modeled outside of this room&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialAirHeatMassBalance;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialSurfaceInterface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassfed177a79783e66erfaceI.png" alt="Buildings.Rooms.BaseClasses.PartialSurfaceInterface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.PartialSurfaceInterface"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.PartialSurfaceInterface</h2>
<p>
<b>Partial model that is used for infrared radiation balance</b>
<br>
<br><img src="Buildings.Rooms.BaseClassfed177a79783e66erfaceD.png" alt="Buildings.Rooms.BaseClasses.PartialSurfaceInterface">
</p>
<h3>Information</h3>

<p>
This partial model is used as a base class for models that need to exchange
heat with room-facing surfaces. It defines parameters for the surface areas.
The model is used as a base class to implement the convective model, and the various
radiation models.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a> (Data records for construction data).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialSurfaceInterface <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model that is used for infrared radiation balance&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExt[NConExt] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of exterior constructions&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExtWin[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of exterior constructions that contain a window&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conExtWinFra[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of window frame&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conPar_a[NConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface a of partition constructions&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conPar_b[NConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface b of partition constructions&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conBou[NConBou] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of constructions that expose their other surface to the outside&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> conSurBou[NSurBou] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port to surfaces of models that compute the heat conduction outside of this room&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExt[NConExt] = datConExt.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinOpa[NConExtWin] = datConExtWin.AOpa <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Opaque areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinGla[NConExtWin] = (1 .- datConExtWin.fFra) .* datConExtWin.AWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Glass areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConExtWinFra[NConExtWin] = datConExtWin.fFra .* datConExtWin.AWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Frame areas of exterior construction that have a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConPar[NConPar] = datConPar.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of partition constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AConBou[NConBou] = datConBou.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Areas of constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> ASurBou[NSurBou] = surBou.A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Area of surface models of constructions that are modeled outside of this room&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">function</span> checkSurfaceAreas
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer n <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of surfaces&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A[:] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface areas&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String name <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Name of the surface data record, used in error message&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>n == 0<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.Vectors.norm</span>(v=A, p=1) &lt; 1E-10,
      &quot;Error in declaration of room model: Construction record &#39;&quot; +
      name +
      &quot;&#39; has the following areas: &quot; +
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.Vectors.toString</span>(A) +
      &quot;However, the room model is declared as having zero surfaces.
Check the parameters of the room model.&quot;);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:n<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
        <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(A[i] &gt; 0, &quot;Error in declaration of room model: Construction record &#39;&quot; + name + &quot;&#39; has the following areas: &quot; +
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.Vectors.toString</span>(A) +
      &quot;However, the surface areas must be bigger than zero.
Check the parameters of the room model.&quot;);
      <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end </span>checkSurfaceAreas;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: red; font-weight: normal; font-style: normal;">checkSurfaceAreas</span>(nConExt,    datConExt.A,       &quot;datConExt&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">checkSurfaceAreas</span>(nConExtWin, datConExtWin.AWin, &quot;datConExtWin&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">checkSurfaceAreas</span>(nConPar,    datConPar.A,       &quot;datConPar&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">checkSurfaceAreas</span>(nConBou,    datConBou.A,       &quot;datConBou&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">checkSurfaceAreas</span>(nSurBou,    surBou.A,          &quot;surBou&quot;);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialSurfaceInterface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialSurfaceInterfaceRadiative<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassfed177a79783e66erfaceI.png" alt="Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.PartialSurfaceInterfaceRadiative</h2>
<p>
<b>Partial model that is used for infrared radiation balance</b>
<br>
<br><img src="Buildings.Rooms.BaseClassfed177a79783e66erfaceD.png" alt="Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative">
</p>
<h3>Information</h3>

<p>
This partial model is used as a base class for models that need to exchange
heat with room-facing surfaces by radiation. It declares parameters that are
needed for the radiative balance.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterface"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterface</a> (Partial model that is used for infrared radiation balance).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialSurfaceInterfaceRadiative <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model that is used for infrared radiation balance&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterface"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterface</a>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConExt[NConExt] = datConExt.layers.absIR_b <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConExtWinOpa[NConExtWin] = datConExtWin.layers.absIR_b <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of opaque part of exterior constructions that contain a window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConExtWinUns[NConExtWin]=
    {(datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].absIR_b) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of unshaded part of window constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConExtWinSha[NConExtWin] = datConExtWin.glaSys.shade.absIR_a <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of shaded part of window constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConExtWinFra[NConExtWin] = datConExtWin.glaSys.absIRFra <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of window frame&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConPar_a[NConPar] = datConPar.layers.absIR_a <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of partition constructions surface a&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConPar_b[NConPar] = datConPar.layers.absIR_b <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of partition constructions surface b&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsConBou[NConBou] = datConBou.layers.absIR_b <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> epsSurBou[NSurBou] = surBou.absIR <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of surface models of constructions that are modeled outside of this room&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialSurfaceInterfaceRadiative;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE RadiationAdapter<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass396027b42b0f60aaapterI.png" alt="Buildings.Rooms.BaseClasses.RadiationAdapter" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.RadiationAdapter"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.RadiationAdapter</h2>
<p>
<b>Model to connect between signals and heat port for radiative gains of the room</b>
<br>
<br><img src="Buildings.Rooms.BaseClass396027b42b0f60aaapterD.png" alt="Buildings.Rooms.BaseClasses.RadiationAdapter">
</p>
<h3>Information</h3>

This model can be used as a thermal adapter in situations where the temperature
and the heat flow rate are computed in separate models.
For example, this thermal adapter is used in the room model, which computes
the distribution of radiative heat gains (such as due to a radiator) in
<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution"
>
Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution</a>
and computes the radiative temperature in
<a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.RadiationTemperature"
>
Buildings.Rooms.BaseClasses.RadiationTemperature</a>.
This adapter combines the heat flow rate and the temperatures that are computed in these
separate models, and exposes these two quantities at its heat port.


<p>Extends from <a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a> (Base icon).</p>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>rad</td><td>Port for radiative heat gain and radiation temperature</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>TRad</td><td>Radiation temperature of room</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>QRad_flow</td><td>Radiative heat gain</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> RadiationAdapter <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Model to connect between signals and heat port for radiative gains of the room&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> rad <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Port for radiative heat gain and radiation temperature&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">public </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> TRad <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Radiation temperature of room&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> QRad_flow <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Radiative heat gain&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  QRad_flow = rad.Q_flow;
  rad.T = TRad;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>RadiationAdapter;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE RadiationTemperature<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass0cb9284165e146d7atureI.png" alt="Buildings.Rooms.BaseClasses.RadiationTemperature" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.RadiationTemperature"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.RadiationTemperature</h2>
<p>
<b>Radiative temperature of the room</b>
<br>
<br><img src="Buildings.Rooms.BaseClass0cb9284165e146d7atureD.png" alt="Buildings.Rooms.BaseClasses.RadiationTemperature">
</p>
<h3>Information</h3>

<p>
This model computes the radiative temperature in the room.
For a room with windows but no shade, the radiative temperature is
computed as
</p>
<p align="center" style="font-style:italic;">
  T<sub>rad</sub> = &sum;<sub>i</sub> &nbsp; (A<sup>i</sup> &nbsp; &epsilon;<sup>i</sup> &nbsp; T<sup>i</sup>)
  &frasl;
  &sum;<sub>i</sub> &nbsp; (A<sup>i</sup> &nbsp; &epsilon;<sup>i</sup>)
</p>
<p>
where
<i>T<sub>rad</sub></i> is the radiative temperature of the room,
<i>A<sup>i</sup></i> are the surface areas of the room,
<i>&epsilon;<sup>i</sup></i> are the infrared emissivities of the surfaces, and
<i>T<sup>i</sup></i> are the surface temperatures.
</p>
<p>
If a the windows have a shade, then the equation is modified to take the actual shaded and non-shaded
surface area into account. In this situation, the shaded part of a window has a infrared radiative power
of</p>
<p align="center" style="font-style:italic;">
 E = A &nbsp; ( u &nbsp; &epsilon;<sub>s</sub> &nbsp; T<sub>s</sub> +
   (1-u) &nbsp; &epsilon;<sub>g</sub> &tau;<sub>s</sub> &nbsp; T<sub>gs</sub>)
</p>
<p>
where
<i>A</i> is the surface area of the glass,
<i>u</i> is the control signal of the shade,
<i>&epsilon;<sub>s</sub></i> is the infrared absorptivity of the shade,
<i>T<sub>s</sub></i> is the temperature of the shade,
<i>&epsilon;<sub>g</sub></i> is the infrared absorptivity of the glass,
<i>&tau;<sub>s</sub></i> is the infrared transmittance of the shade, and
<i>T<sub>gs</sub></i> is the glass temperature behind the shade.
</p>
<p>
For the unshaded part of the window, the radiative power is
</p>
<p align="center" style="font-style:italic;">
 E = A &nbsp; (1-u) &nbsp; &epsilon;<sub>g</sub> &nbsp; T<sub>gn</sub>
</p>
<p>where
<i>T<sub>gn</sub></i> is the glass temperature of the non-shaded part of the window.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a> (Partial model that is used for infrared radiation balance).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Set to true if the windows have a shade</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaUns[NConExtWin]</td><td>Heat port that connects to room-side surface of unshaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>glaSha[NConExtWin]</td><td>Heat port that connects to room-side surface of shaded glass</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>sha[NConExtWin]</td><td>Heat port that connects to shade</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>uSha[NConExtWin]</td><td>Control signal for the shading device (removed if no shade is present)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>TRad</td><td>Radiative temperature [K]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> RadiationTemperature <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Radiative temperature of the room&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaUns[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of unshaded glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaSha[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port that connects to room-side surface of shaded glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> sha[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port that connects to shade&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Set to true if the windows have a shade&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> uSha[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Control signal for the shading device (removed if no shade is present)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> TRad(min=0, unit=&quot;K&quot;, displayUnit=&quot;degC&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiative temperature&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NOpa = NConExt+2*NConExtWin+2*NConPar+NConBou+NSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of opaque surfaces, including the window frame&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NWin = NConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of window surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NTot = NOpa + NWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Total number of surfaces&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AGla[NWin] = datConExtWin.AGla <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface area of opaque surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real epsGla[NWin](min=0, max=1)=
    {datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].absIR_b <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of glass&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real epsSha[NWin](min=0, max=1)=
    {datConExtWin[i].glaSys.shade.absIR_a <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absorptivity of shade&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real tauSha[NWin](min=0, max=1)=
    {(<span style="color: blue; font-weight: normal; font-style: normal;">if </span>datConExtWin[i].glaSys.haveInteriorShade<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>
      datConExtWin[i].glaSys.shade.tauIR_a<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>1) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Transmissivity of shade&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> epsAOpa[NOpa](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Product of area times absorptivity of opaque surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> epsAGla[NWin](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Product of area times absorptivity of window surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> epsASha[NWin](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Product of area times absorptivity of window shade&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> epsTauASha[NWin](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Product of area times glass absorptivity times shade transmittance&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TOpa[NOpa](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=293.15, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=293.15) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature of opaque surfaces&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TGlaUns[NWin](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=293.15, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=293.15) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature of unshaded part of glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TGlaSha[NWin](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=293.15, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=293.15) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature of shaded part of glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TSha[NWin](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>start=293.15, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nominal=293.15) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature of shade&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Internal connectors, used because of the conditionally removed connectors</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaUns_internal[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of unshaded glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> glaSha_internal[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to room-side surface of shaded glass&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> sha_internal[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port that connects to shade&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> uSha_internal[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Control signal for the shading device&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The next loops build the array epsAOpa that simplifies</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the model equations.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The arrays stores the values of the constructios in the following order</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// [x[1:NConExt] x[1:NConPar] x[1: NConPar] x[1: NConBou] x[1: NSurBou] x[1: NConExtWin] x[1: NConExtWin]]</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// where x is epsOpa, AOpa or kOpa.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The last two entries are for the opaque wall that contains a window, and for the window frame.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsAOpa[i] = epsConExt[i] * AConExt[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsAOpa[i+NConExt]         = epsConPar_a[i] * AConPar[i];
    epsAOpa[i+NConExt+NConPar] = epsConPar_b[i] * AConPar[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsAOpa[i+NConExt+2*NConPar] = epsConBou[i] * AConBou[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    epsAOpa[i+NConExt+2*NConPar+NConBou] = epsSurBou[i] * ASurBou[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Opaque part of construction that has a window embedded</span>
    epsAOpa[i+NConExt+2*NConPar+NConBou+NSurBou] = epsConExtWinOpa[i] * AConExtWinOpa[i];
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Window frame</span>
    epsAOpa[i+NConExt+2*NConPar+NConBou+NSurBou+NConExtWin] = epsConExtWinFra[i] * AConExtWinFra[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Window glass</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Window glass</span>
    epsAGla[i] = AGla[i] * epsGla[i];
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Window shade</span>
    epsASha[i]    = AGla[i] * epsSha[i];
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Emitted from glas and transmitted through window shade</span>
    epsTauASha[i] = AGla[i] * epsGla[i] * tauSha[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
<span style="color: #006400; font-weight: normal; font-style: normal;">////////////////////////////////////////////////////////////////////</span>
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Conditional connnector</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(glaUns, glaUns_internal);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(glaSha, glaSha_internal);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sha, sha_internal);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(uSha, uSha_internal);
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>haveConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    glaUns_internal.T =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(293.15, NConExtWin);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    glaSha_internal.T =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(293.15, NConExtWin);
    sha_internal.T =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(293.15, NConExtWin);
    uSha_internal =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(0, NConExtWin);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign temperature of opaque surfaces</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i] = conExt[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i+NConExt]         = conPar_a[i].T;
    TOpa[i+NConExt+NConPar] = conPar_b[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i+NConExt+2*NConPar] = conBou[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i+NConExt+2*NConPar+NConBou] = conSurBou[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TOpa[i+NConExt+2*NConPar+NConBou+NSurBou]            = conExtWin[i].T;
    TOpa[i+NConExt+2*NConPar+NConBou+NConExtWin+NSurBou] = conExtWinFra[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign temperature of glass and shade</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TGlaUns[i] = glaUns_internal[i].T;
    TGlaSha[i] = glaSha_internal[i].T;
    TSha[i]    = sha_internal[i].T;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Compute radiative temperature</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    TRad = (<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(epsAOpa[i] * TOpa[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NOpa)
        +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(
      ( uSha_internal[i] * (epsASha[i] * TSha[i] + epsTauASha[i] * TGlaSha[i]) +
      (1-uSha_internal[i]) * epsAGla[i] * TGlaUns[i])
        <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin))  /
        (<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(epsAOpa) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(
      ( uSha_internal[i] * (epsASha[i] + epsTauASha[i]) + (1-uSha_internal[i]) * epsAGla[i])
        <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin));
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    TRad = (<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(epsAOpa[i] * TOpa[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NOpa) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(epsAGla .* TGlaUns)) / (<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(epsAOpa) +<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(epsAGla));
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign heat exchange to connectors</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExt<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      0 = conExt[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      conExt[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConPar<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      0 = conPar_a[i].Q_flow;
      0 = conPar_b[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      conPar_a[1].T = 293.15;
      conPar_b[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      0 = conBou[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
     conBou[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      0 = conSurBou[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      conSurBou[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      0 = conExtWin[i].Q_flow;
      0 = conExtWinFra[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      conExtWin[1].T    = 293.15;
      conExtWinFra[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>RadiationTemperature;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE RoomHeatMassBalance<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass6f44246b960e047clanceI.png" alt="Buildings.Rooms.BaseClasses.RoomHeatMassBalance" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.RoomHeatMassBalance"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.RoomHeatMassBalance</h2>
<p>
<b>Base model for a room</b>
<br>
<br><img src="Buildings.Rooms.BaseClass6f44246b960e047clanceD.png" alt="Buildings.Rooms.BaseClasses.RoomHeatMassBalance">
</p>
<h3>Information</h3>

<p>
Partial model for a room heat and mass balance.
</p>
<p>
This is the base class for
<a href="modelica://Buildings.Rooms.FFD">Buildings.Rooms.FFD</a>
and for
<a href="Buildings_Rooms.html#Buildings.Rooms.MixedAir"
>Buildings.Rooms.MixedAir</a>
</p>
<p>
See
<a href="Buildings_Rooms_UsersGuide.html#Buildings.Rooms.UsersGuide"
>Buildings.Rooms.UsersGuide</a>
for detailed explanations.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a> (Data records for construction data).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>lat</td><td>&nbsp;</td><td>Latitude [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>AFlo</td><td>&nbsp;</td><td>Floor area [m2]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>hRoo</td><td>&nbsp;</td><td>Average room height [m]</td></tr>
<tr><td>Boolean</td><td>linearizeRadiation</td><td>true</td><td>Set to true to linearize emissive power</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"
>PartialAirHeatMassBalance</a></td><td>air</td><td>redeclare BaseClasses.Partia...</td><td>Convective heat and mass balance of air</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Convective heat transfer</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.InteriorConvection"
>InteriorConvection</a></td><td>intConMod</td><td>Buildings.HeatTransfer.Types...</td><td>Convective heat transfer model for room-facing surfaces of opaque constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</a></td><td>hIntFixed</td><td>3.0</td><td>Constant convection coefficient for room-facing surfaces of opaque constructions [W/(m2.K)]</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.ExteriorConvection"
>ExteriorConvection</a></td><td>extConMod</td><td>Buildings.HeatTransfer.Types...</td><td>Convective heat transfer model for exterior facing surfaces of opaque constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</a></td><td>hExtFixed</td><td>10.0</td><td>Constant convection coefficient for exterior facing surfaces of opaque constructions [W/(m2.K)]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>V*1.2/3600</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>heaPorAir</td><td>Heat port to air volume</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>heaPorRad</td><td>Heat port for radiative heat gain and radiative temperature</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>surf_conBou[nConBou]</td><td>Heat port at surface b of construction conBou</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>surf_surBou[nSurBou]</td><td>Heat port of surface that is connected to the room air</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>qGai_flow[3]</td><td>Radiant, convective and latent heat input into room (positive if heat gain) [W/m2]</td></tr>
<tr><td><a href="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>Bus</a></td><td>weaBus</td><td>&nbsp;</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> RoomHeatMassBalance <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Base model for a room&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionRecords"
>Buildings.Rooms.BaseClasses.ConstructionRecords</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
    <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium in the component&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nPorts=0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of ports&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b</a> ports[nPorts](
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.RoomHeatMassBalance.Medium"
>Medium</a>) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fluid inlets and outlets&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> lat <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Latitude&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Modelica.SIunits.Volume</a> V=AFlo*hRoo <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AFlo <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Floor area&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> hRoo <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Average room height&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> heaPorAir <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port to air volume&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> heaPorRad <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat port for radiative heat gain and radiative temperature&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Constructions</span>
  <a href="Buildings_Rooms_Constructions.html#Buildings.Rooms.Constructions.Construction"
>Constructions.Construction</a> conExt[NConExt](
    A=datConExt.A,
    til=datConExt.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>layers={datConExt[i].layers <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExt},
    steadyStateInitial=datConExt.steadyStateInitial,
    T_a_start=datConExt.T_a_start,
    T_b_start=datConExt.T_b_start) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat conduction through exterior construction that have no window&quot;</span>;
  <a href="Buildings_Rooms_Constructions.html#Buildings.Rooms.Constructions.ConstructionWithWindow"
>Constructions.ConstructionWithWindow</a> conExtWin[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=datConExtWin.A,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>til=datConExtWin.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>layers={datConExtWin[i].layers <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>steadyStateInitial=datConExtWin.steadyStateInitial,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_a_start=datConExtWin.T_a_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_b_start=datConExtWin.T_b_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>AWin=datConExtWin.AWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>fFra=datConExtWin.fFra,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>glaSys=datConExtWin.glaSys,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearizeRadiation=linearizeRadiation) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat conduction through exterior construction that have a window&quot;</span>;
  <a href="Buildings_Rooms_Constructions.html#Buildings.Rooms.Constructions.Construction"
>Constructions.Construction</a> conPar[NConPar](
    A=datConPar.A,
    til=datConPar.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>layers={datConPar[i].layers <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar},
    steadyStateInitial=datConPar.steadyStateInitial,
    T_a_start=datConPar.T_a_start,
    T_b_start=datConPar.T_b_start) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConPar <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat conduction through partitions that have both sides inside the thermal zone&quot;</span>;
  <a href="Buildings_Rooms_Constructions.html#Buildings.Rooms.Constructions.Construction"
>Constructions.Construction</a> conBou[NConBou](
    A=datConBou.A,
    til=datConBou.til,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>layers={datConBou[i].layers <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConBou},
    steadyStateInitial=datConBou.steadyStateInitial,
    T_a_start=datConBou.T_a_start,
    T_b_start=datConBou.T_b_start) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat conduction through opaque constructions that have the boundary conditions of the other side exposed&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean linearizeRadiation=true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to linearize emissive power&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Convection</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.InteriorConvection"
>Buildings.HeatTransfer.Types.InteriorConvection</a> intConMod=Buildings.HeatTransfer.Types.InteriorConvection.Temperature <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective heat transfer model for room-facing surfaces of opaque constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</a> hIntFixed=3.0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Constant convection coefficient for room-facing surfaces of opaque constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Types.html#Buildings.HeatTransfer.Types.ExteriorConvection"
>Buildings.HeatTransfer.Types.ExteriorConvection</a> extConMod=Buildings.HeatTransfer.Types.ExteriorConvection.TemperatureWind <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Convective heat transfer model for exterior facing surfaces of opaque constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</a> hExtFixed=10.0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Constant convection coefficient for exterior facing surfaces of opaque constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal(min=0) = V*1.2/3600 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Models for boundary conditions</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> surf_conBou[nConBou] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    haveConBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port at surface b of construction conBou&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> surf_surBou[nSurBou] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    haveSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port of surface that is connected to the room air&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> qGai_flow[3](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;W/m2&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiant, convective and latent heat input into room (positive if heat gain)&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Reassign the tilt since a construction that is declared as a ceiling of the</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// room model has an exterior-facing surface that is a floor</span>
  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditions"
>BaseClasses.ExteriorBoundaryConditions</a> bouConExt(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nCon=nConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>lat=lat,
    linearizeRadiation=linearizeRadiation,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>conMod=extConMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>conPar=datConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>hFixed=hExtFixed) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExt <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Exterior boundary conditions for constructions without a window&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Reassign the tilt since a construction that is declared as a ceiling of the</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// room model has an exterior-facing surface that is a floor</span>
  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ExteriorBoundaryConditionsWithWindow"
>BaseClasses.ExteriorBoundaryConditionsWithWindow</a> bouConExtWin(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nCon=nConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>lat=lat,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>conPar=datConExtWin,
    linearizeRadiation=linearizeRadiation,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>conMod=extConMod,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>hFixed=hExtFixed) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Exterior boundary conditions for constructions with a window&quot;</span>;

  <a href="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.WindowRadiation"
>HeatTransfer.Windows.BaseClasses.WindowRadiation</a> conExtWinRad[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>AWin=(1 .- datConExtWin.fFra) .* datConExtWin.AWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>N={<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauGlaSol=datConExtWin.glaSys.glass.tauSol,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>rhoGlaSol_a=datConExtWin.glaSys.glass.rhoSol_a,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>rhoGlaSol_b=datConExtWin.glaSys.glass.rhoSol_b,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>xGla=datConExtWin.glaSys.glass.x,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauShaSol_a=datConExtWin.glaSys.shade.tauSol_a,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauShaSol_b=datConExtWin.glaSys.shade.tauSol_b,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>rhoShaSol_a=datConExtWin.glaSys.shade.rhoSol_a,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>rhoShaSol_b=datConExtWin.glaSys.shade.rhoSol_b,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveExteriorShade=datConExtWin.glaSys.haveExteriorShade,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveInteriorShade=datConExtWin.glaSys.haveInteriorShade) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
    haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Model for solar radiation through shades and window&quot;</span>;
  <a href="Buildings_BoundaryConditions_WeatherData.html#Buildings.BoundaryConditions.WeatherData.Bus"
>BoundaryConditions.WeatherData.Bus</a> weaBus;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialAirHeatMassBalance"
>BaseClasses.PartialAirHeatMassBalance</a> air
   <span style="color: blue; font-weight: normal; font-style: normal;">constrainedby </span>BaseClasses.PartialAirHeatMassBalance(
        <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Rooms_BaseClasses_Medium.html#Buildings.Rooms.BaseClasses.RoomHeatMassBalance.Medium"
>Medium</a>,
        nPorts=nPorts,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExt=nConExt,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExtWin=nConExtWin,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConPar=nConPar,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConBou=nConBou,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nSurBou=nSurBou,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExt=datConExt,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExtWin=datConExtWin,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConPar=datConPar,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConBou=datConBou,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>surBou=surBou,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveShade=haveShade,
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span>V=V) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Convective heat and mass balance of air&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SolarRadiationExchange"
>Buildings.Rooms.BaseClasses.SolarRadiationExchange</a> solRadExc(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExt=nConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExtWin=nConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConPar=nConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConBou=nConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nSurBou=nSurBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExt = datConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExtWin = datConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConPar = datConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConBou = datConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>surBou = surBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>isFloorConExt=isFloorConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>isFloorConExtWin=isFloorConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>isFloorConPar_a=isFloorConPar_a,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>isFloorConPar_b=isFloorConPar_b,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>isFloorConBou=isFloorConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>isFloorSurBou=isFloorSurBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauGla={datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].tauSol <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin}) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Solar radiative heat exchange&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution"
>Buildings.Rooms.BaseClasses.InfraredRadiationGainDistribution</a> irRadGai(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExt=nConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExtWin=nConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConPar=nConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConBou=nConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nSurBou=nSurBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExt = datConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExtWin = datConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConPar = datConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConBou = datConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>surBou = surBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveShade=haveShade) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Distribution for infrared radiative heat gains (e.g., due to equipment and people)&quot;</span>;
  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.InfraredRadiationExchange"
>Buildings.Rooms.BaseClasses.InfraredRadiationExchange</a> irRadExc(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExt=nConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExtWin=nConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConPar=nConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConBou=nConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nSurBou=nSurBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExt = datConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExtWin = datConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConPar = datConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConBou = datConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>surBou = surBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearizeRadiation = linearizeRadiation,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization = homotopyInitialization) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Infrared radiative heat exchange&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.RadiationTemperature"
>Buildings.Rooms.BaseClasses.RadiationTemperature</a> radTem(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExt=nConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConExtWin=nConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConPar=nConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nConBou=nConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nSurBou=nSurBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExt=datConExt,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConExtWin=datConExtWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConPar=datConPar,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>datConBou=datConBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>surBou=surBou,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveShade=haveShade) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Radiative temperature of the room&quot;</span>;

  <a href="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadeRadiation"
>HeatTransfer.Windows.BaseClasses.ShadeRadiation</a> shaRad[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>A=(1 .- datConExtWin.fFra) .* datConExtWin.AWin,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>thisSideHasShade=haveInteriorShade,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>absIR_air=datConExtWin.glaSys.shade.absIR_a,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>absIR_glass={(datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].absIR_b) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauIR_air=tauIRSha_air,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tauIR_glass=tauIRSha_glass,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearize = linearizeRadiation,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Radiation model for room-side window shade&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>Modelica.SIunits.TransmissionCoefficient</a> tauIRSha_air[NConExtWin]=
    datConExtWin.glaSys.shade.tauIR_a <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Infrared transmissivity of shade for radiation coming from the exterior or the room&quot;</span>;
        <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.TransmissionCoefficient"
>Modelica.SIunits.TransmissionCoefficient</a> tauIRSha_glass[
                                                                          NConExtWin]=
    datConExtWin.glaSys.shade.tauIR_b <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Infrared transmissivity of shade for radiation coming from the glass&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveExteriorShade[NConExtWin]=
    {datConExtWin[i].glaSys.haveExteriorShade <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if window has exterior shade (at surface a)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveInteriorShade[NConExtWin]=
    {datConExtWin[i].glaSys.haveInteriorShade <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if window has interior shade (at surface b)&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveShade=
    <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.BooleanVectors.anyTrue</span>(haveExteriorShade[:])<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
    <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Math.BooleanVectors.anyTrue</span>(haveInteriorShade[:]) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if the windows have a shade&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConExt[NConExt]=
    datConExt.isFloor <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag to indicate if floor for exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConExtWin[NConExtWin]=
    datConExtWin.isFloor <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag to indicate if floor for constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConPar_a[NConPar]=
    datConPar.isFloor <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag to indicate if floor for constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConPar_b[NConPar]=
    datConPar.isCeiling <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag to indicate if floor for constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConBou[NConBou]=
    datConBou.isFloor <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorSurBou[NSurBou]=
    surBou.isFloor <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for constructions that are modeled outside of this room&quot;</span>;

  <a href="Buildings_HeatTransfer_Windows_BaseClasses.html#Buildings.HeatTransfer.Windows.BaseClasses.ShadingSignal"
>HeatTransfer.Windows.BaseClasses.ShadingSignal</a> shaSig[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>haveShade=haveShade) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Shading signal&quot;</span>;

  <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.RadiationAdapter"
>Buildings.Rooms.BaseClasses.RadiationAdapter</a> radiationAdapter;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> add;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> sumJToWin[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>k1=1,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span>k2=1) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sum of radiosity flows from room surfaces toward the window&quot;</span>;

  <a href="Buildings_HeatTransfer_Radiosity.html#Buildings.HeatTransfer.Radiosity.RadiositySplitter"
>HeatTransfer.Radiosity.RadiositySplitter</a> radShaOut[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
     haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Splitter for radiosity that strikes shading device or unshaded part of window&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Sum"
>Modelica.Blocks.Math.Sum</a> sumJFroWin[NConExtWin](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>nin=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveShade<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>2<span style="color: blue; font-weight: normal; font-style: normal;">
         else </span>1) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Sum of radiosity fom window to room surfaces&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Sources.html#Modelica.Thermal.HeatTransfer.Sources.PrescribedTemperature"
>Modelica.Thermal.HeatTransfer.Sources.PrescribedTemperature</a> TSha[NConExtWin] <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Temperature of shading device&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conBou.opa_a, surf_conBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.opa_a, conExtWin.opa_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.JInUns_a, bouConExtWin.JOutUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.JInUns, conExtWin.JOutUns_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.glaUns_a, bouConExtWin.glaUns);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.glaSha, conExtWin.glaSha_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.JInSha_a, bouConExtWin.JOutSha);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.JInSha, conExtWin.JOutSha_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.fra_a, bouConExtWin.fra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExt.opa_a, bouConExt.opa_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(weaBus, bouConExtWin.weaBus);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(weaBus, bouConExt.weaBus);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.QAbsSolSha_flow, conExtWinRad.QAbsExtSha_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.inc, conExtWinRad.incAng);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.HDir, conExtWinRad.HDir);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bouConExtWin.HDif, conExtWinRad.HDif);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.QAbsSha_flow, conExtWinRad.QAbsGlaSha_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWinRad.QAbsGlaUns_flow, conExtWin.QAbsUns_flow);
 <span style="color: #006400; font-weight: normal; font-style: normal;">// Connect statements from the model BaseClasses.MixedAir</span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExt.opa_b, irRadExc.conExt);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.fra_b, irRadExc.conExtWinFra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conPar.opa_a, irRadExc.conPar_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conPar.opa_b, irRadExc.conPar_b);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conBou.opa_b, irRadExc.conBou);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(surf_surBou, irRadExc.conSurBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadGai.conExt, conExt.opa_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadGai.conExtWinFra, conExtWin.fra_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadGai.conPar_a, conPar.opa_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadGai.conPar_b, conPar.opa_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadGai.conBou, conBou.opa_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadGai.conSurBou, surf_surBou);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.opa_b, irRadExc.conExtWin);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.opa_b, irRadGai.conExtWin);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExt.opa_b, solRadExc.conExt);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.fra_b, solRadExc.conExtWinFra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conPar.opa_a, solRadExc.conPar_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conPar.opa_b, solRadExc.conPar_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conBou.opa_b, solRadExc.conBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(surf_surBou, solRadExc.conSurBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.opa_b, solRadExc.conExtWin);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(solRadExc.JInConExtWin, conExtWinRad.QTra_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(solRadExc.HOutConExtWin,conExtWinRad.HRoo);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExt.opa_b, radTem.conExt);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.opa_b, radTem.conExtWin);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.fra_b, radTem.conExtWinFra);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conPar.opa_a, radTem.conPar_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conPar.opa_b, radTem.conPar_b);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conBou.opa_b, radTem.conBou);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(surf_surBou, radTem.conSurBou);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radTem.glaUns, conExtWin.glaUns_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radTem.glaSha, conExtWin.glaSha_b);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radTem.TRad, radiationAdapter.TRad);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radiationAdapter.rad, heaPorRad);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radiationAdapter.QRad_flow, add.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(add.y, irRadGai.Q_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadExc.JOutConExtWin, sumJToWin.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadGai.JOutConExtWin, sumJToWin.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(shaSig.y, radShaOut.u);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(shaSig.y, shaRad.u);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sumJToWin.y, radShaOut.JIn);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radShaOut.JOut_1, shaRad.JIn_air);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radShaOut.JOut_2, conExtWin.JInUns_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(shaRad.JOut_glass, conExtWin.JInSha_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(conExtWin.JOutSha_b, shaRad.JIn_glass);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(irRadExc.JInConExtWin, sumJFroWin.y);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(shaRad.QSolAbs_flow, conExtWinRad.QAbsIntSha_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sumJFroWin.u[1], conExtWin.JOutUns_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(sumJFroWin.u[2], shaRad.JOut_air);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(radTem.sha, TSha.port);

  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(ports[i],air. ports[i]);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.conExt, conExt.opa_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.conExtWin, conExtWin.opa_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.glaUns, conExtWin.glaUns_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.glaSha, conExtWin.glaSha_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.conExtWinFra, conExtWin.fra_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.conPar_a, conPar.opa_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.conPar_b, conPar.opa_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.conBou, conBou.opa_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.conSurBou, surf_surBou);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(shaRad.QRadAbs_flow,air. QRadAbs_flow);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.TSha, shaRad.TSha);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.heaPorAir, heaPorAir);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(air.TSha, TSha.T);

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>RoomHeatMassBalance;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE SkyRadiationExchange<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClassfb194bf94115eed8hangeI.png" alt="Buildings.Rooms.BaseClasses.SkyRadiationExchange" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.SkyRadiationExchange"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.SkyRadiationExchange</h2>
<p>
<b>Radiative heat exchange with the sky and the ambient</b>
<br>
<br><img src="Buildings.Rooms.BaseClassfb194bf94115eed8hangeD.png" alt="Buildings.Rooms.BaseClasses.SkyRadiationExchange">
</p>
<h3>Information</h3>

This model computes the infrared radiative heat flow
between exterior building surfaces and the ambient. The ambient consists
of the sky black-body radiation and the outdoor temperature
(which is used as an approximation to the surface temperature of
the ground and neighboring buildings).

<p>Extends from <a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a> (Base icon).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Integer</td><td>n</td><td>&nbsp;</td><td>Number of constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A[n]</td><td>&nbsp;</td><td>Area of exterior constructions [m2]</td></tr>
<tr><td>Real</td><td>vieFacSky[n]</td><td>&nbsp;</td><td>View factor to sky (=1 for roofs)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</a></td><td>absIR[n]</td><td>&nbsp;</td><td>Infrared absorptivity of building surface [1]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>port[n]</td><td>Heat port</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>TOut</td><td>Outside air temperature [K]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>TBlaSky</td><td>Black body sky temperature [K]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> SkyRadiationExchange <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Radiative heat exchange with the sky and the ambient&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_BaseClasses.html#Buildings.BaseClasses.BaseIcon"
>Buildings.BaseClasses.BaseIcon</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer n(min=1) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of constructions&quot;</span>;
   <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A[n] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Area of exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real vieFacSky[n](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;View factor to sky (=1 for roofs)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> absIR[n] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Infrared absorptivity of building surface&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</a> port[n] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat port&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> TOut(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;ThermodynamicTemperature&quot;,
                                            <span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit = &quot;K&quot;, min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outside air temperature&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> TBlaSky(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;ThermodynamicTemperature&quot;,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=&quot;K&quot;,
    min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Black body sky temperature&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real k[n](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;W/K4&quot;) = {4*A[i]*Modelica.Constants.sigma*absIR[i] <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:n} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Constant for radiative heat exchange&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> TEnv[n] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Environment temperature&quot;</span>;
  Real TBlaSky4(unit=&quot;K4&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable for radiative heat exchange&quot;</span>;
  Real TOut4(unit=&quot;K4&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Auxiliary variable for radiative heat exchange&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>Modelica.SIunits.CoefficientOfHeatTransfer</a> h[n] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Radiative heat transfer coefficient&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  TBlaSky4 = TBlaSky^4;
  TOut4 = TOut^4;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:n<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    TEnv[i] = (vieFacSky[i] * TBlaSky4 + (1-vieFacSky[i]) * TOut4)^(0.25);
    <span style="color: #006400; font-weight: normal; font-style: normal;">// h[i] uses TEnv[i] instead of (port[i].T+TEnv[i])/2 to avoid</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// a nonlinear equation system</span>
    h[i]  = k[i] * TEnv[i]^3;
    port[i].Q_flow = h[i] * (port[i].T-TEnv[i]);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>SkyRadiationExchange;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE SolarRadiationExchange<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass124701a598175785hangeI.png" alt="Buildings.Rooms.BaseClasses.SolarRadiationExchange" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.SolarRadiationExchange"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.SolarRadiationExchange</h2>
<p>
<b>Solar radiation heat exchange between the room facing surfaces</b>
<br>
<br><img src="Buildings.Rooms.BaseClass124701a598175785hangeD.png" alt="Buildings.Rooms.BaseClasses.SolarRadiationExchange">
</p>
<h3>Information</h3>

<p>
This model computes the distribution of the solar radiation gain
to the room surfaces.
Let
<i>N<sup>w</sup></i>
denote the number of windows,
<i>N<sup>f</sup></i>
the number of floor elements and
<i>N<sup>n</sup></i>
the number of non-floor elements such as ceiling, wall and window elements.
Input to the model are the solar radiosities
<i>J<sup>i</sup>, i &isin; {1, &hellip; , N<sup>w</sup>}</i>,
that were transmitted through the window.
The total incoming solar radiation is therefore
</p>
<p align="center" style="font-style:italic;">
H = &sum;<sub>i=1</sub><sup>N<sup>w</sup></sup> J<sub>in</sub><sup>i</sup>
</p>
<p>
It is assumed that <i>H</i> first hits the floor where some of it is absorbed,
and some of it is diffusely reflected to all other surfaces. Only the first
reflection is taken into account and the location of the floor patch
relative to the window is neglected.
</p>
<p>Hence, the radiation that is
absorbed by each floor patch <i>i &isin; {1, &hellip;, N<sup>f</sup>}</i>,
and may be partially transmitted in
the unusual case that the floor contains a window, is
</p>
<p align="center" style="font-style:italic;">
 Q<sup>i</sup> = H &nbsp; (&epsilon;<sup>i</sup>+&tau;<sup>i</sup>) &nbsp; A<sup>i</sup>
&frasl; &sum;<sub>j=1</sub><sup>N<sup>f</sup></sup> &nbsp; A<sup>j</sup>.
</p>
The sum of the radiation that is reflected by the floor is therefore
<p align="center" style="font-style:italic;">
 J<sup>f</sup> = H &nbsp;
&sum;<sub>i=1</sub><sup>N<sup>f</sup></sup>
(1-&epsilon;<sup>i</sup>-&tau;<sup>i</sup>) &nbsp; A<sup>i</sup>
&frasl; &sum;<sub>j=1</sub><sup>N<sup>f</sup></sup> &nbsp; A<sup>j</sup>.
</p>
<p>
This reflected radiosity is then distributed to all non-floor areas
<i>i &isin; {1, &hellip;, N<sup>n</sup>}</i>
using</p>
<p align="center" style="font-style:italic;">
  Q<sup>i</sup> = J<sup>f</sup> &nbsp;
A<sup>i</sup> &nbsp; (&epsilon;<sup>i</sup>+&tau;<sup>i</sup>)
&frasl;
&sum;<sub>k=1</sub><sup>N<sup>n</sup></sup>
A<sup>k</sup> &nbsp; (&epsilon;<sup>k</sup>+&tau;<sup>k</sup>)
</p>
<p>
For opaque surfaces, the heat flow rate
<i>Q<sup>i</sup></i>
is set to be equal to the heat flow rate at the heat port.
For the glass of the windows, the heat flow rate
<i>Q<sup>i</sup></i> is set to the radiosity
<i>J<sub>out</sub><sup>i</sup></i>
that will strike the glass or the window shade as diffuse solar
radiation.

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a> (Partial model that is used for infrared radiation balance).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td>Boolean</td><td>isFloorConExt[NConExt]</td><td>&nbsp;</td><td>Flag to indicate if floor for exterior constructions</td></tr>
<tr><td>Boolean</td><td>isFloorConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Flag to indicate if floor for constructions</td></tr>
<tr><td>Boolean</td><td>isFloorConPar_a[NConPar]</td><td>&nbsp;</td><td>Flag to indicate if floor for constructions</td></tr>
<tr><td>Boolean</td><td>isFloorConPar_b[NConPar]</td><td>&nbsp;</td><td>Flag to indicate if floor for constructions</td></tr>
<tr><td>Boolean</td><td>isFloorConBou[NConBou]</td><td>&nbsp;</td><td>Flag to indicate if floor for constructions with exterior boundary conditions exposed to outside of room model</td></tr>
<tr><td>Boolean</td><td>isFloorSurBou[NSurBou]</td><td>&nbsp;</td><td>Flag to indicate if floor for constructions that are modeled outside of this room</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</a></td><td>tauGla[NConExtWin]</td><td>&nbsp;</td><td>Transmissivity of window [1]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExt[NConExt]</td><td>Heat port that connects to room-side surface of exterior constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWin[NConExtWin]</td><td>Heat port that connects to room-side surface of exterior constructions that contain a window</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conExtWinFra[NConExtWin]</td><td>Heat port that connects to room-side surface of window frame</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_a[NConPar]</td><td>Heat port that connects to room-side surface a of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conPar_b[NConPar]</td><td>Heat port that connects to room-side surface b of partition constructions</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conBou[NConBou]</td><td>Heat port that connects to room-side surface of constructions that expose their other surface to the outside</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</a></td><td>conSurBou[NSurBou]</td><td>Heat port to surfaces of models that compute the heat conduction outside of this room</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>HOutConExtWin[NConExtWin]</td><td>Outgoing solar radiation that strikes window per unit area [W/m2]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>JInConExtWin[NConExtWin]</td><td>Solar radiation transmitted by window per unit area [W]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> SolarRadiationExchange <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Solar radiation heat exchange between the room facing surfaces&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative"
>Buildings.Rooms.BaseClasses.PartialSurfaceInterfaceRadiative</a>(
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConExt = datConExt.layers.absSol_b,
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConExtWinOpa = datConExtWin.layers.absSol_b,
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConExtWinUns={(1-datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].tauSol
                     -datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].rhoSol_b) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConExtWinSha = {(1-datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].tauSol
                       -datConExtWin[i].glaSys.glass[<span style="color: red; font-weight: normal; font-style: normal;">size</span>(datConExtWin[i].glaSys.glass, 1)].rhoSol_b) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin},
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConExtWinFra = datConExtWin.glaSys.absSolFra,
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConPar_a = datConPar.layers.absSol_a,
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConPar_b = datConPar.layers.absSol_b,
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsConBou = datConBou.layers.absSol_b,
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span>epsSurBou = surBou.absSol);
  <span style="color: #006400; font-weight: normal; font-style: normal;">// In the above declaration, we simplified the assignment of epsConExtWinSha.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// An exact formulation would need to take into account the transmission and reflection</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// of the shade for the solar radiation that strikes the window from the room-side.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The simplification leads to too low a value of epsConExtWinSha. Since epsConExtWinSha</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// is used as a weight for how much solar radiation hits the window from the room-side,</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// underestimating epsConExtWinSha does not seem to cause concerns. The reason is that</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the model assumes diffuse reflection, whereas in reality, reflection of the solar</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// radiation at the floor is likely specular, and therefore less radiation would hit</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the window from the room-side.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConExt[NConExt] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConExtWin[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConPar_a[NConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConPar_b[NConPar] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorConBou[NConBou] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for constructions with exterior boundary conditions exposed to outside of room model&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloorSurBou[NSurBou] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to indicate if floor for constructions that are modeled outside of this room&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Modelica.SIunits.Emissivity</a> tauGla[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Transmissivity of window&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> HOutConExtWin[NConExtWin](unit=&quot;W/m2&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outgoing solar radiation that strikes window per unit area&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> JInConExtWin[NConExtWin](unit=&quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Solar radiation transmitted by window per unit area&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> JOutConExtWin[NConExtWin] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Outgoing solar radiation that strikes the window&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> HTot <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total solar radiation that enters the room&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real k1(unit=&quot;1&quot;, fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Intermediate variable for gain for solar radiation distribution&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real k2(fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Intermediate variable for gain for solar radiation distribution&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow[NTot] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Total solar radiation that is absorbed by the surfaces (or transmitted back through the glass)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NOpa = NConExt+2*NConExtWin+2*NConPar+NConBou+NSurBou <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of opaque surfaces, including the window frame&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NWin = NConExtWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of window surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NTot = NOpa + NWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Total number of surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFlo[NTot](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if a surface is a floor&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real eps[NTot](min=0, max=1, fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Solar absorptivity&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real tau[NTot](min=0, max=1, fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Solar transmissivity&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AFlo(fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Total floor area&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A[NTot](fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface areas&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real k[NTot](unit=&quot;1&quot;, fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Gain for solar radiation distribution&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The next loops builds arrays that simplify</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the model equations.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// These arrays store the values of the constructios in the following order</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// [x[1:NConExt] x[1:NConPar] x[1: NConPar] x[1: NConBou] x[1: NSurBou] x[1: NConExtWin] x[1: NConExtWin]]</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// where x is epsOpa, AOpa or kOpa.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The last two entries are for the opaque wall that contains a window, and for the window frame.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    eps[i] = epsConExt[i];
    A[i]      = AConExt[i];
    isFlo[i]  = isFloorConExt[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    eps[i+NConExt]           = epsConPar_a[i];
    A[i+NConExt]             = AConPar[i];
    isFlo[i+NConExt]         = isFloorConPar_a[i];
    eps[i+NConExt+NConPar]   = epsConPar_b[i];
    A[i+NConExt+NConPar]     = AConPar[i];
    isFlo[i+NConExt+NConPar] = isFloorConPar_b[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    eps[i+NConExt+2*NConPar]   = epsConBou[i];
    A[i+NConExt+2*NConPar]     = AConBou[i];
    isFlo[i+NConExt+2*NConPar] = isFloorConBou[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    eps[i+NConExt+2*NConPar+NConBou]   = epsSurBou[i];
    A[i+NConExt+2*NConPar+NConBou]     = ASurBou[i];
    isFlo[i+NConExt+2*NConPar+NConBou] = isFloorSurBou[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Opaque part of construction that has a window embedded</span>
    eps[i+NConExt+2*NConPar+NConBou+NSurBou]   = epsConExtWinOpa[i];
    A[i+NConExt+2*NConPar+NConBou+NSurBou]     = AConExtWinOpa[i];
    isFlo[i+NConExt+2*NConPar+NConBou+NSurBou] = isFloorConExtWin[i];
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Window frame</span>
    eps[i+NConExt+2*NConPar+NConBou+NSurBou+NConExtWin]   = epsConExtWinFra[i];
    A[i+NConExt+2*NConPar+NConBou+NSurBou+NConExtWin]     = AConExtWinFra[i];
    isFlo[i+NConExt+2*NConPar+NConBou+NSurBou+NConExtWin] = isFloorConExtWin[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Window glass</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// We simplify and assume that the shaded and unshaded part of the window</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// have the same solar absorbtance.</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// This simplification allows lumping the solar distribution into</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// a parameter.</span>
    eps[i+NConExt+2*NConPar+NConBou+NSurBou+2*NConExtWin] = epsConExtWinUns[i];
    isFlo[i+NConExt+2*NConPar+NConBou+NSurBou+2*NConExtWin] = isFloorConExtWin[i];
    A[i+NConExt+2*NConPar+NConBou+NSurBou+2*NConExtWin] = AConExtWinGla[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Vector with all surface areas.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The next loops build the array A that simplifies</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// the model equations.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// These array stores the values of the constructios in the following order</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// [AOpa[1:NConExt] AOpa[1:NConPar] AOpa[1: NConPar] AOpa[1: NConBou] AOpa[1: NSurBou]</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">//  AOpa[1: NConExtWin] AOpa[1: NConExtWin] AGla[1: NConExtWin]]</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// since NWin=NConExtWin.</span>

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Solar transmissivity</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NOpa<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    tau[i] = 0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    tau[NOpa+i] = tauGla[i];
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Sum of surface areas</span>
  AFlo =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>( (<span style="color: blue; font-weight: normal; font-style: normal;">if </span>isFlo[i]<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>A[i]<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0) <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NTot);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Coefficient that is used for non-floor areas.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The expression  max(1E-20, AFlo) is used to prevent a division by zero in case AFlo=0.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The situation for AFlo=0 is caught by the assert statement.</span>
  k1 =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>( ( <span style="color: blue; font-weight: normal; font-style: normal;">if </span>isFlo[i]<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>(A[i] * (1-eps[i]-tau[i]))<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0)  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NTot) /<span style="color: red; font-weight: normal; font-style: normal;"> max</span>(1E-20, AFlo);

  k2 =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>( ( <span style="color: blue; font-weight: normal; font-style: normal;">if </span>isFlo[i]<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>0<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>(A[i] * (eps[i]+tau[i])))  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NTot);

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>( k2 &gt; 1E-10)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NTot<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>isFlo[i]<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
         k[i] = (eps[i]+tau[i]) * A[i] / AFlo;
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
         k[i] = k1/k2*(eps[i]+tau[i]) * A[i];
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
     <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">    // This branch only happens if k2=0, i.e., there is no surface other than floors</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NTot<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>isFlo[i]<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        k[i] = A[i] / AFlo;
      <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
        k[i] = 0;
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Test whether there is a floor inside this room</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>( AFlo &gt; 1E-10,
     &quot;Error in parameters of the room model: The geometry is incorrect:\n&quot; +
     &quot;    The room model must have a construction that is a floor,\n&quot; +
     &quot;    and this construction must not have a window.\n&quot; +
     &quot;    The parameters for the room model are such that there is no such construction.\n&quot; +
     &quot;    Revise the model parameters.&quot;);
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Test whether the distribution factors add up to one</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(1-<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(k)) &lt; 1E-5,
     &quot;Program error: Sum of solar distribution factors in room is not equal to one. k=&quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(k)));

<span style="color: #006400; font-weight: normal; font-style: normal;">////////////////////////////////////////////////////////////////////</span>
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Incoming radiation</span>
  HTot =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(JInConExtWin);
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Radiation that is absorbed by the surfaces</span>
  Q_flow = -k .* HTot;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assign heat exchange to connectors</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExt<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExt<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Q_flow[i] = conExt[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conExt[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConPar<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConPar<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Q_flow[i+NConExt]         = conPar_a[i].Q_flow;
      Q_flow[i+NConExt+NConPar] = conPar_b[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      conPar_a[1].T = 293.15;
      conPar_b[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Q_flow[i+NConExt+2*NConPar] = conBou[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conBou[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NSurBou<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Q_flow[i+NConExt+2*NConPar+NConBou] = conSurBou[i].Q_flow;
     <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      conSurBou[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>haveConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NConExtWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      Q_flow[i+NConExt+2*NConPar+NConBou+NSurBou]            = conExtWin[i].Q_flow;
      Q_flow[i+NConExt+2*NConPar+NConBou+NSurBou+NConExtWin] = conExtWinFra[i].Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    conExtWin[1].T    = 293.15;
    conExtWinFra[1].T = 293.15;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Windows</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:NWin<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    Q_flow[j+NOpa] = JOutConExtWin[j];
    HOutConExtWin[j] = <span style="color: blue; font-weight: normal; font-style: normal;">if </span>(AConExtWinGla[j] &gt; 1E-10)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>JOutConExtWin[j] / AConExtWinGla[j]<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>SolarRadiationExchange;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE cfdExchangeData<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Rooms.BaseClasses.cfdExchangeData"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.cfdExchangeData</h2>
<p>
<b>Exchange data between CFD and Modelica</b>
</p>
<h3>Information</h3>

<p>
This function calls a C function to conduct the data exchange between Modelica and CFD program during the coupled simulation.</p>

<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Integer</td><td>flag</td><td>&nbsp;</td><td>Communication flag to CFD</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>t</td><td>&nbsp;</td><td>Current Modelica simulation time to CFD [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>dt</td><td>&nbsp;</td><td>Requested synchronization time step size [s]</td></tr>
<tr><td>Real</td><td>u[nU]</td><td>&nbsp;</td><td>Input to CFD</td></tr>
<tr><td>Integer</td><td>nU</td><td>&nbsp;</td><td>Number of inputs to CFD</td></tr>
<tr><td>Integer</td><td>nY</td><td>&nbsp;</td><td>Number of outputs from CFD</td></tr>
</table>
<h3>Outputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Outputs">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>modTimRea</td><td>Current model time from CFD [s]</td></tr>
<tr><td>Real</td><td>y[nY]</td><td>Output computed by CFD</td></tr>
<tr><td>Integer</td><td>retVal</td><td>Return value for CFD simulation status</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> cfdExchangeData <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Exchange data between CFD and Modelica&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer flag <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Communication flag to CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> t <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Current Modelica simulation time to CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> dt(min=100*Modelica.Constants.eps) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Requested synchronization time step size&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real[nU] u <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Input to CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nU <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of inputs to CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nY <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of outputs from CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> modTimRea <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Current model time from CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real[nY] y <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Output computed by CFD&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Integer retVal <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Return value for CFD simulation status&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">external</span>&quot;C&quot; retVal = <span style="color: red; font-weight: normal; font-style: normal;">cfdExchangeData</span>(
    t,
    dt,
    u,
    nU,
    nY,
    modTimRea,
    y);

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>cfdExchangeData;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE cfdReceiveFeedback<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Rooms.BaseClasses.cfdReceiveFeedback"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.cfdReceiveFeedback</h2>
<p>
<b>Receive the feedback from CFD</b>
</p>
<h3>Information</h3>

<p>
This function calls a C function to receive the feedback from CFD about the status of performing a Stop command sent by Modelica.
<h3>Outputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Outputs">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>Integer</td><td>retVal</td><td>Return value of the function (0 indicates CFD successfully stopped.)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> cfdReceiveFeedback <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Receive the feedback from CFD&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Integer retVal <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Return value of the function (0 indicates CFD successfully stopped.)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">external</span>&quot;C&quot; retVal = <span style="color: red; font-weight: normal; font-style: normal;">cfdReceiveFeedback</span>();

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>cfdReceiveFeedback;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE cfdSendStopCommand<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Rooms.BaseClasses.cfdSendStopCommand"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.cfdSendStopCommand</h2>
<p>
<b>Send the stop command to CFD</b>
</p>
<h3>Information</h3>

<p>
This function calls a C function to send a stop command to CFD to stop the CFD simulation.
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> cfdSendStopCommand <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Send the stop command to CFD&quot;</span>

<span style="color: blue; font-weight: normal; font-style: normal;">external</span>&quot;C&quot; <span style="color: red; font-weight: normal; font-style: normal;">cfdSendStopCommand</span>();


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>cfdSendStopCommand;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE cfdStartCosimulation<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Rooms.BaseClasses.cfdStartCosimulation"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.cfdStartCosimulation</h2>
<p>
<b>Start the coupled simulation with CFD</b>
</p>
<h3>Information</h3>

<p>
This function calls a C function to start the coupled simulation with CFD.
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>cfdFilNam</td><td>&nbsp;</td><td>CFD input file name</td></tr>
<tr><td>String</td><td>name[nSur]</td><td>&nbsp;</td><td>Surface names</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A[nSur]</td><td>&nbsp;</td><td>Surface areas [m2]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>til[nSur]</td><td>&nbsp;</td><td>Surface tilt [rad]</td></tr>
<tr><td><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>CFDBoundaryConditions</a></td><td>bouCon[nSur]</td><td>&nbsp;</td><td>Type of boundary condition</td></tr>
<tr><td>Integer</td><td>nPorts</td><td>&nbsp;</td><td>Number of fluid ports for the HVAC inlet and outlets</td></tr>
<tr><td>String</td><td>portName[nPorts]</td><td>&nbsp;</td><td>Names of fluid ports as declared in the CFD input file</td></tr>
<tr><td>Boolean</td><td>haveSensor</td><td>&nbsp;</td><td>Flag, true if the model has at least one sensor</td></tr>
<tr><td>String</td><td>sensorName[nSen]</td><td>&nbsp;</td><td>Names of sensors as declared in the CFD input file</td></tr>
<tr><td>Boolean</td><td>haveShade</td><td>&nbsp;</td><td>Flag, true if the windows have a shade</td></tr>
<tr><td>Integer</td><td>nSur</td><td>&nbsp;</td><td>Number of surfaces</td></tr>
<tr><td>Integer</td><td>nSen</td><td>&nbsp;</td><td>Number of sensors that are connected to CFD output</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>number of exterior construction with window</td></tr>
<tr><td>Integer</td><td>nXi</td><td>&nbsp;</td><td>Number of independent species</td></tr>
<tr><td>Integer</td><td>nC</td><td>&nbsp;</td><td>Number of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</a></td><td>rho_start</td><td>&nbsp;</td><td>Density at initial state [kg/m3]</td></tr>
</table>
<h3>Outputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Outputs">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>Integer</td><td>retVal</td><td>Return value of the function (0 indicates CFD successfully started.)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> cfdStartCosimulation <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Start the coupled simulation with CFD&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String cfdFilNam <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;CFD input file name&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String[nSur] name <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface names&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a>[nSur] A <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface areas&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a>[nSur] til <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a>[nSur] bouCon <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Type of boundary condition&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nPorts(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of fluid ports for the HVAC inlet and outlets&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String portName[nPorts] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Names of fluid ports as declared in the CFD input file&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean haveSensor <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag, true if the model has at least one sensor&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String sensorName[nSen] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Names of sensors as declared in the CFD input file&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Boolean haveShade <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Flag, true if the windows have a shade&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nSur <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of surfaces&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nSen(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of sensors that are connected to CFD output&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nConExtWin(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;number of exterior construction with window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nXi(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of independent species&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nC(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of trace substances&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_start <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Density at initial state&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Integer retVal <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Return value of the function (0 indicates CFD successfully started.)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">external</span>&quot;C&quot; retVal = <span style="color: red; font-weight: normal; font-style: normal;">cfdStartCosimulation</span>(
    cfdFilNam,
    name,
    A,
    til,
    bouCon,
    nPorts,
    portName,
    haveSensor,
    sensorName,
    haveShade,
    nSur,
    nSen,
    nConExtWin,
    nXi,
    nC,
    rho_start);


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>cfdStartCosimulation;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE to_W<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClasses.to_WI.png" alt="Buildings.Rooms.BaseClasses.to_W" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.to_W"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.to_W</h2>
<p>
<b>Add unit [W] to data</b>
<br>
<br><img src="Buildings.Rooms.BaseClasses.to_WD.png" alt="Buildings.Rooms.BaseClasses.to_W">
</p>
<h3>Information</h3>
This component adds the unit [W] into the data.

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</a> (This icon will be removed in future Modelica versions, use Modelica.Blocks.Icons.Block instead.).</p>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>u</td><td>&nbsp;</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>y</td><td>Power [W]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">block</span> to_W <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Add unit [W] to data&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BlockIcon"
>Modelica.Blocks.Interfaces.BlockIcon</a>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> u;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> y(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>quantity=&quot;Power&quot;, <span style="color: blue; font-weight: normal; font-style: normal;">final </span>unit=
        &quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Power&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  y = u;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>to_W;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE CFDSurfaceIdentifier<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass7e6dd80f57131c1cifierI.png" alt="Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.CFDSurfaceIdentifier"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.CFDSurfaceIdentifier</h2>
<p>
<b>Data record to identify surfaces in the CFD code</b>
</p>
<h3>Information</h3>

<p>
This record is a data structure that is used to assemble
information that is used in the CFD to identify surface data
that are exchanged with Modelica.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a> (Icon for records).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Name of the surface</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A</td><td>&nbsp;</td><td>Area of the surface [m2]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>til</td><td>&nbsp;</td><td>Tilt of the surface [rad]</td></tr>
<tr><td><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>CFDBoundaryConditions</a></td><td>bouCon</td><td>&nbsp;</td><td>Boundary condition used in the CFD simulation</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> CFDSurfaceIdentifier <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Data record to identify surfaces in the CFD code&quot;</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String name <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Name of the surface&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Area of the surface&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> til <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Tilt of the surface&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> bouCon <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Boundary condition used in the CFD simulation&quot;</span>;


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>CFDSurfaceIdentifier;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ConstructionNumbers<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Rooms.BaseClasses.ConstructionNumbers"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.ConstructionNumbers</h2>
<p>
<b>Data records for construction data</b>
</p>
<h3>Information</h3>

<p>
Record that defines the number of constructions that are
used in the room model.
</p>
<p>
This record also declares parameters that contain the number of constructions,
such as the number of exterior constructions <code>nConExt</code>.
This parameter may take on the value <code>0</code>.
If this parameter were to be used to declare the size of vectors of
component models, then there may be vectors with zero components.
This can cause problems in Dymola 7.4.
Therefore, a parameter is declared in the form
</p>
<pre>
  NConExt = max(1, nConExt)
</pre>
<p>This parameter is the used by models that extend this model
to set the size of the vector of component models.</p>
<p>
There are also parameters that can be used to conditionally remove components,
such as <code>haveConExt</code>, which is set to
</p>
<pre>
  haveConExt = nConExt > 0;
</pre>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> ConstructionNumbers <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Data records for construction data&quot;</span>

  <span style="color: #006400; font-weight: normal; font-style: normal;">////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Number of constructions and surface areas</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nConExt(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of exterior constructions&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nConExtWin(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of window constructions&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nConPar(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of partition constructions&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nConBou(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of constructions that have their outside surface exposed to the boundary of this room&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nSurBou(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of surface heat transfer models that connect to constructions that are modeled outside of this room&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Dimensions of components and connectors</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NConExt(min=1) =<span style="color: red; font-weight: normal; font-style: normal;"> max</span>(1, nConExt) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of elements for exterior constructions&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NConExtWin(min=1)=<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nConExtWin) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of elements for exterior constructions with windows&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NConPar(min=1)=<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nConPar) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of elements for partition constructions&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NConBou(min=1)=<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nConBou) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of elements for constructions that have their outside surface exposed to the boundary of this room&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer NSurBou(min=1)=<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nSurBou) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Number of elements for surface heat transfer models that connect to constructions that are modeled outside of this room&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Flags to conditionally remove components</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveConExt = nConExt &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to conditionally remove components&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveConExtWin = nConExtWin &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to conditionally remove components&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveConPar = nConPar &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to conditionally remove components&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveConBou = nConBou &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to conditionally remove components&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveSurBou = nSurBou &gt; 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag to conditionally remove components&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ConstructionNumbers;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ConstructionRecords<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Rooms.BaseClasses.ConstructionRecords"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.ConstructionRecords</h2>
<p>
<b>Data records for construction data</b>
<br>
<br><img src="Buildings.Rooms.BaseClass7a7debdf919d9749cordsD.png" alt="Buildings.Rooms.BaseClasses.ConstructionRecords">
</p>
<h3>Information</h3>

<p>
Record that defines the number of constructions that are
used in the room model.
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionNumbers"
>Buildings.Rooms.BaseClasses.ConstructionNumbers</a> (Data records for construction data).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConExt[NConExt]</td><td>&nbsp;</td><td>Data for exterior construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>ParameterConstructionWithWindow</a></td><td>datConExtWin[NConExtWin]</td><td>&nbsp;</td><td>Data for exterior construction with window</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConPar[NConPar]</td><td>&nbsp;</td><td>Data for partition construction</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a></td><td>datConBou[NConBou]</td><td>&nbsp;</td><td>Data for construction boundary</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>OpaqueSurface</a></td><td>surBou[NSurBou]</td><td>&nbsp;</td><td>Record for data of surfaces whose heat conduction is modeled outside of this room</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>Brick120</a></td><td>dummyCon</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>SingleClear3</a></td><td>dummyGlaSys</td><td>&nbsp;</td><td>Dummy construction to assign a parameter to the instance</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExt</td><td>&nbsp;</td><td>Number of exterior constructions</td></tr>
<tr><td>Integer</td><td>nConExtWin</td><td>&nbsp;</td><td>Number of window constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Partition constructions</td></tr>
<tr><td>Integer</td><td>nConPar</td><td>&nbsp;</td><td>Number of partition constructions</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary constructions</td></tr>
<tr><td>Integer</td><td>nConBou</td><td>&nbsp;</td><td>Number of constructions that have their outside surface exposed to the boundary of this room</td></tr>
<tr><td>Integer</td><td>nSurBou</td><td>&nbsp;</td><td>Number of surface heat transfer models that connect to constructions that are modeled outside of this room</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> ConstructionRecords <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Data records for construction data&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ConstructionNumbers"
>Buildings.Rooms.BaseClasses.ConstructionNumbers</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>ParameterConstruction</a> datConExt[NConExt](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>A=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>layers = dummyCon,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>til=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>azi=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Data for exterior construction&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"
>Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow</a>
    datConExtWin[NConExtWin](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>A=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>layers = dummyCon,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>til=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>azi=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>hWin=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>wWin=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>glaSys=dummyGlaSys) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Data for exterior construction with window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>Buildings.Rooms.BaseClasses.ParameterConstruction</a> datConPar[NConPar](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>A=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>layers = dummyCon,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>til=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>azi=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Data for partition construction&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.ParameterConstruction"
>Buildings.Rooms.BaseClasses.ParameterConstruction</a> datConBou[NConBou](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>A=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>layers = dummyCon,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>til=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>azi=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Data for construction boundary&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.OpaqueSurface"
>Buildings.Rooms.BaseClasses.OpaqueSurface</a> surBou[NSurBou](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>A=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>til=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Record for data of surfaces whose heat conduction is modeled outside of this room&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Dummy constructions to assign values to parameters.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// The actual assignments will be overwritten by models that extend this model.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Note that parameters in records cannot be protected. However, we set the</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// annotation HideResult=true to avoid that they show up in the output file.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Brick120"
>HeatTransfer.Data.OpaqueConstructions.Brick120</a> dummyCon <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Dummy construction to assign a parameter to the instance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3"
>Buildings.HeatTransfer.Data.GlazingSystems.SingleClear3</a> dummyGlaSys <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Dummy construction to assign a parameter to the instance&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ConstructionRecords;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE OpaqueSurface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceI.png" alt="Buildings.Rooms.BaseClasses.OpaqueSurface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.OpaqueSurface"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.OpaqueSurface</h2>
<p>
<b>Record for exterior constructions that have no window</b>
</p>
<h3>Information</h3>

<p>
This data record is used to set the parameters of opaque surfaces.
</p>
<p>
The surface tilt is defined in <a href="Buildings_Types_Tilt.html#Buildings.Types.Tilt"
>
Buildings.Types.Tilt</a>
</p>

<p>Extends from <a href="Buildings_HeatTransfer_Data_OpaqueSurfaces.html#Buildings.HeatTransfer.Data.OpaqueSurfaces.Generic"
>Buildings.HeatTransfer.Data.OpaqueSurfaces.Generic</a> (Thermal properties of opaque surfaces).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A</td><td>&nbsp;</td><td>Area [m2]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>til</td><td>&nbsp;</td><td>Surface tilt (0: ceiling, pi/2: wall, pi: floor [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</a></td><td>absIR</td><td>0.84</td><td>Infrared absorptivity [1]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Emissivity"
>Emissivity</a></td><td>absSol</td><td>0.84</td><td>Solar absorptivity [1]</td></tr>
<tr><td>String</td><td>name</td><td>&quot;&quot;</td><td>Surface name. Optional for MixedAir, required for CFD.</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary condition</td></tr>
<tr><td><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>CFDBoundaryConditions</a></td><td>boundaryCondition</td><td>Buildings.Rooms.Types.CFDBou...</td><td>Boundary condition used in the CFD simulation</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> OpaqueSurface <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Record for exterior constructions that have no window&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_HeatTransfer_Data_OpaqueSurfaces.html#Buildings.HeatTransfer.Data.OpaqueSurfaces.Generic"
>Buildings.HeatTransfer.Data.OpaqueSurfaces.Generic</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String name = &quot;&quot; <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface name. Optional for MixedAir, required for CFD.&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> boundaryCondition=
    Buildings.Rooms.Types.CFDBoundaryConditions.Temperature <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Boundary condition used in the CFD simulation&quot;</span>;


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>OpaqueSurface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Overhang<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceI.png" alt="Buildings.Rooms.BaseClasses.Overhang" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.Overhang"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.Overhang</h2>
<p>
<b>Record for window overhang</b>
</p>
<h3>Information</h3>

<p>
This record declares parameters for window overhangs.
</p>
<p>
See
<a href="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.Overhang"
>
Buildings.HeatTransfer.Windows.Overhang</a>
for an explanation of the parameters, and
for the assumptions and limitations
of the overhang model.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a> (Icon for records).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Overhang</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>wL</td><td>&nbsp;</td><td>Overhang width left to the window, measured from the window corner [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>wR</td><td>&nbsp;</td><td>Overhang width right to the window, measured from the window corner [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>dep</td><td>&nbsp;</td><td>Overhang depth (measured perpendicular to the wall plane) [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>gap</td><td>&nbsp;</td><td>Distance between window upper edge and overhang lower edge [m]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> Overhang <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Record for window overhang&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> wL(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Overhang width left to the window, measured from the window corner&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> wR(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Overhang width right to the window, measured from the window corner&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> dep(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Overhang depth (measured perpendicular to the wall plane)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> gap(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Distance between window upper edge and overhang lower edge&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveOverhang= dep &gt; Modelica.Constants.eps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if the window has an overhang&quot;</span>;


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>Overhang;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ParameterConstruction<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceI.png" alt="Buildings.Rooms.BaseClasses.ParameterConstruction" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.ParameterConstruction"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.ParameterConstruction</h2>
<p>
<b>Record for exterior constructions that have no window</b>
</p>
<h3>Information</h3>

<p>
This data record is used to set the parameters of constructions that do not have a window.
</p>
<p>
The surface azimuth is defined in
<a href="Buildings_Types_Azimuth.html#Buildings.Types.Azimuth"
>
Buildings.Types.Azimuth</a>
and the surface tilt is defined in <a href="Buildings_Types_Tilt.html#Buildings.Types.Tilt"
>
Buildings.Types.Tilt</a>
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialParameterConstruction"
>Buildings.Rooms.BaseClasses.PartialParameterConstruction</a> (Partial record for constructions).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&quot;&quot;</td><td>Surface name. Optional for MixedAir, required for FFD.</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>til</td><td>&nbsp;</td><td>Surface tilt [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>azi</td><td>&nbsp;</td><td>Surface azimuth [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A</td><td>&nbsp;</td><td>Heat transfer area [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Opaque construction</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Generic"
>Generic</a></td><td>layers</td><td>&nbsp;</td><td>Material properties of opaque construction</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td>Boolean</td><td>steadyStateInitial</td><td>false</td><td>=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_a_start</td><td>293.15</td><td>Initial temperature at port_a, used if steadyStateInitial = false [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_b_start</td><td>293.15</td><td>Initial temperature at port_b, used if steadyStateInitial = false [K]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary condition</td></tr>
<tr><td><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>CFDBoundaryConditions</a></td><td>boundaryCondition</td><td>Buildings.Rooms.Types.CFDBou...</td><td>Boundary condition used in the CFD simulation</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> ParameterConstruction <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Record for exterior constructions that have no window&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialParameterConstruction"
>Buildings.Rooms.BaseClasses.PartialParameterConstruction</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat transfer area&quot;</span>;


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ParameterConstruction;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ParameterConstructionWithWindow<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceI.png" alt="Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.ParameterConstructionWithWindow</h2>
<p>
<b>Record for exterior constructions that have a window</b>
<br>
<br><img src="Buildings.Rooms.BaseClass9e633c7ec4500d5eindowD.png" alt="Buildings.Rooms.BaseClasses.ParameterConstructionWithWindow">
</p>
<h3>Information</h3>

<p>
This data record is used to set the parameters of constructions that do have a window.
</p>
<p>
The surface azimuth is defined in
<a href="Buildings_Types_Azimuth.html#Buildings.Types.Azimuth"
>
Buildings.Types.Azimuth</a>
and the surface tilt is defined in <a href="Buildings_Types_Tilt.html#Buildings.Types.Tilt"
>
Buildings.Types.Tilt</a>
</p>

<p>Extends from <a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialParameterConstruction"
>Buildings.Rooms.BaseClasses.PartialParameterConstruction</a> (Partial record for constructions).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&quot;&quot;</td><td>Surface name. Optional for MixedAir, required for FFD.</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>til</td><td>&nbsp;</td><td>Surface tilt [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>azi</td><td>&nbsp;</td><td>Surface azimuth [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</a></td><td>A</td><td>&nbsp;</td><td>Heat transfer area of opaque construction and window combined [m2]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Opaque construction</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Generic"
>Generic</a></td><td>layers</td><td>&nbsp;</td><td>Material properties of opaque construction</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td>Boolean</td><td>steadyStateInitial</td><td>false</td><td>=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_a_start</td><td>293.15</td><td>Initial temperature at port_a, used if steadyStateInitial = false [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_b_start</td><td>293.15</td><td>Initial temperature at port_b, used if steadyStateInitial = false [K]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary condition</td></tr>
<tr><td><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>CFDBoundaryConditions</a></td><td>boundaryCondition</td><td>Buildings.Rooms.Types.CFDBou...</td><td>Boundary condition used in the CFD simulation</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Glazing system</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>hWin</td><td>&nbsp;</td><td>Window height [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>wWin</td><td>&nbsp;</td><td>Window width [m]</td></tr>
<tr><td>Real</td><td>fFra</td><td>0.1</td><td>Fraction of window frame divided by total window area</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.Overhang"
>Overhang</a></td><td>ove</td><td>&nbsp;</td><td>Geometry of overhang</td></tr>
<tr><td><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SideFins"
>SideFins</a></td><td>sidFin</td><td>&nbsp;</td><td>Geometry of side fins</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.Generic"
>Generic</a></td><td>glaSys</td><td>&nbsp;</td><td>Material properties of glazing system</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> ParameterConstructionWithWindow <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Record for exterior constructions that have a window&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.PartialParameterConstruction"
>Buildings.Rooms.BaseClasses.PartialParameterConstruction</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> A <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat transfer area of opaque construction and window combined&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> hWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Window height&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> wWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Window width&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AWin=hWin*wWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat transfer area of window&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AOpa = A-AWin <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat transfer area of opaque construction&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real fFra(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>min=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>max=1) = 0.1 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fraction of window frame divided by total window area&quot;</span>;

 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.Overhang"
>Buildings.Rooms.BaseClasses.Overhang</a> ove(
    wR=0,
    wL=0,
    dep=0,
    gap=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Geometry of overhang&quot;</span>;
 <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses.SideFins"
>Buildings.Rooms.BaseClasses.SideFins</a> sidFin(h=0, dep=0, gap=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Geometry of side fins&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AFra = fFra*AWin <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Frame area&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Modelica.SIunits.Area</a> AGla=AWin - AFra <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Glass area&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Data_GlazingSystems.html#Buildings.HeatTransfer.Data.GlazingSystems.Generic"
>HeatTransfer.Data.GlazingSystems.Generic</a> glaSys <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Material properties of glazing system&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveOverhangOrSideFins = (ove.dep &gt; 1E-8)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>(sidFin.dep &gt; 1E-8) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if the construction has either an overhang or side fins&quot;</span>;


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ParameterConstructionWithWindow;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialParameterConstruction<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceI.png" alt="Buildings.Rooms.BaseClasses.PartialParameterConstruction" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.PartialParameterConstruction"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.PartialParameterConstruction</h2>
<p>
<b>Partial record for constructions</b>
</p>
<h3>Information</h3>

<p>
This data record is used to set the parameters of constructions that do not have a window.
</p>
<p>
The surface azimuth is defined in
<a href="Buildings_Types_Azimuth.html#Buildings.Types.Azimuth"
>
Buildings.Types.Azimuth</a>
and the surface tilt is defined in <a href="Buildings_Types_Tilt.html#Buildings.Types.Tilt"
>
Buildings.Types.Tilt</a>
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a> (Icon for records).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&quot;&quot;</td><td>Surface name. Optional for MixedAir, required for FFD.</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>til</td><td>&nbsp;</td><td>Surface tilt [rad]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</a></td><td>azi</td><td>&nbsp;</td><td>Surface azimuth [rad]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Opaque construction</td></tr>
<tr><td><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Generic"
>Generic</a></td><td>layers</td><td>&nbsp;</td><td>Material properties of opaque construction</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td>Boolean</td><td>steadyStateInitial</td><td>false</td><td>=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_a_start</td><td>293.15</td><td>Initial temperature at port_a, used if steadyStateInitial = false [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_b_start</td><td>293.15</td><td>Initial temperature at port_b, used if steadyStateInitial = false [K]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Boundary condition</td></tr>
<tr><td><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>CFDBoundaryConditions</a></td><td>boundaryCondition</td><td>Buildings.Rooms.Types.CFDBou...</td><td>Boundary condition used in the CFD simulation</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> PartialParameterConstruction <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial record for constructions&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String name = &quot;&quot; <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Surface name. Optional for MixedAir, required for FFD.&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_HeatTransfer_Data_OpaqueConstructions.html#Buildings.HeatTransfer.Data.OpaqueConstructions.Generic"
>Buildings.HeatTransfer.Data.OpaqueConstructions.Generic</a>
    layers <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Material properties of opaque construction&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> til <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface tilt&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</a> azi <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Surface azimuth&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isFloor=til &gt; 2.74889125<span style="color: blue; font-weight: normal; font-style: normal;"> and </span>til &lt; 3.53428875 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if construction is a floor&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isCeiling=til &gt; -0.392699<span style="color: blue; font-weight: normal; font-style: normal;"> and </span>til &lt; 0.392699 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if construction is a floor&quot;</span>;
<span style="color: #006400; font-weight: normal; font-style: normal;">//  final parameter Integer nLay(min=1, fixed=true) = size(layers.material, 1)</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//    &quot;Number of layers&quot;;</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//  final parameter Integer nSta[:](each min=1)={layers.material[i].nSta for i in 1:size(layers.material, 1)}</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//    &quot;Number of states&quot;  annotation(Evaluate=true);</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean steadyStateInitial=false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=true initializes dT(0)/dt=0, false initializes T(0) at fixed temperature using T_a_start and T_b_start&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T_a_start=293.15 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial temperature at port_a, used if steadyStateInitial = false&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T_b_start=293.15 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial temperature at port_b, used if steadyStateInitial = false&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Buildings_Rooms_Types.html#Buildings.Rooms.Types.CFDBoundaryConditions"
>Buildings.Rooms.Types.CFDBoundaryConditions</a> boundaryCondition=
    Buildings.Rooms.Types.CFDBoundaryConditions.Temperature <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Boundary condition used in the CFD simulation&quot;</span>;


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialParameterConstruction;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE SideFins<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Rooms.BaseClass1121ccf215b476cfrfaceI.png" alt="Buildings.Rooms.BaseClasses.SideFins" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Rooms.BaseClasses.SideFins"></a><a href="Buildings_Rooms_BaseClasses.html#Buildings.Rooms.BaseClasses"
>Buildings.Rooms.BaseClasses</a>.SideFins</h2>
<p>
<b>Record for window side fins</b>
</p>
<h3>Information</h3>

<p>
This record declares parameters for window side fins.
</p>
<p>
See
<a href="Buildings_HeatTransfer_Windows.html#Buildings.HeatTransfer.Windows.SideFins"
>
Buildings.HeatTransfer.Windows.SideFins</a>
for an explanation of the parameters, and
for the assumptions and limitations
of the model for side fins.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a> (Icon for records).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Side fin</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>h</td><td>&nbsp;</td><td>Height of side fin that extends above window, measured from top of window [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>dep</td><td>&nbsp;</td><td>Side fin depth (measured perpendicular to the wall plane) [m]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</a></td><td>gap</td><td>&nbsp;</td><td>Distance between side fin and window edge [m]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> SideFins <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Record for window side fins&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Record"
>Modelica.Icons.Record</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> h(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Height of side fin that extends above window, measured from top of window&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> dep(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Side fin depth (measured perpendicular to the wall plane)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Modelica.SIunits.Length</a> gap(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Distance between side fin and window edge&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean haveSideFins= dep &gt; Modelica.Constants.eps <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if the window has side fins&quot;</span>;


<span style="color: blue; font-weight: normal; font-style: normal;">end </span>SideFins;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:30:38 2015.
</address>
</body>
</html>
