<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Utilities.IO.Python27.Functions</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with functions that call Python&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Functions<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Utilities.IO.Python27.Functions"></a><a href="Buildings_Utilities_IO_Python27.html#Buildings.Utilities.IO.Python27"
>Buildings.Utilities.IO.Python27</a>.Functions</h2>
<p>
<b>Package with functions that call Python</b><br>
</p>
<h3>Information</h3>

<p>
This package contains functions that call Python.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</a> (Icon for packages containing base classes).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.Utilities.IO.Pyb3dbfa7e202daad4hangeS.png" alt="Buildings.Utilities.IO.Python27.Functions.exchange" width="20" height="20" align="top">&nbsp;<a href="Buildings_Utilities_IO_Python27_Functions.html#Buildings.Utilities.IO.Python27.Functions.exchange"
>exchange</a>
</td>
<td>Function that communicates with Python</td>
</tr>
<tr>
<td><img src="Buildings.Utilities.IO.Py29e1f6d824752382mplesS.png" alt="Buildings.Utilities.IO.Python27.Functions.Examples" width="20" height="20" align="top">&nbsp;<a href="Buildings_Utilities_IO_Python27_Functions_Examples.html#Buildings.Utilities.IO.Python27.Functions.Examples"
>Examples</a>
</td>
<td>Collection of models that illustrate model use and test models</td>
</tr>
<tr>
<td><img src="Buildings.Utilities.IO.Pydd8423a6519feea5assesS.png" alt="Buildings.Utilities.IO.Python27.Functions.BaseClasses" width="20" height="20" align="top">&nbsp;<a href="Buildings_Utilities_IO_Python27_Functions_BaseClasses.html#Buildings.Utilities.IO.Python27.Functions.BaseClasses"
>BaseClasses</a>
</td>
<td>Package with functions that call Python</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE exchange<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Utilities.IO.Python27.Functions.exchange"></a><a href="Buildings_Utilities_IO_Python27_Functions.html#Buildings.Utilities.IO.Python27.Functions"
>Buildings.Utilities.IO.Python27.Functions</a>.exchange</h2>
<p>
<b>Function that communicates with Python</b>
</p>
<h3>Information</h3>

<p>
This function is a wrapper for
<a href="Buildings_Utilities_IO_Python27_Functions_BaseClasses.html#Buildings.Utilities.IO.Python27.Functions.BaseClasses.exchange"
>
Buildings.Utilities.IO.Python27.Functions.BaseClasses.exchange</a>.
It adds the directory <code>modelica://Buildings/Resources/Python-Sources</code>
to the environment variable <code>PYTHONPATH</code>
prior to calling the function that exchanges data with Python.
After the function call, the <code>PYTHONPATH</code> is set back to what
it used to be when entering this function.
See
<a href="Buildings_Utilities_IO_Python27_UsersGuide.html#Buildings.Utilities.IO.Python27.UsersGuide"
>
Buildings.Utilities.IO.Python27.UsersGuide</a>
for instructions, and
<a href="Buildings_Utilities_IO_Python27_Functions_Examples.html#Buildings.Utilities.IO.Python27.Functions.Examples"
>
Buildings.Utilities.IO.Python27.Functions.Examples</a>
for examples.
</p>

<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>moduleName</td><td>&nbsp;</td><td>Name of the python module that contains the function</td></tr>
<tr><td>String</td><td>functionName</td><td>moduleName</td><td>Name of the python function</td></tr>
<tr><td>Real</td><td>dblWri[max(1, nDblWri)]</td><td>&nbsp;</td><td>Double values to write</td></tr>
<tr><td>Integer</td><td>intWri[max(1, nIntWri)]</td><td>&nbsp;</td><td>Integer values to write</td></tr>
<tr><td>String</td><td>strWri[max(1, nStrWri)]</td><td>&nbsp;</td><td>String values to write</td></tr>
<tr><td>Integer</td><td>nDblWri</td><td>&nbsp;</td><td>Number of double values to write</td></tr>
<tr><td>Integer</td><td>nDblRea</td><td>&nbsp;</td><td>Number of double values to read</td></tr>
<tr><td>Integer</td><td>nIntWri</td><td>&nbsp;</td><td>Number of integer values to write</td></tr>
<tr><td>Integer</td><td>nIntRea</td><td>&nbsp;</td><td>Number of integer values to read</td></tr>
<tr><td>Integer</td><td>nStrWri</td><td>&nbsp;</td><td>Number of strings to write</td></tr>
</table>
<h3>Outputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Outputs">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>Real</td><td>dblRea[max(1, nDblRea)]</td><td>Double values returned by Python</td></tr>
<tr><td>Integer</td><td>intRea[max(1, nIntRea)]</td><td>Integer values returned by Python</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">function</span> exchange <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Function that communicates with Python&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String moduleName <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Name of the python module that contains the function&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String functionName=moduleName <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Name of the python function&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Real    dblWri[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nDblWri)] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Double values to write&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer intWri[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nIntWri)] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Integer values to write&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>String  strWri[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nStrWri)] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;String values to write&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nDblWri(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of double values to write&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nDblRea(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of double values to read&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nIntWri(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of integer values to write&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nIntRea(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of integer values to read&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">input </span>Integer nStrWri(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of strings to write&quot;</span>;
<span style="color: #006400; font-weight: normal; font-style: normal;">//  input Integer nStrRea(min=0) &quot;Number of strings to read&quot;;</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//  input Integer strLenRea(min=0)</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//    &quot;Maximum length of each string that is read. If exceeded, the simulation stops with an error&quot;;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Real    dblRea[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nDblRea)] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Double values returned by Python&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">output </span>Integer intRea[<span style="color: red; font-weight: normal; font-style: normal;">max</span>(1, nIntRea)] <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Integer values returned by Python&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  String pytPat <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Value of PYTHONPATH environment variable&quot;</span>;
  String pytPatBuildings <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;PYTHONPATH of Buildings library&quot;</span>;
  Boolean havePytPat <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;true if PYTHONPATH is already set by the user&quot;</span>;
<span style="color: #006400; font-weight: normal; font-style: normal;">//--  String filNam = &quot;file://Utilities/IO/Python27/UsersGuide/package.mo&quot;</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//--    &quot;Name to a file of the Buildings library&quot;;</span>
<span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
 <span style="color: #006400; font-weight: normal; font-style: normal;">// Get the directory to Buildings/Resources/Python-Sources</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//-- The lines below do not work in Dymola 2014 due to an issue with the loadResource</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//-- (ticket #15168). This will be fixed in future versions.</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//-- pytPatBuildings := Buildings.BoundaryConditions.WeatherData.BaseClasses.getAbsolutePath(uri=filNam);</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//-- pytPatBuildings := Modelica.Utilities.Strings.replace(</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//--   string=pytPatBuildings,</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//--   searchString=filNam,</span>
<span style="color: #006400; font-weight: normal; font-style: normal;">//--   replaceString=&quot;Resources/Python-Sources&quot;);</span>
 <span style="color: #006400; font-weight: normal; font-style: normal;">// The next line is a temporary fix for the above problem</span>
 pytPatBuildings := &quot;Resources/Python-Sources&quot;;
 <span style="color: #006400; font-weight: normal; font-style: normal;">// Update the PYTHONPATH variable</span>
 (pytPat, havePytPat) :=<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.System.getEnvironmentVariable</span>(&quot;PYTHONPATH&quot;);
 <span style="color: blue; font-weight: normal; font-style: normal;">if </span>havePytPat<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
   <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.System.setEnvironmentVariable</span>(name=&quot;PYTHONPATH&quot;,
      content=pytPat + &quot;:&quot; + pytPatBuildings);
 <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
   <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.System.setEnvironmentVariable</span>(name=&quot;PYTHONPATH&quot;,
      content=pytPatBuildings);
 <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
 <span style="color: #006400; font-weight: normal; font-style: normal;">// Call the exchange function</span>
 (dblRea, intRea) :=<span style="color: red; font-weight: normal; font-style: normal;">BaseClasses.exchange</span>(
    moduleName=moduleName,
    functionName=functionName,
    dblWri=dblWri,
    intWri=intWri,
    strWri=strWri,
    nDblWri=nDblWri,
    nDblRea=nDblRea,
    nIntWri=nIntWri,
    nIntRea=nIntRea,
    nStrWri=nStrWri);

 <span style="color: #006400; font-weight: normal; font-style: normal;">// Change the PYTHONPATH back to what it was so that the function has no</span>
 <span style="color: #006400; font-weight: normal; font-style: normal;">// side effects.</span>
 <span style="color: blue; font-weight: normal; font-style: normal;">if </span>havePytPat<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
   <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.System.setEnvironmentVariable</span>(name=&quot;PYTHONPATH&quot;,
      content=pytPat);
 <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
   <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.System.setEnvironmentVariable</span>(name=&quot;PYTHONPATH&quot;,
      content=&quot;&quot;);
 <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>exchange;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:30:45 2015.
</address>
</body>
</html>
