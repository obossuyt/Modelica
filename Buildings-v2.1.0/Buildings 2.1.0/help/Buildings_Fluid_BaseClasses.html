<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Fluid.BaseClasses</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with base classes for Buildings.Fluid&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.BaseClasses"></a><a href="Buildings_Fluid.html#Buildings.Fluid"
>Buildings.Fluid</a>.BaseClasses</h2>
<p>
<b>Package with base classes for Buildings.Fluid</b><br>
</p>
<h3>Information</h3>

<p>
This package contains base classes that are used to construct the models in
<a href="Buildings_Fluid.html#Buildings.Fluid"
>Buildings.Fluid</a>.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_BasesPackage.html#Modelica.Icons.BasesPackage"
>Modelica.Icons.BasesPackage</a> (Icon for packages containing base classes).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.IndexMassFraction"
>IndexMassFraction</a>
</td>
<td>Computes the index of a substance in the mass fraction vector Xi</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.BaseClassd65bba9eaaf74451tanceS.png" alt="Buildings.Fluid.BaseClasses.PartialResistance" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialResistance"
>PartialResistance</a>
</td>
<td>Partial model for a hydraulic resistance</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.BaseClass9ca16aa766a27d03tanceS.png" alt="Buildings.Fluid.BaseClasses.PartialThreeWayResistance" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses.PartialThreeWayResistance"
>PartialThreeWayResistance</a>
</td>
<td>Flow splitter with partial resistance model at each port</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.BaseClasses.FlowModelsS.png" alt="Buildings.Fluid.BaseClasses.FlowModels" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_BaseClasses_FlowModels.html#Buildings.Fluid.BaseClasses.FlowModels"
>FlowModels</a>
</td>
<td>Flow models for pressure drop calculations</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE IndexMassFraction<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.BaseClasses.IndexMassFraction"></a><a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses"
>Buildings.Fluid.BaseClasses</a>.IndexMassFraction</h2>
<p>
<b>Computes the index of a substance in the mass fraction vector Xi</b>
</p>
<h3>Information</h3>

<p>
This block computes the index that the subtance with name
<code>substanceName</code> has in the mass fraction vector <code>X</code>.
If the medium model has no component called <code>substanceName</code>,
then the block writes an error message and terminates the simulation.
</p>
<p>
This block is used for example to obtain the index of the subtance 'water'
to obtain the water vapor concentration, or to measure any other mass fraction.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium model</td></tr>
<tr><td>String</td><td>substanceName</td><td>&quot;&quot;</td><td>Name of species substance</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Medium model</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">block</span> IndexMassFraction <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Computes the index of a substance in the mass fraction vector Xi&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
      <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialCondensingGases.html#Modelica.Media.Interfaces.PartialCondensingGases"
>Modelica.Media.Interfaces.PartialCondensingGases</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium model&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>String substanceName=&quot;&quot; <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Name of species substance&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer i_x(fixed=false) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Index of substance&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Compute index of species vector that carries the substance name</span>
  i_x :=-1;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Strings.isEqual</span>(string1=Medium.substanceNames[i],
                                            string2=substanceName,
                                            caseSensitive=false)<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        i_x :=i;
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(i_x &gt; 0, &quot;Substance &#39;&quot; + substanceName + &quot;&#39; is not present in medium &#39;&quot;
                  + Medium.mediumName + &quot;&#39;.\n&quot;
                  + &quot;Change medium model to one that has &#39;&quot; + substanceName + &quot;&#39; as a substance.&quot;);

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>IndexMassFraction;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialResistance<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.BaseClassd65bba9eaaf74451tanceI.png" alt="Buildings.Fluid.BaseClasses.PartialResistance" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.BaseClasses.PartialResistance"></a><a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses"
>Buildings.Fluid.BaseClasses</a>.PartialResistance</h2>
<p>
<b>Partial model for a hydraulic resistance</b>
<br>
<br><img src="Buildings.Fluid.BaseClassd65bba9eaaf74451tanceD.png" alt="Buildings.Fluid.BaseClasses.PartialResistance">
</p>
<h3>Information</h3>

<p>
Partial model for a flow resistance, possible with variable flow coefficient.
Models that extend this class need to implement an equation that relates
<code>m_flow</code> and <code>dp</code>, and they need to assign the parameter
<code>m_flow_turbulent</code>.
</p>
<p>
See for example
<a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>
Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> for a model that extends
this base class.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_turbulent</td><td>&nbsp;</td><td>Turbulent flow if |m_flow| &gt;= m_flow_turbulent [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure drop at nominal mass flow rate [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr><td>Boolean</td><td>linearized</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialResistance <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model for a hydraulic resistance&quot;</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>(
     show_T=false,
     dp(start=0, nominal=dp_nominal_pos),
     m_flow(nominal=m_flow_nominal_pos),
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_small = 1E-4*<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(m_flow_nominal));

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean from_dp = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp_nominal(displayUnit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure drop at nominal mass flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean linearized = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_turbulent(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Turbulent flow if |m_flow| &gt;= m_flow_turbulent&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_default=
     <span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(T=Medium.T_default, p=Medium.p_default, X=Medium.X_default);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>Modelica.SIunits.DynamicViscosity</a> eta_default=<span style="color: red; font-weight: normal; font-style: normal;">Medium.dynamicViscosity</span>(sta_default) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Dynamic viscosity, used to compute transition to turbulent flow regime&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal_pos =<span style="color: red; font-weight: normal; font-style: normal;"> abs</span>(m_flow_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absolute value of nominal flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp_nominal_pos =<span style="color: red; font-weight: normal; font-style: normal;"> abs</span>(dp_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Absolute value of nominal pressure&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Isenthalpic state transformation (no storage and no loss of energy)</span>
  port_a.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.h_outflow);
  port_b.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.h_outflow);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Mass balance (no storage)</span>
  port_a.m_flow + port_b.m_flow = 0;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Transport of substances</span>
  port_a.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.Xi_outflow);
  port_b.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.Xi_outflow);

  port_a.C_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.C_outflow);
  port_b.C_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.C_outflow);

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialResistance;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialThreeWayResistance<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.BaseClass9ca16aa766a27d03tanceI.png" alt="Buildings.Fluid.BaseClasses.PartialThreeWayResistance" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.BaseClasses.PartialThreeWayResistance"></a><a href="Buildings_Fluid_BaseClasses.html#Buildings.Fluid.BaseClasses"
>Buildings.Fluid.BaseClasses</a>.PartialThreeWayResistance</h2>
<p>
<b>Flow splitter with partial resistance model at each port</b>
<br>
<br><img src="Buildings.Fluid.BaseClass9ca16aa766a27d03tanceD.png" alt="Buildings.Fluid.BaseClasses.PartialThreeWayResistance">
</p>
<h3>Information</h3>

<p>
Partial model for flow resistances with three ports such as a
flow mixer/splitter or a three way valve.
</p>
<p>
If <code>dynamicBalance=true</code>, then at the junction of the three flows,
a mixing volume will be present. This will introduce a dynamic energy and momentum
balance, which often breaks algebraic loops.
The time constant of the mixing volume is determined by the parameter <code>tau</code>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a> (Declarations for lumped volumes).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>PartialTwoPortInterface</a></td><td>res1</td><td>redeclare Buildings.Fluid.In...</td><td>Partial model, to be replaced with a fluid component</td></tr>
<tr><td><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>PartialTwoPortInterface</a></td><td>res2</td><td>redeclare Buildings.Fluid.In...</td><td>Partial model, to be replaced with a fluid component</td></tr>
<tr><td><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>PartialTwoPortInterface</a></td><td>res3</td><td>redeclare Buildings.Fluid.In...</td><td>Partial model, to be replaced with a fluid component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Boolean</td><td>dynamicBalance</td><td>true</td><td>Set to true to use a dynamic balance, which often leads to smaller systems of equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>mDyn_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate for dynamic momentum and energy balance [kg/s]</td></tr>
<tr><td>Real</td><td>mSenFac</td><td>1</td><td>Factor for scaling the sensible thermal mass of the volume</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>10</td><td>Time constant at nominal flow for dynamic energy and momentum balance [s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>true</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_1</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_1</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_2</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_2</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>PortFlowDirection</a></td><td>portFlowDirection_3</td><td>Modelica.Fluid.Types.PortFlo...</td><td>Flow direction for port_3</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_1</td><td>First port, typically inlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_2</td><td>Second port, typically outlet</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_3</td><td>Third port, can be either inlet or outlet</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialThreeWayResistance <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Flow splitter with partial resistance model at each port&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>mSenFac=1);

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_1(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    m_flow(min=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(portFlowDirection_1 == Modelica.Fluid.Types.PortFlowDirection.Entering)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>0.0<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>-Modelica.Constants.inf,
           max=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(portFlowDirection_1== Modelica.Fluid.Types.PortFlowDirection.Leaving)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>0.0<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>Modelica.Constants.inf)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;First port, typically inlet&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>Modelica.Fluid.Interfaces.FluidPort_b</a> port_2(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    m_flow(min=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(portFlowDirection_2 == Modelica.Fluid.Types.PortFlowDirection.Entering)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>0.0<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>-Modelica.Constants.inf,
           max=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(portFlowDirection_2 == Modelica.Fluid.Types.PortFlowDirection.Leaving)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>0.0<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>Modelica.Constants.inf)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Second port, typically outlet&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_3(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium=<a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    m_flow(min=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(portFlowDirection_3==Modelica.Fluid.Types.PortFlowDirection.Entering)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>0.0<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>-Modelica.Constants.inf,
           max=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>(portFlowDirection_3==Modelica.Fluid.Types.PortFlowDirection.Leaving)<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>0.0<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>Modelica.Constants.inf)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Third port, can be either inlet or outlet&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean dynamicBalance = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to use a dynamic balance, which often leads to smaller systems of equations&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau=10 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Time constant at nominal flow for dynamic energy and momentum balance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mDyn_flow_nominal <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate for dynamic momentum and energy balance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean from_dp = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>Modelica.Fluid.Types.PortFlowDirection</a> portFlowDirection_1=Modelica.Fluid.Types.PortFlowDirection.Bidirectional <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow direction for port_1&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>Modelica.Fluid.Types.PortFlowDirection</a> portFlowDirection_2=Modelica.Fluid.Types.PortFlowDirection.Bidirectional <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow direction for port_2&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.PortFlowDirection"
>Modelica.Fluid.Types.PortFlowDirection</a> portFlowDirection_3=Modelica.Fluid.Types.PortFlowDirection.Bidirectional <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flow direction for port_3&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> res1(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    allowFlowReversal=portFlowDirection_1 == Modelica.Fluid.Types.PortFlowDirection.Bidirectional) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Partial model, to be replaced with a fluid component&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> res2(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    allowFlowReversal=portFlowDirection_2 == Modelica.Fluid.Types.PortFlowDirection.Bidirectional) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Partial model, to be replaced with a fluid component&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> res3(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    allowFlowReversal=portFlowDirection_3 == Modelica.Fluid.Types.PortFlowDirection.Bidirectional) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Partial model, to be replaced with a fluid component&quot;</span>;

  <a href="Buildings_Fluid_Delays.html#Buildings.Fluid.Delays.DelayFirstOrder"
>Buildings.Fluid.Delays.DelayFirstOrder</a> vol(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>nPorts=3,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>tau=tau,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=mDyn_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>energyDynamics=energyDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>massDynamics=massDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>p_start=p_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_start=T_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>X_start=X_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_start=C_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal=true,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>prescribedHeatFlowRate=false) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
       dynamicBalance <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fluid volume to break algebraic loop&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_internal(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>) <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>dynamicBalance <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Internal dummy port for easier connection of conditional connections&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>portFlowDirection_1==Modelica.Fluid.Types.PortFlowDirection.Leaving<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>dynamicBalance<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res1.port_a, port_internal);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res1.port_a, vol.ports[1]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_1, res1.port_b);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>dynamicBalance<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res1.port_b, port_internal);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res1.port_b, vol.ports[1]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_1, res1.port_a);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>portFlowDirection_2==Modelica.Fluid.Types.PortFlowDirection.Leaving<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>dynamicBalance<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res2.port_a, port_internal);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res2.port_a, vol.ports[2]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_2, res2.port_b);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>dynamicBalance<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res2.port_b, port_internal);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res2.port_b, vol.ports[2]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_2, res2.port_a);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>portFlowDirection_3==Modelica.Fluid.Types.PortFlowDirection.Leaving<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>dynamicBalance<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res3.port_a, port_internal);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res3.port_a, vol.ports[3]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_3, res3.port_b);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>dynamicBalance<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res3.port_b, port_internal);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: red; font-weight: normal; font-style: normal;"> connect</span>(res3.port_b, vol.ports[3]);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_3, res3.port_a);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialThreeWayResistance;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:26:30 2015.
</address>
</body>
</html>
