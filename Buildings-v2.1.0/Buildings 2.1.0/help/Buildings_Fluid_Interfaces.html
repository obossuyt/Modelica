<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Buildings.Fluid.Interfaces</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;Package with interfaces for fluid models&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="../Resources/www/modelicaDoc.css">
</HEAD>
<body>
<!-- begin header -->
<div class="headerStyle">
<img src="../Resources/www/lbl-logo.png" alt="LBL logo"/>
</div>
<div class="headerLinks">
<ul><li><a href="http://simulationresearch.lbl.gov/modelica">Home</a> &gt; <a href="Buildings.html">Modelica</a></li></ul>
</div>
<!-- end header -->

<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Interfaces<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces"></a><a href="Buildings_Fluid.html#Buildings.Fluid"
>Buildings.Fluid</a>.Interfaces</h2>
<p>
<b>Package with interfaces for fluid models</b><br>
</p>
<h3>Information</h3>

<p>
This package contains basic classes that are used to build
component models that change the state of the
fluid. The classes are not directly usable, but can
be extended when building a new model.
</p>

<p>Extends from <a href="../../msl/Modelica%203.2.1/help/Modelica_Icons_InterfacesPackage.html#Modelica.Icons.InterfacesPackage"
>Modelica.Icons.InterfacesPackage</a> (Icon for packages containing interfaces).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaces.UsersGuideS.png" alt="Buildings.Fluid.Interfaces.UsersGuide" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces_UsersGuide.html#Buildings.Fluid.Interfaces.UsersGuide"
>UsersGuide</a>
</td>
<td>User&#39;s Guide</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface1d8308de49633a59ationS.png" alt="Buildings.Fluid.Interfaces.ConservationEquation" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.ConservationEquation"
>ConservationEquation</a>
</td>
<td>Lumped volume with mass and energy balance</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaces.FourPortS.png" alt="Buildings.Fluid.Interfaces.FourPort" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPort"
>FourPort</a>
</td>
<td>Partial model with four ports</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface997284f3a7348477angerS.png" alt="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortHeatMassExchanger"
>FourPortHeatMassExchanger</a>
</td>
<td>Model transporting two fluid streams between four ports with storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface0bf626e24a9671a0rfaceS.png" alt="Buildings.Fluid.Interfaces.PartialFourPortInterface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>PartialFourPortInterface</a>
</td>
<td>Partial model transporting fluid between two ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface33181cf93d409e40oPortS.png" alt="Buildings.Fluid.Interfaces.PartialTwoPort" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPort"
>PartialTwoPort</a>
</td>
<td>Partial component with two ports</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface33181cf93d409e40oPortS.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortInterface" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>PartialTwoPortInterface</a>
</td>
<td>Partial model transporting fluid between two ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface40f9c98ce4c1e214sportS.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortTransport" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortTransport"
>PartialTwoPortTransport</a>
</td>
<td>Partial element transporting fluid between two ports without storage of mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interface50611bb4be03a719StateS.png" alt="Buildings.Fluid.Interfaces.PrescribedOutletState" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PrescribedOutletState"
>PrescribedOutletState</a>
</td>
<td>Component that assigns the outlet fluid property at port_a based on an input signal</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacecfb0ac59541ba4f9angerS.png" alt="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger"
>StaticFourPortHeatMassExchanger</a>
</td>
<td>Partial model transporting two fluid streams between four ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacea868bbaf7da4f56dationS.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"
>StaticTwoPortConservationEquation</a>
</td>
<td>Partial model for static energy and mass conservation equations</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacee19327459e14118bangerS.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>StaticTwoPortHeatMassExchanger</a>
</td>
<td>Partial model transporting fluid between two ports without storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaceaa717523098d688cangerS.png" alt="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger"
>TwoPortHeatMassExchanger</a>
</td>
<td>Partial model transporting one fluid stream with storing mass or energy</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacebc5fa511548cb52detersS.png" alt="Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>FourPortFlowResistanceParameters</a>
</td>
<td>Parameters for flow resistance for models with four ports</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacebc5fa511548cb52detersS.png" alt="Buildings.Fluid.Interfaces.LumpedVolumeDeclarations" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>LumpedVolumeDeclarations</a>
</td>
<td>Declarations for lumped volumes</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacebc5fa511548cb52detersS.png" alt="Buildings.Fluid.Interfaces.PrescribedOutletStateParameters" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PrescribedOutletStateParameters"
>PrescribedOutletStateParameters</a>
</td>
<td>Parameters for models with prescribed outlet state</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfacebc5fa511548cb52detersS.png" alt="Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>TwoPortFlowResistanceParameters</a>
</td>
<td>Parameters for flow resistance for models with two ports</td>
</tr>
<tr>
<td><img src="Buildings.Fluid.Interfaces.ExamplesS.png" alt="Buildings.Fluid.Interfaces.Examples" width="20" height="20" align="top">&nbsp;<a href="Buildings_Fluid_Interfaces_Examples.html#Buildings.Fluid.Interfaces.Examples"
>Examples</a>
</td>
<td>Collection of models that illustrate model use and test models</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE ConservationEquation<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface1d8308de49633a59ationI.png" alt="Buildings.Fluid.Interfaces.ConservationEquation" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.ConservationEquation"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.ConservationEquation</h2>
<p>
<b>Lumped volume with mass and energy balance</b>
<br>
<br><img src="Buildings.Fluid.Interface1d8308de49633a59ationD.png" alt="Buildings.Fluid.Interfaces.ConservationEquation">
</p>
<h3>Information</h3>

<p>
Basic model for an ideally mixed fluid volume with the ability to store mass and energy.
It implements a dynamic or a steady-state conservation equation for energy and mass fractions.
The model has zero pressure drop between its ports.
</p>
<h4>Implementation</h4>
<p>
When extending or instantiating this model, the input
<code>fluidVolume</code>, which is the actual volume occupied by the fluid,
needs to be assigned.
For most components, this can be set to a parameter.
</p>
Input connectors of the model are
<ul>
<li>
<code>Q_flow</code>, which is the sensible plus latent heat flow rate added to the medium, and
</li>
<li>
<code>mWat_flow</code>, which is the moisture mass flow rate added to the medium.
</li>
</ul>
<p>
The model can be used as a dynamic model or as a steady-state model.
However, for a steady-state model with exactly two fluid ports connected,
the model
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"
>
Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation</a>
provides a more efficient implementation.
</p>
<p>
For a model that instantiates this model, see
<a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>
Buildings.Fluid.MixingVolumes.MixingVolume</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a> (Declarations for lumped volumes).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</a></td><td>fluidVolume</td><td>&nbsp;</td><td>Volume [m3]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Real</td><td>mSenFac</td><td>1</td><td>Factor for scaling the sensible thermal mass of the volume</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>VesselFluidPorts_b</a></td><td>ports[nPorts]</td><td>Fluid inlets and outlets</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>Q_flow</td><td>Sensible plus latent heat flow rate transferred into the medium [W]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>mWat_flow</td><td>Moisture mass flow rate added to the medium [kg/s]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>hOut</td><td>Leaving specific enthalpy of the component [J/kg]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>XiOut[Medium.nXi]</td><td>Leaving species concentration of the component [1]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>COut[Medium.nC]</td><td>Leaving trace substances of the component</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> ConservationEquation <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Lumped volume with mass and energy balance&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"
>Buildings.Fluid.Interfaces.LumpedVolumeDeclarations</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Boolean initialize_p = <span style="color: blue; font-weight: normal; font-style: normal;">not </span>Medium.singleState <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true to set up initial equations for pressure&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Port definitions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Integer nPorts=0 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Number of ports&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Vessels_BaseClasses.html#Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b"
>Modelica.Fluid.Vessels.BaseClasses.VesselFluidPorts_b</a> ports[nPorts](
      <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">each </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.LumpedVolumeDeclarations.Medium"
>Medium</a>) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Fluid inlets and outlets&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Set nominal attributes where literal values can be used.</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</a> medium(
    p(start=p_start),
    h(start=hStart),
    T(start=T_start),
    Xi(start=X_start[1:Medium.nXi]),
    X(start=X_start),
    d(start=rho_start)) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium properties&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Modelica.SIunits.Energy</a> U(start=fluidVolume*rho_start*
    <span style="color: red; font-weight: normal; font-style: normal;">Medium.specificInternalEnergy</span>(<span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(
     T=T_start,
     p=p_start,
     X=X_start[1:Medium.nXi])) +
    (T_start - Medium.reference_T)*CSen) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Internal energy of fluid&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a> m <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Mass of fluid&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a>[Medium.nXi] mXi <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Masses of independent components in the fluid&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Modelica.SIunits.Mass</a>[Medium.nC] mC <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Masses of trace substances in the fluid&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// C need to be added here because unlike for Xi, which has medium.Xi,</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// there is no variable medium.C</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C[Medium.nC](nominal=C_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Trace substance mixture content&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mb_flow <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Mass flows across boundaries&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a>[Medium.nXi] mbXi_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Substance mass flows across boundaries&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraPropertyFlowRate"
>Medium.ExtraPropertyFlowRate</a>[Medium.nC] mbC_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Trace substance mass flows across boundaries&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.EnthalpyFlowRate"
>Modelica.SIunits.EnthalpyFlowRate</a> Hb_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Enthalpy flow across boundaries or energy source/sink&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Inputs that need to be defined by an extending class</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Modelica.SIunits.Volume</a> fluidVolume <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>Modelica.SIunits.HeatCapacity</a> CSen=
    (mSenFac - 1)*rho_default*cp_default*fluidVolume <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Aditional heat capacity for implementing mFactor&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Q_flow(unit=&quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sensible plus latent heat flow rate transferred into the medium&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> mWat_flow(unit=&quot;kg/s&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Moisture mass flow rate added to the medium&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Outputs that are needed in models that extend this model</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> hOut(unit=&quot;J/kg&quot;,
                                             start=hStart) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving specific enthalpy of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> XiOut[Medium.nXi](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;1&quot;,
                                                          <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0,
                                                          <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving species concentration of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> COut[Medium.nC](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving trace substances of the component&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.EnthalpyFlowRate"
>Medium.EnthalpyFlowRate</a> ports_H_flow[nPorts];
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> ports_mXi_flow[nPorts,Medium.nXi];
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraPropertyFlowRate"
>Medium.ExtraPropertyFlowRate</a> ports_mC_flow[nPorts,Medium.nC];
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</a> cp_default=
  <span style="color: red; font-weight: normal; font-style: normal;">Medium.specificHeatCapacityCp</span>(state=state_default) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat capacity, to compute additional dry mass&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_start=<span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(
   <span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(
     T=T_start,
     p=p_start,
     X=X_start[1:Medium.nXi])) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Density, used to compute fluid mass&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Parameter for avoiding extra overhead calculations when CSen==0</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean computeCSen = CSen &gt; Modelica.Constants.eps;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> state_default =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.setState_pTX</span>(
      T=Medium.T_default,
      p=Medium.p_default,
      X=Medium.X_default[1:Medium.nXi]) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium state at default values&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Density at medium default values, used to compute the size of control volumes</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_default=<span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(
    state=state_default) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Density, used to compute fluid mass&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Parameter that is used to construct the vector mXi_flow</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real s[Medium.nXi] = {<span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Strings.isEqual</span>(
                                            string1=Medium.substanceNames[i],
                                            string2=&quot;Water&quot;,
                                            caseSensitive=false)<span style="color: blue; font-weight: normal; font-style: normal;">
                                            then </span>1<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0 <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Vector with zero everywhere except where species is&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> hStart=
    <span style="color: red; font-weight: normal; font-style: normal;">Medium.specificEnthalpy_pTX</span>(p_start, T_start, X_start) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for specific enthalpy&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assert that the substance with name &#39;water&#39; has been found.</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(Medium.nXi == 0<span style="color: blue; font-weight: normal; font-style: normal;"> or </span><span style="color: red; font-weight: normal; font-style: normal;">abs</span>(<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(s)-1) &lt; 1e-5,
      &quot;If Medium.nXi &gt; 1, then substance &#39;water&#39; must be present for one component.&#39;&quot;
         + Medium.mediumName + &quot;&#39;.\n&quot;
         + &quot;Check medium model.&quot;);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Make sure that if energyDynamics is SteadyState, then</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// massDynamics is also SteadyState.</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Otherwise, the system of ordinary differential equations may be inconsistent.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(massDynamics == energyDynamics, &quot;
         If &#39;massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState&#39;, then it is
         required that &#39;energyDynamics==Modelica.Fluid.Types.Dynamics.SteadyState&#39;.
         Otherwise, the system of equations may not be consistent.
         You need to select other parameter values.&quot;);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// initialization of balances</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      medium.T = T_start;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">  der</span>(medium.T) = 0;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>initialize_p<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      medium.p = p_start;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: blue; font-weight: normal; font-style: normal;">if </span>initialize_p<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
        <span style="color: red; font-weight: normal; font-style: normal;">der</span>(medium.p) = 0;
      <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>substanceDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    medium.Xi = X_start[1:Medium.nXi];
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>substanceDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">der</span>(medium.Xi) =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(Medium.nXi);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>traceDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    C = C_start[1:Medium.nC];
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>traceDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: red; font-weight: normal; font-style: normal;">der</span>(C) =<span style="color: red; font-weight: normal; font-style: normal;"> zeros</span>(Medium.nC);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Total quantities</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    m = fluidVolume*rho_start;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    m = fluidVolume*medium.d;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  mXi = m*medium.Xi;
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>computeCSen<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    U = m*medium.u + CSen*(medium.T-Medium.reference_T);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    U = m*medium.u;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
  mC = m*C;

  hOut = medium.h;
  XiOut = medium.Xi;
  COut = C;

  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">//The semiLinear function should be used for the equations below</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">//for allowing min/max simplifications.</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">//See https://github.com/iea-annex60/modelica-annex60/issues/216 for a discussion and motivation</span>
    ports_H_flow[i]     =<span style="color: red; font-weight: normal; font-style: normal;"> semiLinear</span>(ports[i].m_flow,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(ports[i].h_outflow), ports[i].h_outflow) <span style="color: #006400; font-weight: normal; font-style: normal;">
      &quot;Enthalpy flow&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      ports_mXi_flow[i,j] =<span style="color: red; font-weight: normal; font-style: normal;"> semiLinear</span>(ports[i].m_flow,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(ports[i].Xi_outflow[j]), ports[i].Xi_outflow[j]) <span style="color: #006400; font-weight: normal; font-style: normal;">
        &quot;Component mass flow&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">for </span>j<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      ports_mC_flow[i,j]  =<span style="color: red; font-weight: normal; font-style: normal;"> semiLinear</span>(ports[i].m_flow,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(ports[i].C_outflow[j]),  ports[i].C_outflow[j]) <span style="color: #006400; font-weight: normal; font-style: normal;">
        &quot;Trace substance mass flow&quot;</span>;
    <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    mbXi_flow[i] =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(ports_mXi_flow[:,i]);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nC<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
    mbC_flow[i]  =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(ports_mC_flow[:,i]);
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

  mb_flow =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(ports.m_flow);
  Hb_flow =<span style="color: red; font-weight: normal; font-style: normal;"> sum</span>(ports_H_flow);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Energy and mass balances</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    0 = Hb_flow + Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: red; font-weight: normal; font-style: normal;">der</span>(U) = Hb_flow + Q_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    0 = mb_flow + mWat_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: red; font-weight: normal; font-style: normal;">der</span>(m) = mb_flow + mWat_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>substanceDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">zeros</span>(Medium.nXi) = mbXi_flow + mWat_flow * s;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: red; font-weight: normal; font-style: normal;">der</span>(mXi) = mbXi_flow + mWat_flow * s;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>traceDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">zeros</span>(Medium.nC)  = mbC_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: red; font-weight: normal; font-style: normal;">der</span>(mC)  = mbC_flow;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Properties of outgoing flows</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:nPorts<span style="color: blue; font-weight: normal; font-style: normal;"> loop</span>
      ports[i].p          = medium.p;
      ports[i].h_outflow  = medium.h;
      ports[i].Xi_outflow = medium.Xi;
      ports[i].C_outflow  = C;
  <span style="color: blue; font-weight: normal; font-style: normal;">end for</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>ConservationEquation;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE FourPort<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfaces.FourPortI.png" alt="Buildings.Fluid.Interfaces.FourPort" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.FourPort"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.FourPort</h2>
<p>
<b>Partial model with four ports</b>
<br>
<br><img src="Buildings.Fluid.Interfaces.FourPortD.png" alt="Buildings.Fluid.Interfaces.FourPort">
</p>
<h3>Information</h3>

<p>
This model defines an interface for components with four ports.
The parameters <code>allowFlowReversal1</code> and
<code>allowFlowReversal2</code> may be used by models that extend
this model to treat flow reversal.
</p>
<p>
This model is identical to
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPort"
>
Modelica.Fluid.Interfaces.PartialTwoPort</a>, except that it has four ports.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium 2 in the component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>true</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>true</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td>Medium 2 in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> FourPort <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Partial model with four ports&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium1 =
      <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium 1 in the component&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium2 =
      <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium 2 in the component&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean allowFlowReversal1 = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean allowFlowReversal2 = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_a1_start = Medium1.h_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for enthalpy flowing out of port a1&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_b1_start = Medium1.h_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for enthalpy flowing out of port b1&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_a2_start = Medium2.h_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for enthalpy flowing out of port a2&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_b2_start = Medium2.h_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for enthalpy flowing out of port b2&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_a1(
                     <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
                     m_flow(min=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal1<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>-Modelica.Constants.inf<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0),
                     h_outflow(start=h_outflow_a1_start)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>Modelica.Fluid.Interfaces.FluidPort_b</a> port_b1(
                     <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
                     m_flow(max=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal1<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>+Modelica.Constants.inf<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0),
                     h_outflow(start=h_outflow_b1_start)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_a2(
                     <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
                     m_flow(min=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal2<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>-Modelica.Constants.inf<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0),
                     h_outflow(start=h_outflow_a2_start)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>Modelica.Fluid.Interfaces.FluidPort_b</a> port_b2(
                     <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
                     m_flow(max=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal2<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>+Modelica.Constants.inf<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0),
                     h_outflow(start=h_outflow_b2_start)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>FourPort;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE FourPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface997284f3a7348477angerI.png" alt="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.FourPortHeatMassExchanger</h2>
<p>
<b>Model transporting two fluid streams between four ports with storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interface997284f3a7348477angerD.png" alt="Buildings.Fluid.Interfaces.FourPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports two fluid streams between four ports.
It provides the basic model for implementing a dynamic heat exchanger.
</p>
<p>
The model can be used as-is, although there will be no heat or mass transfer
between the two fluid streams.
To add heat transfer, heat flow can be added to the heat port of the two volumes.
See for example
<a href="Buildings_Fluid_Chillers.html#Buildings.Fluid.Chillers.Carnot"
>
Buildings.Fluid.Chillers.Carnot</a>.
To add moisture input into (or moisture output from) volume <code>vol2</code>,
the model can be replaced as shown in
<a href="modelica://Buildings.Fluid.HeatExchangers.BaseClasses.HexElement">
Buildings.Fluid.HeatExchangers.BaseClasses.HexElement</a>.
</p>
<h4>Implementation</h4>
<p>
The variable names follow the conventions used in
<a href="modelica://Modelica.Fluid.HeatExchangers.BasicHX">
Modelica.Fluid.HeatExchangers.BasicHX</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a> (Parameters for flow resistance for models with four ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 2 in the component</td></tr>
<tr><td><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>MixingVolume</a></td><td>vol2</td><td>redeclare Buildings.Fluid.Mi...</td><td>Volume for fluid 2</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow.start</td><td>0</td><td>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1.start</td><td>0</td><td>Pressure difference between port_a1 and port_b1 [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow.start</td><td>0</td><td>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2.start</td><td>0</td><td>Pressure difference between port_a2 and port_b2 [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>true</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>true</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>h1_outflow_start</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>h1_outflow_start</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>h2_outflow_start</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>h2_outflow_start</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_small</td><td>1E-4*abs(m1_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_small</td><td>1E-4*abs(m2_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance1</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp1</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance1</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM1</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance2</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp2</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance2</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM2</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau1</td><td>30</td><td>Time constant at nominal flow [s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau2</td><td>30</td><td>Time constant at nominal flow [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p1_start</td><td>Medium1.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T1_start</td><td>Medium1.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X1_start[Medium1.nX]</td><td>Medium1.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C1_start[Medium1.nC]</td><td>fill(0, Medium1.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C1_nominal[Medium1.nC]</td><td>fill(1E-2, Medium1.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p2_start</td><td>Medium2.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T2_start</td><td>Medium2.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X2_start[Medium2.nX]</td><td>Medium2.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C2_start[Medium2.nC]</td><td>fill(0, Medium2.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C2_nominal[Medium2.nC]</td><td>fill(1E-2, Medium2.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> FourPortHeatMassExchanger <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Model transporting two fluid streams between four ports with storing mass or energy&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>h_outflow_a1_start = h1_outflow_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>h_outflow_b1_start = h1_outflow_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>h_outflow_a2_start = h2_outflow_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>h_outflow_b2_start = h2_outflow_start);
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a>(
     <span style="color: blue; font-weight: normal; font-style: normal;">final </span>computeFlowResistance1=true, <span style="color: blue; font-weight: normal; font-style: normal;">final </span>computeFlowResistance2=true);

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau1 = 30 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Time constant at nominal flow&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau2 = 30 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Time constant at nominal flow&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Advanced</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assumptions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> energyDynamics=Modelica.Fluid.Types.Dynamics.DynamicFreeInitial <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of energy balance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics=energyDynamics <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of mass balance&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Initialization</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium1.AbsolutePressure</a> p1_start = Medium1.p_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium1.Temperature</a> T1_start = Medium1.T_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium1.MassFraction</a> X1_start[Medium1.nX] = Medium1.X_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium1.ExtraProperty</a> C1_start[Medium1.nC](
       quantity=Medium1.extraPropertiesNames)=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(0, Medium1.nC) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of trace substances&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium1.ExtraProperty</a> C1_nominal[Medium1.nC](
       quantity=Medium1.extraPropertiesNames) =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(1E-2, Medium1.nC) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal value of trace substances. (Set to typical order of magnitude.)&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium2.AbsolutePressure</a> p2_start = Medium2.p_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium2.Temperature</a> T2_start = Medium2.T_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium2.MassFraction</a> X2_start[Medium2.nX] = Medium2.X_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium2.ExtraProperty</a> C2_start[Medium2.nC](
       quantity=Medium2.extraPropertiesNames)=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(0, Medium2.nC) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of trace substances&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium2.ExtraProperty</a> C2_nominal[Medium2.nC](
       quantity=Medium2.extraPropertiesNames) =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(1E-2, Medium2.nC) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal value of trace substances. (Set to typical order of magnitude.)&quot;</span>;

  <a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Buildings.Fluid.MixingVolumes.MixingVolume</a> vol1(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
    nPorts = 2,
    V=m1_flow_nominal*tau1/rho1_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=m1_flow_nominal,
    energyDynamics=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>tau1 &gt; Modelica.Constants.eps<span style="color: blue; font-weight: normal; font-style: normal;">
                         then </span>energyDynamics<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    massDynamics=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>tau1 &gt; Modelica.Constants.eps<span style="color: blue; font-weight: normal; font-style: normal;">
                         then </span>massDynamics<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>p_start=p1_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_start=T1_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>X_start=X1_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_start=C1_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_nominal=C1_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>mSenFac=1) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume for fluid 1&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Buildings.Fluid.MixingVolumes.MixingVolume</a> vol2
    <span style="color: blue; font-weight: normal; font-style: normal;">constrainedby </span>Buildings.Fluid.MixingVolumes.BaseClasses.PartialMixingVolume(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
    nPorts = 2,
    V=m2_flow_nominal*tau2/rho2_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>mSenFac=1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal = m2_flow_nominal,
    energyDynamics=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>tau2 &gt; Modelica.Constants.eps<span style="color: blue; font-weight: normal; font-style: normal;">
                         then </span>energyDynamics<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    massDynamics=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>tau2 &gt; Modelica.Constants.eps<span style="color: blue; font-weight: normal; font-style: normal;">
                         then </span>massDynamics<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>
                         Modelica.Fluid.Types.Dynamics.SteadyState,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>p_start=p2_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_start=T2_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>X_start=X2_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_start=C2_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_nominal=C2_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume for fluid 2&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q1_flow = vol1.heatPort.Q_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat flow rate into medium 1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q2_flow = vol2.heatPort.Q_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat flow rate into medium 2&quot;</span>;

  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro1(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>use_dh=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=m1_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>deltaM=deltaM1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal=allowFlowReversal1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>show_T=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>from_dp=from_dp1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearized=linearizeFlowResistance1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_nominal=dp1_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dh=1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>ReC=4000) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Pressure drop model for fluid 1&quot;</span>;

  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro2(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>use_dh=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=m2_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>deltaM=deltaM2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal=allowFlowReversal2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>show_T=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>from_dp=from_dp2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearized=linearizeFlowResistance2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_nominal=dp2_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dh=1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>ReC=4000) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Pressure drop model for fluid 2&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta1_nominal=<span style="color: red; font-weight: normal; font-style: normal;">Medium1.setState_pTX</span>(
      T=Medium1.T_default, p=Medium1.p_default, X=Medium1.X_default);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho1_nominal=<span style="color: red; font-weight: normal; font-style: normal;">Medium1.density</span>(sta1_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Density, used to compute fluid volume&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta2_nominal=<span style="color: red; font-weight: normal; font-style: normal;">Medium2.setState_pTX</span>(
      T=Medium2.T_default, p=Medium2.p_default, X=Medium2.X_default);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho2_nominal=<span style="color: red; font-weight: normal; font-style: normal;">Medium2.density</span>(sta2_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Density, used to compute fluid volume&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta1_start=<span style="color: red; font-weight: normal; font-style: normal;">Medium1.setState_pTX</span>(
      T=T1_start, p=p1_start, X=X1_start);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h1_outflow_start =<span style="color: red; font-weight: normal; font-style: normal;"> Medium1.specificEnthalpy</span>(sta1_start) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for outflowing enthalpy&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta2_start=<span style="color: red; font-weight: normal; font-style: normal;">Medium2.setState_pTX</span>(
      T=T2_start, p=p2_start, X=X2_start);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h2_outflow_start =<span style="color: red; font-weight: normal; font-style: normal;"> Medium2.specificEnthalpy</span>(sta2_start) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for outflowing enthalpy&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Check for tau1</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>((energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
          tau1 &gt; Modelica.Constants.eps,
&quot;The parameter tau1, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau1 = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(tau1) + &quot;\n&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>((massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
          tau1 &gt; Modelica.Constants.eps,
&quot;The parameter tau1, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau1 = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(tau1) + &quot;\n&quot;);

 <span style="color: #006400; font-weight: normal; font-style: normal;">// Check for tau2</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>((energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
          tau2 &gt; Modelica.Constants.eps,
&quot;The parameter tau2, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau2 = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(tau2) + &quot;\n&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>((massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
          tau2 &gt; Modelica.Constants.eps,
&quot;The parameter tau2, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau2 = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(tau2) + &quot;\n&quot;);
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol1.ports[2], port_b1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol2.ports[2], port_b2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_a1, preDro1.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(preDro1.port_b, vol1.ports[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_a2, preDro2.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(preDro2.port_b, vol2.ports[1]);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>FourPortHeatMassExchanger;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialFourPortInterface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface0bf626e24a9671a0rfaceI.png" alt="Buildings.Fluid.Interfaces.PartialFourPortInterface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.PartialFourPortInterface"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PartialFourPortInterface</h2>
<p>
<b>Partial model transporting fluid between two ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interface0bf626e24a9671a0rfaceD.png" alt="Buildings.Fluid.Interfaces.PartialFourPortInterface">
</p>
<h3>Information</h3>

<p>
This component defines the interface for models that
transport two fluid streams between four ports.
It is similar to
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>
Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>,
but it has four ports instead of two.
</p>
<p>
The model is used by other models in this package that add heat transfer,
mass transfer and pressure drop equations.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPort"
>Buildings.Fluid.Interfaces.FourPort</a> (Partial model with four ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 2 in the component</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>true</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>true</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_small</td><td>1E-4*abs(m1_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_small</td><td>1E-4*abs(m2_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialFourPortInterface <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model transporting fluid between two ports without storing mass or energy&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPort"
>Buildings.Fluid.Interfaces.FourPort</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m1_flow_nominal(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m2_flow_nominal(min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium1.MassFlowRate</a> m1_flow_small(min=0) = 1E-4*<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(m1_flow_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Small mass flow rate for regularization of zero flow&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium2.MassFlowRate</a> m2_flow_small(min=0) = 1E-4*<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(m2_flow_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Small mass flow rate for regularization of zero flow&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Diagnostics</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean show_T = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, if actual temperature at port is computed&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium1.MassFlowRate</a> m1_flow(start=0) = port_a1.m_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp1(start=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure difference between port_a1 and port_b1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium2.MassFlowRate</a> m2_flow(start=0) = port_a2.m_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp2(start=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure difference between port_a2 and port_b2&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta_a1=
      <span style="color: red; font-weight: normal; font-style: normal;">Medium1.setState_phX</span>(port_a1.p,
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_a1.h_outflow)),
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_a1.Xi_outflow))) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
         show_T <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium properties in port_a1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> sta_b1=
      <span style="color: red; font-weight: normal; font-style: normal;">Medium1.setState_phX</span>(port_b1.p,
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_b1.h_outflow)),
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_b1.Xi_outflow))) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
         show_T <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium properties in port_b1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta_a2=
      <span style="color: red; font-weight: normal; font-style: normal;">Medium2.setState_phX</span>(port_a2.p,
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_a2.h_outflow)),
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_a2.Xi_outflow))) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
         show_T <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium properties in port_a2&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> sta_b2=
      <span style="color: red; font-weight: normal; font-style: normal;">Medium2.setState_phX</span>(port_b2.p,
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_b2.h_outflow)),
                           <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_b2.Xi_outflow))) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
         show_T <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium properties in port_b2&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> state_a1_inflow=
    <span style="color: red; font-weight: normal; font-style: normal;">Medium1.setState_phX</span>(port_a1.p,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a1.h_outflow),<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a1.Xi_outflow)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;state for medium inflowing through port_a1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium1.ThermodynamicState</a> state_b1_inflow=
    <span style="color: red; font-weight: normal; font-style: normal;">Medium1.setState_phX</span>(port_b1.p,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b1.h_outflow),<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b1.Xi_outflow)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;state for medium inflowing through port_b1&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> state_a2_inflow=
    <span style="color: red; font-weight: normal; font-style: normal;">Medium2.setState_phX</span>(port_a2.p,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a2.h_outflow),<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a2.Xi_outflow)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;state for medium inflowing through port_a2&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium2.ThermodynamicState</a> state_b2_inflow=
    <span style="color: red; font-weight: normal; font-style: normal;">Medium2.setState_phX</span>(port_b2.p,<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b2.h_outflow),<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b2.Xi_outflow)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;state for medium inflowing through port_b2&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  dp1 = port_a1.p - port_b1.p;
  dp2 = port_a2.p - port_b2.p;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialFourPortInterface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialTwoPort<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface33181cf93d409e40oPortI.png" alt="Buildings.Fluid.Interfaces.PartialTwoPort" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.PartialTwoPort"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PartialTwoPort</h2>
<p>
<b>Partial component with two ports</b>
<br>
<br><img src="Buildings.Fluid.Interface33181cf93d409e40oPortD.png" alt="Buildings.Fluid.Interfaces.PartialTwoPort">
</p>
<h3>Information</h3>

<p>
This partial model defines an interface for components with two ports.
The treatment of the design flow direction and of flow reversal are predefined based on the parameter <code>allowFlowReversal</code>.
The component may transport fluid and may have internal storage for a given fluid <code>Medium</code>.
</p>
<p>
An extending model providing direct access to internal storage of mass or energy through <code>port_a</code> or <code>port_b</code>
should redefine the protected parameters <code>port_a_exposesState</code> and <code>port_b_exposesState</code> appropriately.
This will be visualized at the port icons, in order to improve the understanding of fluid model diagrams.
</p>
<h4>Implementation</h4>
<p>
This model is similar to
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPort"
>
Modelica.Fluid.Interfaces.PartialTwoPort</a>
but it does not use the <code>outer system</code> declaration.
This declaration is omitted as in building energy simulation,
many models use multiple media, an in practice,
users have not used this global definition to assign parameters.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium in the component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialTwoPort <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Partial component with two ports&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">import </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Constants.html#Modelica.Constants"
>Modelica.Constants</a>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
      <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium in the component&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean allowFlowReversal = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>Modelica.Fluid.Interfaces.FluidPort_a</a> port_a(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.PartialTwoPort.Medium"
>Medium</a>,
     m_flow(min=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>-Constants.inf<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fluid connector a (positive design flow direction is from port_a to port_b)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>Modelica.Fluid.Interfaces.FluidPort_b</a> port_b(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.PartialTwoPort.Medium"
>Medium</a>,
    m_flow(max=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>+Constants.inf<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fluid connector b (positive design flow direction is from port_a to port_b)&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Model structure, e.g., used for visualization</span>
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean port_a_exposesState = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true if port_a exposes the state of a fluid volume&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean port_b_exposesState = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true if port_b.p exposes the state of a fluid volume&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean showDesignFlowDirection = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= false to hide the arrow in the model icon&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialTwoPort;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialTwoPortInterface<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface33181cf93d409e40oPortI.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortInterface" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.PartialTwoPortInterface"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PartialTwoPortInterface</h2>
<p>
<b>Partial model transporting fluid between two ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interface33181cf93d409e40oPortD.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortInterface">
</p>
<h3>Information</h3>

<p>
This component defines the interface for models that
transports a fluid between two ports. It is similar to
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>
Modelica.Fluid.Interfaces.PartialTwoPortTransport</a>, but it does not
include the species balance
</p>
<pre>
  port_b.Xi_outflow = inStream(port_a.Xi_outflow);
</pre>
<p>
Thus, it can be used as a base class for a heat <i>and</i> mass transfer component
</p>
<p>
The model is used by other models in this package that add heat transfer,
mass transfer and pressure drop equations. See for example
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>
Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPort"
>Buildings.Fluid.Interfaces.PartialTwoPort</a> (Partial component with two ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialTwoPortInterface <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model transporting fluid between two ports without storing mass or energy&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPort"
>Buildings.Fluid.Interfaces.PartialTwoPort</a>(
    port_a(p(start=Medium.p_default)),
    port_b(p(start=Medium.p_default)));

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_small(min=0) = 1E-4*<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(m_flow_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Small mass flow rate for regularization of zero flow&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Diagnostics</span>
   <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean show_T = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, if actual temperature at port is computed&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow(start=0) = port_a.m_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction)&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp(start=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure difference between port_a and port_b&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_a=
      <span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_phX</span>(port_a.p,
                          <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_a.h_outflow)),
                          <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_a.Xi_outflow))) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
         show_T <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium properties in port_a&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_b=
      <span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_phX</span>(port_b.p,
                          <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_b.h_outflow)),
                          <span style="color: red; font-weight: normal; font-style: normal;">noEvent</span>(<span style="color: red; font-weight: normal; font-style: normal;">actualStream</span>(port_b.Xi_outflow))) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
          show_T <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium properties in port_b&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  dp = port_a.p - port_b.p;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialTwoPortInterface;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PartialTwoPortTransport<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface40f9c98ce4c1e214sportI.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortTransport" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.PartialTwoPortTransport"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PartialTwoPortTransport</h2>
<p>
<b>Partial element transporting fluid between two ports without storage of mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interface33181cf93d409e40oPortD.png" alt="Buildings.Fluid.Interfaces.PartialTwoPortTransport">
</p>
<h3>Information</h3>

<p>
This component transports fluid between its two ports, without storing mass or energy.
Energy may be exchanged with the environment though, e.g., in the form of work.
<code>PartialTwoPortTransport</code> is intended as base class for devices like orifices, valves and simple fluid machines.</p>
<p>
Three equations need to be added by an extending class using this component:
</p>
<ul>
<li>The momentum balance specifying the relationship between the pressure drop <code>dp</code> and the mass flow rate <code>m_flow</code>,</li>
<li><code>port_b.h_outflow</code> for flow in design direction, and</li>
<li><code>port_a.h_outflow</code> for flow in reverse direction.</li>
</ul>
<p>
Moreover appropriate values shall be assigned to the following parameters:
</p>
<ul>
<li><code>dp_start</code> for a guess of the pressure drop</li>
<li><code>m_flow_small</code> for regularization of zero flow.</li>
</ul>
<h4>Implementation</h4>
<p>
This is similar to
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>
Modelica.Fluid.Interfaces.PartialTwoPortTransport</a>
except that it does not use the <code>outer system</code> declaration.
This declaration is omitted as in building energy simulation,
many models use multiple media, an in practice,
users have not used this global definition to assign parameters.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPort"
>Buildings.Fluid.Interfaces.PartialTwoPort</a> (Partial component with two ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>dp_start</td><td>0</td><td>Guess value of dp = port_a.p - port_b.p [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_start</td><td>0</td><td>Guess value of m_flow = port_a.m_flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>&nbsp;</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>true</td><td>= true, if temperatures at port_a and port_b are computed</td></tr>
<tr><td>Boolean</td><td>show_V_flow</td><td>true</td><td>= true, if volume flow rate at inflowing port is computed</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">partial </span><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PartialTwoPortTransport <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial element transporting fluid between two ports without storage of mass or energy&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPort"
>Buildings.Fluid.Interfaces.PartialTwoPort</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>port_a_exposesState=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>port_b_exposesState=false);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Advanced</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Note: value of dp_start shall be refined by derived model,</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// based on local dp_nominal</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium.AbsolutePressure</a> dp_start = 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Guess value of dp = port_a.p - port_b.p&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</a> m_flow_start = 0 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Guess value of m_flow = port_a.m_flow&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Note: value of m_flow_small shall be refined by derived model,</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// based on local m_flow_nominal</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</a> m_flow_small <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Small mass flow rate for regularization of zero flow&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Diagnostics</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean show_T = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, if temperatures at port_a and port_b are computed&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean show_V_flow = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, if volume flow rate at inflowing port is computed&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Variables</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</a> m_flow(
     min=<span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal<span style="color: blue; font-weight: normal; font-style: normal;"> then </span>-Modelica.Constants.inf<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0,
     start = m_flow_start) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Mass flow rate in design flow direction&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp(start=dp_start) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure difference between port_a and port_b (= port_a.p - port_b.p)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>Modelica.SIunits.VolumeFlowRate</a> V_flow=
      m_flow/<span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regStep</span>(m_flow,
                  <span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(state_a),
                  <span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(state_b),
                  m_flow_small) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>show_V_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Volume flow rate at inflowing port (positive when flow from port_a to port_b)&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium.Temperature</a> port_a_T=
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regStep</span>(port_a.m_flow,
                  <span style="color: red; font-weight: normal; font-style: normal;">Medium.temperature</span>(state_a),
                  <span style="color: red; font-weight: normal; font-style: normal;">Medium.temperature</span>(<span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_phX</span>(port_a.p, port_a.h_outflow, port_a.Xi_outflow)),
                  m_flow_small) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>show_T <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature close to port_a, if show_T = true&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium.Temperature</a> port_b_T=
      <span style="color: red; font-weight: normal; font-style: normal;">Modelica.Fluid.Utilities.regStep</span>(port_b.m_flow,
                  <span style="color: red; font-weight: normal; font-style: normal;">Medium.temperature</span>(state_b),
                  <span style="color: red; font-weight: normal; font-style: normal;">Medium.temperature</span>(<span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_phX</span>(port_b.p, port_b.h_outflow, port_b.Xi_outflow)),
                  m_flow_small) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>show_T <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature close to port_b, if show_T = true&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> state_a =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.setState_phX</span>(
              port_a.p,
              <span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.h_outflow),
              <span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.Xi_outflow)) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
                 show_T<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>show_V_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;State for medium inflowing through port_a&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> state_b =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.setState_phX</span>(
              port_b.p,
              <span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_b.h_outflow),
              <span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_b.Xi_outflow)) <span style="color: blue; font-weight: normal; font-style: normal;">if </span>
                 show_T<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>show_V_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;State for medium inflowing through port_b&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Pressure drop in design flow direction</span>
  dp = port_a.p - port_b.p;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Design direction of mass flow rate</span>
  m_flow = port_a.m_flow;
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(m_flow &gt; -m_flow_small<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>allowFlowReversal,
      &quot;Reverting flow occurs even though allowFlowReversal is false&quot;);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Mass balance (no storage)</span>
  port_a.m_flow + port_b.m_flow = 0;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Transport of substances</span>
  port_a.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.Xi_outflow);
  port_b.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.Xi_outflow);

  port_a.C_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.C_outflow);
  port_b.C_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.C_outflow);

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PartialTwoPortTransport;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PrescribedOutletState<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interface50611bb4be03a719StateI.png" alt="Buildings.Fluid.Interfaces.PrescribedOutletState" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.PrescribedOutletState"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PrescribedOutletState</h2>
<p>
<b>Component that assigns the outlet fluid property at port_a based on an input signal</b>
<br>
<br><img src="Buildings.Fluid.Interface50611bb4be03a719StateD.png" alt="Buildings.Fluid.Interfaces.PrescribedOutletState">
</p>
<h3>Information</h3>

<p>
This model sets the temperature of the medium that leaves <code>port_a</code>
to the value given by the input <code>TSet</code>, subject to optional
limitations on the heating and cooling capacity.
</p>
<p>
In case of reverse flow, the set point temperature is still applied to
the fluid that leaves <code>port_b</code>.
</p>
<p>
If the parameter <code>energyDynamics</code> is not equal to
<code>Modelica.Fluid.Types.Dynamics.SteadyState</code>,
the component models the dynamic response using a first order differential equation.
The time constant of the component is equal to the parameter <code>tau</code>.
This time constant is adjusted based on the mass flow rate using
</p>
<p align="center" style="font-style:italic;">
&tau;<sub>eff</sub> = &tau; |m&#775;| &frasl; m&#775;<sub>nom</sub>
</p>
<p>
where
<i>&tau;<sub>eff</sub></i> is the effective time constant for the given mass flow rate
<i>m&#775;</i> and
<i>&tau;</i> is the time constant at the nominal mass flow rate
<i>m&#775;<sub>nom</sub></i>.
This type of dynamics is equal to the dynamics that a completely mixed
control volume would have.
</p>
<p>
This model has no pressure drop.
See <a href="Buildings_Fluid_HeatExchangers.html#Buildings.Fluid.HeatExchangers.HeaterCooler_T"
>
Buildings.Fluid.HeatExchangers.HeaterCooler_T</a>
for a model that instantiates this model and that has a pressure drop.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortTransport"
>Buildings.Fluid.Interfaces.PartialTwoPortTransport</a> (Partial element transporting fluid between two ports without storage of mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PrescribedOutletStateParameters"
>Buildings.Fluid.Interfaces.PrescribedOutletStateParameters</a> (Parameters for models with prescribed outlet state).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>HeatFlowRate</a></td><td>Q_flow_maxHeat</td><td>Modelica.Constants.inf</td><td>Maximum heat flow rate for heating (positive) [W]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>HeatFlowRate</a></td><td>Q_flow_maxCool</td><td>-Modelica.Constants.inf</td><td>Maximum heat flow rate for cooling (negative) [W]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate, used for regularization near zero flow [kg/s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>dp_start</td><td>0</td><td>Guess value of dp = port_a.p - port_b.p [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_start</td><td>0</td><td>Guess value of m_flow = port_a.m_flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>&nbsp;</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if temperatures at port_a and port_b are computed</td></tr>
<tr><td>Boolean</td><td>show_V_flow</td><td>false</td><td>= true, if volume flow rate at inflowing port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>10</td><td>Time constant at nominal flow rate (used if energyDynamics &lt;&gt; Modelica.Fluid.Types.Dynamics.SteadyState) [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Initial or guess value of set point [K]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>TSet</td><td>Set point temperature of the fluid that leaves port_b [K]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>Q_flow</td><td>Heat added to the fluid (if flow is from port_a to port_b) [W]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> PrescribedOutletState <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Component that assigns the outlet fluid property at port_a based on an input signal&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortTransport"
>Buildings.Fluid.Interfaces.PartialTwoPortTransport</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_start=0,
    show_T=false,
    show_V_flow=false);
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PrescribedOutletStateParameters"
>Buildings.Fluid.Interfaces.PrescribedOutletStateParameters</a>(
    T_start=Medium.T_default);

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> TSet(unit=&quot;K&quot;, displayUnit=&quot;degC&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set point temperature of the fluid that leaves port_b&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> Q_flow(unit=&quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat added to the fluid (if flow is from port_a to port_b)&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>Modelica.SIunits.SpecificHeatCapacity</a> cp_default=
      <span style="color: red; font-weight: normal; font-style: normal;">Medium.specificHeatCapacityCp</span>(
        <span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(
          p=Medium.p_default,
          T=Medium.T_default,
          X=Medium.X_default)) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Specific heat capacity at default medium state&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean restrictHeat = Q_flow_maxHeat &lt;&gt; Modelica.Constants.inf <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if maximum heating power is restricted&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean restrictCool = Q_flow_maxCool &lt;&gt; -Modelica.Constants.inf <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if maximum cooling power is restricted&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> deltah=
    cp_default*m_flow_small*0.01 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Small value for deltah used for regularization&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean dynamic = tau &gt; 1E-10<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>tau &lt; -1E-10 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Flag, true if the sensor is a dynamic sensor&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_pos <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Mass flow rate, or zero if reverse flow&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_limited <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Mass flow rate bounded away from zero&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> hSet <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set point for enthalpy leaving port_b&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Temperature of outlet state assuming unlimited capacity and taking dynamics into account&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> dhSetAct <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Actual enthalpy difference from port_a to port_b&quot;</span>;

  Real k(start=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Gain to take flow rate into account for sensor time constant&quot;</span>;

  Real mNor_flow <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Normalized mass flow rate&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyStateInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">  der</span>(T) = 0;
  <span style="color: blue; font-weight: normal; font-style: normal;">elseif </span>energyDynamics == Modelica.Fluid.Types.Dynamics.FixedInitial<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      T = T_start;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>energyDynamics &lt;&gt;  Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(tau &gt; 1E-5, &quot;Time constant tau is unreasonably small for dynamic balance. Check model parameters.&quot;);
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    mNor_flow = 1;
    k = 1;
    T=TSet;
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    mNor_flow = port_a.m_flow/m_flow_nominal;
    k =<span style="color: red; font-weight: normal; font-style: normal;"> Modelica.Fluid.Utilities.regStep</span>(x=port_a.m_flow,
                                         y1= mNor_flow,
                                         y2=-mNor_flow,
                                         x_small=m_flow_small);
    <span style="color: red; font-weight: normal; font-style: normal;">der</span>(T) = (TSet-T)*k/tau;
  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Set point for outlet enthalpy without any capacity limitation</span>
  hSet =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.specificEnthalpy</span>(
    <span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(
      p=  port_a.p,
      T=  T,
      X=<span style="color: red; font-weight: normal; font-style: normal;">  inStream</span>(port_a.Xi_outflow)));

  m_flow_pos =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.smoothMax</span>(
    x1=m_flow,
    x2=0,
    deltaX=m_flow_small);
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Compute how much dH may need to be reduced.</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>restrictHeat<span style="color: blue; font-weight: normal; font-style: normal;"> and </span><span style="color: blue; font-weight: normal; font-style: normal;">not </span>restrictCool<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// No capacity limit</span>
    dhSetAct = 0;
    port_b.h_outflow = hSet;
    m_flow_limited = 0;
    Q_flow = m_flow_pos*(hSet-<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.h_outflow));
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>

    m_flow_limited =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.smoothMax</span>(
      x1=  port_a.m_flow,
      x2=  m_flow_small,
      deltaX=m_flow_small/2);

    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>restrictHeat<span style="color: blue; font-weight: normal; font-style: normal;"> and </span>restrictCool<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: #006400; font-weight: normal; font-style: normal;">// Capacity limits for heating and cooling</span>
      dhSetAct =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.smoothLimit</span>(
        x=hSet-<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.h_outflow),
        l=Q_flow_maxCool / m_flow_limited,
        u=Q_flow_maxHeat / m_flow_limited,
        deltaX=deltah);
    <span style="color: blue; font-weight: normal; font-style: normal;">elseif </span>restrictHeat<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      <span style="color: #006400; font-weight: normal; font-style: normal;">// Capacity limit for heating only</span>
      dhSetAct =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.smoothMin</span>(
        x1=hSet-<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.h_outflow),
        x2=Q_flow_maxHeat / m_flow_limited,
        deltaX=deltah);
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      <span style="color: #006400; font-weight: normal; font-style: normal;">// Capacity limit for cooling only</span>
      dhSetAct =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.smoothMax</span>(
        x1=hSet-<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.h_outflow),
        x2=Q_flow_maxCool / m_flow_limited,
        deltaX=deltah);
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

    port_b.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.h_outflow) + dhSetAct;
    Q_flow = m_flow_pos*dhSetAct;

  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Outflowing property at port_a is unaffected by this model.</span>
  port_a.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.h_outflow);

  <span style="color: #006400; font-weight: normal; font-style: normal;">// No pressure drop</span>
  dp = 0;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PrescribedOutletState;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE StaticFourPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfacecfb0ac59541ba4f9angerI.png" alt="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.StaticFourPortHeatMassExchanger</h2>
<p>
<b>Partial model transporting two fluid streams between four ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interfacecfb0ac59541ba4f9angerD.png" alt="Buildings.Fluid.Interfaces.StaticFourPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports two fluid streams between four ports, without
storing mass or energy. It is similar to
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>
Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a>,
but it has four ports instead of two.
</p>
<p>
If <code>dp<i>N</i>_nominal &gt; Modelica.Constants.eps</code>,
where <code><i>N</i></code> denotes the fluid <i>1</i> or <i>2</i>,
then the model computes
pressure drop due to flow friction in the respective fluid stream.
The pressure drop is defined by a quadratic function that goes through
the point <code>(m<i>N</i>_flow_nominal, dp<i>N</i>_nominal)</code>.
At <code>|m<i>N</i>_flow| &lt; deltaM<i>N</i> * m<i>N</i>_flow_nominal</code>,
the pressure drop vs. flow relation is linearized.
If the parameter <code>linearizeFlowResistance<i>N</i></code> is set to true,
then the whole pressure drop vs. flow resistance curve is linearized.
</p>

<h4>Implementation</h4>
<p>
This model uses inputs and constants that need to be set by models
that extend or instantiate this model.
The following inputs need to be assigned, where <code><i>N</i></code> denotes <code>1</code> or
<code>2</code>:</p>
<ul>
<li>
<code>Q<i>N</i>_flow</code>, which is the heat flow rate added to the medium <i>N</i>.
</li>
<li>
<code>mWat<i>N</i>_flow</code>, which is the moisture mass flow rate added to the medium <i>N</i>.
</li>
</ul>
<p>
Set the constant <code>sensibleOnly<i>N</i>=true</code> if the model that extends
or instantiates this model sets <code>mWat<i>N</i>_flow = 0</code>.
</p>
<p>
     Note that the model does not implement <code>0 = Q1_flow + Q2_flow</code> or
     <code>0 = mXi1_flow + mXi2_flow</code>. If there is no heat or mass transfer
     with the environment, then a model that extends this model needs to provide these
     equations.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a> (Parameters for flow resistance for models with four ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium1</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 1 in the component</td></tr>
<tr><td colspan="2">replaceable package Medium2</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium 2 in the component</td></tr>
<tr><td>Boolean</td><td>sensibleOnly1</td><td>&nbsp;</td><td>Set to true if sensible exchange only for medium 1</td></tr>
<tr><td>Boolean</td><td>sensibleOnly2</td><td>&nbsp;</td><td>Set to true if sensible exchange only for medium 2</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow.start</td><td>0</td><td>Mass flow rate from port_a1 to port_b1 (m1_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1.start</td><td>0</td><td>Pressure difference between port_a1 and port_b1 [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow.start</td><td>0</td><td>Mass flow rate from port_a2 to port_b2 (m2_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2.start</td><td>0</td><td>Pressure difference between port_a2 and port_b2 [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal1</td><td>true</td><td>= true to allow flow reversal in medium 1, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr><td>Boolean</td><td>allowFlowReversal2</td><td>true</td><td>= true to allow flow reversal in medium 2, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port a1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b1_start</td><td>Medium1.h_default</td><td>Start value for enthalpy flowing out of port b1 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_a2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port a2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</a></td><td>h_outflow_b2_start</td><td>Medium2.h_default</td><td>Start value for enthalpy flowing out of port b2 [J/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m1_flow_small</td><td>1E-4*abs(m1_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</a></td><td>m2_flow_small</td><td>1E-4*abs(m2_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance1</td><td>(dp1_nominal &gt; Modelica.Cons...</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp1</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance1</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM1</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance2</td><td>(dp2_nominal &gt; Modelica.Cons...</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp2</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance2</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM2</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a1</td><td>Fluid connector a1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b1</td><td>Fluid connector b1 (positive design flow direction is from port_a1 to port_b1)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a2</td><td>Fluid connector a2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b2</td><td>Fluid connector b2 (positive design flow direction is from port_a2 to port_b2)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> StaticFourPortHeatMassExchanger <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model transporting two fluid streams between four ports without storing mass or energy&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>Buildings.Fluid.Interfaces.PartialFourPortInterface</a>;
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters</a>(
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>computeFlowResistance1=(dp1_nominal &gt; Modelica.Constants.eps),
   <span style="color: blue; font-weight: normal; font-style: normal;">final </span>computeFlowResistance2=(dp2_nominal &gt; Modelica.Constants.eps));

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q1_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat transferred into the medium 1&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium1.MassFlowRate</a> mWat1_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Moisture mass flow rate added to the medium 1&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q2_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Heat transferred into the medium 2&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium2.MassFlowRate</a> mWat2_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Moisture mass flow rate added to the medium 2&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Boolean sensibleOnly1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if sensible exchange only for medium 1&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Boolean sensibleOnly2 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true if sensible exchange only for medium 2&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a> bal1(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>sensibleOnly = sensibleOnly1,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium=<a href="Buildings_Fluid_Interfaces_Medium1.html#Buildings.Fluid.Interfaces.FourPort.Medium1"
>Medium1</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal = m1_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_nominal = dp1_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal = allowFlowReversal1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_small = m1_flow_small,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization = homotopyInitialization,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>from_dp = from_dp1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearizeFlowResistance = linearizeFlowResistance1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>deltaM = deltaM1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>Q_flow = Q1_flow,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>mWat_flow = mWat1_flow) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Model for heat, mass, species, trace substance and pressure balance of stream 1&quot;</span>;
  <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"
>Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger</a> bal2(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>sensibleOnly = sensibleOnly2,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium=<a href="Buildings_Fluid_Interfaces_Medium2.html#Buildings.Fluid.Interfaces.FourPort.Medium2"
>Medium2</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal = m2_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_nominal = dp2_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal = allowFlowReversal2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_small = m2_flow_small,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization = homotopyInitialization,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>from_dp = from_dp2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearizeFlowResistance = linearizeFlowResistance2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>deltaM = deltaM2,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>Q_flow = Q2_flow,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>mWat_flow = mWat2_flow) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Model for heat, mass, species, trace substance and pressure balance of stream 2&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bal1.port_a, port_a1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bal1.port_b, port_b1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bal2.port_a, port_a2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(bal2.port_b, port_b2);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>StaticFourPortHeatMassExchanger;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE StaticTwoPortConservationEquation<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfacea868bbaf7da4f56dationI.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.StaticTwoPortConservationEquation</h2>
<p>
<b>Partial model for static energy and mass conservation equations</b>
<br>
<br><img src="Buildings.Fluid.Interfacea868bbaf7da4f56dationD.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation">
</p>
<h3>Information</h3>

<p>
This model transports fluid between its two ports, without storing mass or energy.
It implements a steady-state conservation equation for energy and mass fractions.
The model has zero pressure drop between its ports.
</p>
<h4>Implementation</h4>
Input connectors of the model are
<ul>
<li>
<code>Q_flow</code>, which is the sensible plus latent heat flow rate added to the medium, and
</li>
<li>
<code>mWat_flow</code>, which is the moisture mass flow rate added to the medium.
</li>
</ul>

<p>
The model can only be used as a steady-state model with two fluid ports.
For a model with a dynamic balance, and more fluid ports, use
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.ConservationEquation"
>
Buildings.Fluid.Interfaces.ConservationEquation</a>.
</p>
<p>
Set the constant <code>sensibleOnly=true</code> if the model that extends
or instantiates this model sets <code>mWat_flow = 0</code>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Boolean</td><td>sensibleOnly</td><td>&nbsp;</td><td>Set to true if sensible exchange only</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>Q_flow</td><td>Sensible plus latent heat flow rate transferred into the medium [W]</td></tr>
<tr><td>input <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</a></td><td>mWat_flow</td><td>Moisture mass flow rate added to the medium [kg/s]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>hOut</td><td>Leaving specific enthalpy of the component [J/kg]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>XiOut[Medium.nXi]</td><td>Leaving species concentration of the component [1]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>COut[Medium.nC]</td><td>Leaving trace substances of the component</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> StaticTwoPortConservationEquation <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model for static energy and mass conservation equations&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>(
  showDesignFlowDirection = false);

  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Boolean sensibleOnly <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Set to true if sensible exchange only&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> Q_flow(unit=&quot;W&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Sensible plus latent heat flow rate transferred into the medium&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</a> mWat_flow(unit=&quot;kg/s&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Moisture mass flow rate added to the medium&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Outputs that are needed in models that extend this model</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> hOut(unit=&quot;J/kg&quot;,
                                             start=<span style="color: red; font-weight: normal; font-style: normal;">Medium.specificEnthalpy_pTX</span>(
                                                     p=Medium.p_default,
                                                     T=Medium.T_default,
                                                     X=Medium.X_default)) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving specific enthalpy of the component&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> XiOut[Medium.nXi](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;1&quot;,
                                                          <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0,
                                                          <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving species concentration of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> COut[Medium.nC](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving trace substances of the component&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Boolean use_safeDivision=true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to improve numerical robustness&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  Real m_flowInv(unit=&quot;s/kg&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Regularization of 1/m_flow&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mXi_flow[Medium.nXi] <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Mass flow rates of independent substances added to the medium&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Parameters that is used to construct the vector mXi_flow</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real s[Medium.nXi] = {<span style="color: blue; font-weight: normal; font-style: normal;">if </span><span style="color: red; font-weight: normal; font-style: normal;">Modelica.Utilities.Strings.isEqual</span>(string1=Medium.substanceNames[i],
                                            string2=&quot;Water&quot;,
                                            caseSensitive=false)<span style="color: blue; font-weight: normal; font-style: normal;">
                                            then </span>1<span style="color: blue; font-weight: normal; font-style: normal;"> else </span>0 <span style="color: blue; font-weight: normal; font-style: normal;">for </span>i<span style="color: blue; font-weight: normal; font-style: normal;"> in </span>1:Medium.nXi} <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Vector with zero everywhere except where species is&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assert that the substance with name &#39;water&#39; has been found.</span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>(Medium.nXi == 0<span style="color: blue; font-weight: normal; font-style: normal;"> or </span><span style="color: red; font-weight: normal; font-style: normal;">abs</span>(<span style="color: red; font-weight: normal; font-style: normal;">sum</span>(s)-1) &lt; 1e-5,
      &quot;If Medium.nXi &gt; 1, then substance &#39;water&#39; must be present for one component.&#39;&quot;
         + Medium.mediumName + &quot;&#39;.\n&quot;
         + &quot;Check medium model.&quot;);

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
 <span style="color: #006400; font-weight: normal; font-style: normal;">// Species flow rate from connector mWat_flow</span>
 mXi_flow = mWat_flow * s;
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Regularization of m_flow around the origin to avoid a division by zero</span>
 <span style="color: blue; font-weight: normal; font-style: normal;">if </span>use_safeDivision<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    m_flowInv =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.inverseXRegularized</span>(x=port_a.m_flow, delta=m_flow_small/1E3);
 <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
     m_flowInv = 0;<span style="color: #006400; font-weight: normal; font-style: normal;"> // m_flowInv is not used if use_safeDivision = false.</span>
 <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

 <span style="color: blue; font-weight: normal; font-style: normal;">if </span>allowFlowReversal<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
   <span style="color: #006400; font-weight: normal; font-style: normal;">// Formulate hOut using spliceFunction. This avoids an event iteration.</span>
   <span style="color: #006400; font-weight: normal; font-style: normal;">// The introduced error is small because deltax=m_flow_small/1e3</span>
   hOut =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.spliceFunction</span>(pos=port_b.h_outflow,
                                                            neg=port_a.h_outflow,
                                                            x=port_a.m_flow,
                                                            deltax=m_flow_small/1E3);
   XiOut =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.spliceFunction</span>(pos=port_b.Xi_outflow,
                                                            neg=port_a.Xi_outflow,
                                                            x=port_a.m_flow,
                                                            deltax=m_flow_small/1E3);
   COut =<span style="color: red; font-weight: normal; font-style: normal;"> Buildings.Utilities.Math.Functions.spliceFunction</span>(pos=port_b.C_outflow,
                                                            neg=port_a.C_outflow,
                                                            x=port_a.m_flow,
                                                            deltax=m_flow_small/1E3);
 <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
   hOut =  port_b.h_outflow;
   XiOut = port_b.Xi_outflow;
   COut =  port_b.C_outflow;
 <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">//////////////////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// Energy balance and mass balance</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">if </span>sensibleOnly<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Mass balance</span>
    port_a.m_flow = -port_b.m_flow;
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Energy balance</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>use_safeDivision<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      port_b.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.h_outflow) + Q_flow * m_flowInv;
      port_a.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.h_outflow) - Q_flow * m_flowInv;
    <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      port_a.m_flow * (<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.h_outflow) - port_b.h_outflow) = -Q_flow;
      port_a.m_flow * (<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_b.h_outflow) - port_a.h_outflow) = +Q_flow;
    <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Transport of species</span>
    port_a.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.Xi_outflow);
    port_b.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.Xi_outflow);
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Transport of trace substances</span>
    port_a.C_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.C_outflow);
    port_b.C_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.C_outflow);
  <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Mass balance (no storage)</span>
    port_a.m_flow + port_b.m_flow = -mWat_flow;
    <span style="color: #006400; font-weight: normal; font-style: normal;">// Energy balance.</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// This equation is approximate since m_flow = port_a.m_flow is used for the mass flow rate</span>
    <span style="color: #006400; font-weight: normal; font-style: normal;">// at both ports. Since mWat_flow &lt;&lt; m_flow, the error is small.</span>
    <span style="color: blue; font-weight: normal; font-style: normal;">if </span>use_safeDivision<span style="color: blue; font-weight: normal; font-style: normal;"> then</span>
      port_b.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.h_outflow) + Q_flow * m_flowInv;
      port_a.h_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.h_outflow) - Q_flow * m_flowInv;
      <span style="color: #006400; font-weight: normal; font-style: normal;">// Transport of species</span>
      port_b.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_a.Xi_outflow) + mXi_flow * m_flowInv;
      port_a.Xi_outflow =<span style="color: red; font-weight: normal; font-style: normal;"> inStream</span>(port_b.Xi_outflow) - mXi_flow * m_flowInv;
     <span style="color: blue; font-weight: normal; font-style: normal;">else</span>
      port_a.m_flow * (<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.h_outflow) - port_b.h_outflow) = -Q_flow;
      port_a.m_flow * (<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_b.h_outflow) - port_a.h_outflow) = +Q_flow;
      <span style="color: #006400; font-weight: normal; font-style: normal;">// Transport of species</span>
      port_a.m_flow * (<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.Xi_outflow) - port_b.Xi_outflow) = -mXi_flow;
      port_a.m_flow * (<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_b.Xi_outflow) - port_a.Xi_outflow) = +mXi_flow;
     <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;

    <span style="color: #006400; font-weight: normal; font-style: normal;">// Transport of trace substances</span>
   port_a.m_flow*port_a.C_outflow = -port_b.m_flow*<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_b.C_outflow);
   port_b.m_flow*port_b.C_outflow = -port_a.m_flow*<span style="color: red; font-weight: normal; font-style: normal;">inStream</span>(port_a.C_outflow);

  <span style="color: blue; font-weight: normal; font-style: normal;">end if</span>;<span style="color: #006400; font-weight: normal; font-style: normal;"> // sensibleOnly</span>

  <span style="color: #006400; font-weight: normal; font-style: normal;">//////////////////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">// No pressure drop in this model</span>
  port_a.p = port_b.p;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>StaticTwoPortConservationEquation;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE StaticTwoPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfacee19327459e14118bangerI.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.StaticTwoPortHeatMassExchanger</h2>
<p>
<b>Partial model transporting fluid between two ports without storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interfacee19327459e14118bangerD.png" alt="Buildings.Fluid.Interfaces.StaticTwoPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports fluid between its two ports, without
storing mass or energy. It is based on
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>
Modelica.Fluid.Interfaces.PartialTwoPortTransport</a> but it does
use a different implementation for handling reverse flow because
in this component, mass flow rate can be added or removed from
the medium.
</p>
<p>
If <code>dp_nominal &gt; Modelica.Constants.eps</code>, this component computes
pressure drop due to flow friction.
The pressure drop is defined by a quadratic function that goes through
the point <code>(m_flow_nominal, dp_nominal)</code>. At <code>|m_flow| &lt; deltaM * m_flow_nominal</code>,
the pressure drop vs. flow relation is linearized.
If the parameter <code>linearizeFlowResistance</code> is set to true,
then the whole pressure drop vs. flow resistance curve is linearized.
</p>
<h4>Implementation</h4>
This model uses inputs and constants that need to be set by models
that extend or instantiate this model.
The following inputs need to be assigned:
<ul>
<li>
<code>Q_flow</code>, which is the heat flow rate added to the medium.
</li>
<li>
<code>mWat_flow</code>, which is the moisture mass flow rate added to the medium.
</li>
</ul>

<p>
Set the constant <code>sensibleOnly=true</code> if the model that extends
or instantiates this model sets <code>mWat_flow = 0</code>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a> (Parameters for flow resistance for models with two ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td>Boolean</td><td>sensibleOnly</td><td>&nbsp;</td><td>Set to true if sensible exchange only</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr><td>Boolean</td><td>computeFlowResistance</td><td>(abs(dp_nominal) &gt; Modelica....</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</a></td><td>port_a</td><td>Fluid connector a (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</a></td><td>port_b</td><td>Fluid connector b (positive design flow direction is from port_a to port_b)</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>hOut</td><td>Leaving temperature of the component [J/kg]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>XiOut[Medium.nXi]</td><td>Leaving species concentration of the component [1]</td></tr>
<tr><td>output <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</a></td><td>COut[Medium.nC]</td><td>Leaving trace substances of the component</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> StaticTwoPortHeatMassExchanger <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model transporting fluid between two ports without storing mass or energy&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>(
  showDesignFlowDirection = false);
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>computeFlowResistance=(<span style="color: red; font-weight: normal; font-style: normal;">abs</span>(dp_nominal) &gt; Modelica.Constants.eps));

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Model inputs</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Heat transferred into the medium&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">input </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> mWat_flow <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Moisture mass flow rate added to the medium&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Models for conservation equations and pressure drop</span>
  <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation"
>Buildings.Fluid.Interfaces.StaticTwoPortConservationEquation</a> vol(
    sensibleOnly = sensibleOnly,
    use_safeDivision = use_safeDivision,
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.PartialTwoPort.Medium"
>Medium</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal = m_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal=allowFlowReversal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_small=m_flow_small) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Control volume for steady-state energy and mass balance&quot;</span>;
  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.PartialTwoPort.Medium"
>Medium</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>use_dh=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=m_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>deltaM=deltaM,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal=allowFlowReversal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>show_T=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>from_dp=from_dp,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearized=linearizeFlowResistance,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_nominal=dp_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Pressure drop model&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Outputs that are needed in models that extend this model</span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> hOut(unit=&quot;J/kg&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving temperature of the component&quot;</span>;

  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> XiOut[Medium.nXi](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>unit=&quot;1&quot;,
                                                          <span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0,
                                                          <span style="color: blue; font-weight: normal; font-style: normal;">each </span>max=1) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving species concentration of the component&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</a> COut[Medium.nC](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>min=0) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Leaving trace substances of the component&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Boolean sensibleOnly <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Set to true if sensible exchange only&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">constant </span>Boolean use_safeDivision=true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Set to true to improve numerical robustness&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a> heaInp(y=Q_flow) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Block to set heat input into volume&quot;</span>;
  <a href="../../msl/Modelica%203.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.RealExpression"
>Modelica.Blocks.Sources.RealExpression</a>
    masExc(<span style="color: blue; font-weight: normal; font-style: normal;">final </span>y=mWat_flow) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Block to set moisture exchange in volume&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol.hOut, hOut);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol.XiOut, XiOut);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol.COut, COut);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_a,preDro. port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(preDro.port_b, vol.port_a);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol.port_b, port_b);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(heaInp.y, vol.Q_flow);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(masExc.y, vol.mWat_flow);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>StaticTwoPortHeatMassExchanger;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoPortHeatMassExchanger<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Buildings.Fluid.Interfaceaa717523098d688cangerI.png" alt="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger" align="right" style="border: 1px solid" width="80" height="80">
<a name="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.TwoPortHeatMassExchanger</h2>
<p>
<b>Partial model transporting one fluid stream with storing mass or energy</b>
<br>
<br><img src="Buildings.Fluid.Interfaceaa717523098d688cangerD.png" alt="Buildings.Fluid.Interfaces.TwoPortHeatMassExchanger">
</p>
<h3>Information</h3>

<p>
This component transports one fluid stream.
It provides the basic model for implementing dynamic and steady-state
models that exchange heat and water vapor with the fluid stream.
The model also computes the pressure drop due to the flow resistance.
By setting the parameter <code>dp_nominal=0</code>, the computation
of the pressure drop can be avoided.
The variable <code>vol.heatPort.T</code> always has the value of
the temperature of the medium that leaves the component.
For the actual temperatures at the port, the variables <code>sta_a.T</code>
and <code>sta_b.T</code> can be used. These two variables are provided by
the base class
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>
Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>.
</p>

For models that extend this model, see for example
<ul>
<li>
the ideal heater or cooler
<a href="Buildings_Fluid_HeatExchangers.html#Buildings.Fluid.HeatExchangers.HeaterCooler_u"
>
Buildings.Fluid.HeatExchangers.HeaterCooler_u</a>, and
</li>
<li>
the ideal humidifier
<a href="Buildings_Fluid_MassExchangers.html#Buildings.Fluid.MassExchangers.Humidifier_u"
>
Buildings.Fluid.MassExchangers.Humidifier_u</a>.
</li>
</ul>

<h4>Implementation</h4>
<p>
The variable names follow the conventions used in
<a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Examples_HeatExchanger_BaseClasses.html#Modelica.Fluid.Examples.HeatExchanger.BaseClasses.BasicHX"
>
Modelica.Fluid.Examples.HeatExchanger.BaseClasses.BasicHX
</a>.
</p>

<p>Extends from <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a> (Partial model transporting fluid between two ports without storing mass or energy), <a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a> (Parameters for flow resistance for models with two ports).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</a></td><td>Medium in the component</td></tr>
<tr><td><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>MixingVolume</a></td><td>vol</td><td>redeclare Buildings.Fluid.Mi...</td><td>Volume for fluid stream</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow.start</td><td>0</td><td>Mass flow rate from port_a to port_b (m_flow &gt; 0 is design flow direction) [kg/s]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp.start</td><td>0</td><td>Pressure difference between port_a and port_b [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Assumptions</b></td></tr>
<tr><td>Boolean</td><td>allowFlowReversal</td><td>true</td><td>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Advanced</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_small</td><td>1E-4*abs(m_flow_nominal)</td><td>Small mass flow rate for regularization of zero flow [kg/s]</td></tr>
<tr><td>Boolean</td><td>homotopyInitialization</td><td>true</td><td>= true, use homotopy method</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Diagnostics</td></tr>
<tr><td>Boolean</td><td>show_T</td><td>false</td><td>= true, if actual temperature at port is computed</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr><td>Boolean</td><td>computeFlowResistance</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>30</td><td>Time constant at nominal flow (if energyDynamics &lt;&gt; SteadyState) [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> TwoPortHeatMassExchanger <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Partial model transporting one fluid stream with storing mass or energy&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>Buildings.Fluid.Interfaces.PartialTwoPortInterface</a>(
    port_a(h_outflow(start=h_outflow_start)),
    port_b(h_outflow(start=h_outflow_start)));
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"
>Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters</a>(
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>computeFlowResistance=true);

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau = 30 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Time constant at nominal flow (if energyDynamics &lt;&gt; SteadyState)&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Advanced</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean homotopyInitialization = true <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;= true, use homotopy method&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Dynamics</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> energyDynamics=Modelica.Fluid.Types.Dynamics.DynamicFreeInitial <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of energy balance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics=energyDynamics <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of mass balance&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Initialization</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium.AbsolutePressure</a> p_start = Medium.p_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium.Temperature</a> T_start = Medium.T_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium.MassFraction</a> X_start[Medium.nX] = Medium.X_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C_start[Medium.nC](
       quantity=Medium.extraPropertiesNames)=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(0, Medium.nC) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of trace substances&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>Buildings.Fluid.MixingVolumes.MixingVolume</a> vol
  <span style="color: blue; font-weight: normal; font-style: normal;">constrainedby </span>Buildings.Fluid.MixingVolumes.BaseClasses.PartialMixingVolume(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.PartialTwoPort.Medium"
>Medium</a>,
    nPorts = 2,
    V=m_flow_nominal*tau/rho_default,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>mSenFac=1,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal = m_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>energyDynamics=energyDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>massDynamics=massDynamics,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>p_start=p_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>T_start=T_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>X_start=X_start,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>C_start=C_start) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Volume for fluid stream&quot;</span>;

  <a href="Buildings_Fluid_FixedResistances.html#Buildings.Fluid.FixedResistances.FixedResistanceDpM"
>Buildings.Fluid.FixedResistances.FixedResistanceDpM</a> preDro(
    <span style="color: blue; font-weight: normal; font-style: normal;">redeclare </span><span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium = <a href="Buildings_Fluid_Interfaces_Medium.html#Buildings.Fluid.Interfaces.PartialTwoPort.Medium"
>Medium</a>,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>use_dh=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>m_flow_nominal=m_flow_nominal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>deltaM=deltaM,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>allowFlowReversal=allowFlowReversal,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>show_T=false,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>from_dp=from_dp,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>linearized=linearizeFlowResistance,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>homotopyInitialization=homotopyInitialization,
    <span style="color: blue; font-weight: normal; font-style: normal;">final </span>dp_nominal=dp_nominal) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Pressure drop model&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">protected </span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_default=<span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(
      T=Medium.T_default, p=Medium.p_default, X=Medium.X_default);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Density"
>Modelica.SIunits.Density</a> rho_default=<span style="color: red; font-weight: normal; font-style: normal;">Medium.density</span>(sta_default) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Density, used to compute fluid volume&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermodynamicState"
>Medium.ThermodynamicState</a> sta_start=<span style="color: red; font-weight: normal; font-style: normal;">Medium.setState_pTX</span>(
      T=T_start, p=p_start, X=X_start);
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>Modelica.SIunits.SpecificEnthalpy</a> h_outflow_start =<span style="color: red; font-weight: normal; font-style: normal;"> Medium.specificEnthalpy</span>(sta_start) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value for outflowing enthalpy&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">initial </span><span style="color: blue; font-weight: normal; font-style: normal;">algorithm </span>
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>((energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
          tau &gt; Modelica.Constants.eps,
&quot;The parameter tau, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set energyDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(tau) + &quot;\n&quot;);
  <span style="color: red; font-weight: normal; font-style: normal;">assert</span>((massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState)<span style="color: blue; font-weight: normal; font-style: normal;"> or </span>
          tau &gt; Modelica.Constants.eps,
&quot;The parameter tau, or the volume of the model from which tau may be derived, is unreasonably small.
 You need to set massDynamics == Modelica.Fluid.Types.Dynamics.SteadyState to model steady-state.
 Received tau = &quot; +<span style="color: red; font-weight: normal; font-style: normal;"> String</span>(tau) + &quot;\n&quot;);

<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(vol.ports[2], port_b);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(port_a, preDro.port_a);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(preDro.port_b, vol.ports[1]);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>TwoPortHeatMassExchanger;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE FourPortFlowResistanceParameters<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces.FourPortFlowResistanceParameters"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.FourPortFlowResistanceParameters</h2>
<p>
<b>Parameters for flow resistance for models with four ports</b>
</p>
<h3>Information</h3>

This class contains parameters that are used to
compute the pressure drop in components that have two fluid streams.
Note that the nominal mass flow rate is not declared here because
the model
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialFourPortInterface"
>
PartialFourPortInterface</a>
already declares it.

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp1_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp2_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 1</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance1</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp1</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance1</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM1</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Medium 2</td></tr>
<tr><td>Boolean</td><td>computeFlowResistance2</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp2</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance2</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM2</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> FourPortFlowResistanceParameters <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Parameters for flow resistance for models with four ports&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean computeFlowResistance1 = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=true, compute flow resistance. Set to false to assume no friction&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean from_dp1 = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp1_nominal(min=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure difference&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean linearizeFlowResistance1 = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real deltaM1 = 0.1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of nominal flow rate where flow transitions to laminar&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean computeFlowResistance2 = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=true, compute flow resistance. Set to false to assume no friction&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean from_dp2 = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp2_nominal(min=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure difference&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean linearizeFlowResistance2 = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real deltaM2 = 0.1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of nominal flow rate where flow transitions to laminar&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>FourPortFlowResistanceParameters;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE LumpedVolumeDeclarations<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces.LumpedVolumeDeclarations"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.LumpedVolumeDeclarations</h2>
<p>
<b>Declarations for lumped volumes</b>
</p>
<h3>Information</h3>

<p>
This class contains parameters and medium properties
that are used in the lumped  volume model, and in models that extend the
lumped volume model.
</p>
<p>
These parameters are used by
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.ConservationEquation"
>
Buildings.Fluid.Interfaces.ConservationEquation</a>,
<a href="Buildings_Fluid_MixingVolumes.html#Buildings.Fluid.MixingVolumes.MixingVolume"
>
Buildings.Fluid.MixingVolumes.MixingVolume</a>,
<a href="Buildings_Rooms.html#Buildings.Rooms.MixedAir"
>
Buildings.Rooms.MixedAir</a>, and by
<a href="modelica://Buildings.Rooms.BaseClasses.MixedAir">
Buildings.Rooms.BaseClasses.MixedAir</a>.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td colspan="2">replaceable package Medium</td><td>Modelica.Media.Interfaces.Pa...</td><td>Medium in the component</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>massDynamics</td><td>energyDynamics</td><td>Formulation of mass balance</td></tr>
<tr><td>Real</td><td>mSenFac</td><td>1</td><td>Factor for scaling the sensible thermal mass of the volume</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Initialization</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>AbsolutePressure</a></td><td>p_start</td><td>Medium.p_default</td><td>Start value of pressure [Pa]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Temperature</a></td><td>T_start</td><td>Medium.T_default</td><td>Start value of temperature [K]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>MassFraction</a></td><td>X_start[Medium.nX]</td><td>Medium.X_default</td><td>Start value of mass fractions m_i/m [kg/kg]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_start[Medium.nC]</td><td>fill(0, Medium.nC)</td><td>Start value of trace substances</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>ExtraProperty</a></td><td>C_nominal[Medium.nC]</td><td>fill(1E-2, Medium.nC)</td><td>Nominal value of trace substances. (Set to typical order of magnitude.)</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> LumpedVolumeDeclarations <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Declarations for lumped volumes&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">replaceable </span><span style="color: blue; font-weight: normal; font-style: normal;">package</span> Medium =
    <a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</a> <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Medium in the component&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Assumptions</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> energyDynamics=Modelica.Fluid.Types.Dynamics.DynamicFreeInitial <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of energy balance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> massDynamics=energyDynamics <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of mass balance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> substanceDynamics=energyDynamics <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of substance balance&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">final </span><span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> traceDynamics=energyDynamics <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of trace substance balance&quot;</span>;

  <span style="color: #006400; font-weight: normal; font-style: normal;">// Initialization</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.AbsolutePressure"
>Medium.AbsolutePressure</a> p_start = Medium.p_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of pressure&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.Temperature"
>Medium.Temperature</a> T_start=Medium.T_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of temperature&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.MassFraction"
>Medium.MassFraction</a> X_start[Medium.nX] = Medium.X_default <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of mass fractions m_i/m&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C_start[Medium.nC](
       quantity=Medium.extraPropertiesNames)=<span style="color: red; font-weight: normal; font-style: normal;">fill</span>(0, Medium.nC) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Start value of trace substances&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Media_Interfaces_Types.html#Modelica.Media.Interfaces.Types.ExtraProperty"
>Medium.ExtraProperty</a> C_nominal[Medium.nC](
       quantity=Medium.extraPropertiesNames) =<span style="color: red; font-weight: normal; font-style: normal;"> fill</span>(1E-2, Medium.nC) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal value of trace substances. (Set to typical order of magnitude.)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real mSenFac(min=1)=1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Factor for scaling the sensible thermal mass of the volume&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>LumpedVolumeDeclarations;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE PrescribedOutletStateParameters<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces.PrescribedOutletStateParameters"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.PrescribedOutletStateParameters</h2>
<p>
<b>Parameters for models with prescribed outlet state</b>
</p>
<h3>Information</h3>

<p>
This record declares parameters that are used by models with
prescribed outlet temperature.
</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>HeatFlowRate</a></td><td>Q_flow_maxHeat</td><td>Modelica.Constants.inf</td><td>Maximum heat flow rate for heating (positive) [W]</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>HeatFlowRate</a></td><td>Q_flow_maxCool</td><td>-Modelica.Constants.inf</td><td>Maximum heat flow rate for cooling (negative) [W]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</a></td><td>m_flow_nominal</td><td>&nbsp;</td><td>Nominal mass flow rate, used for regularization near zero flow [kg/s]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Dynamics</b></td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</a></td><td>tau</td><td>10</td><td>Time constant at nominal flow rate (used if energyDynamics &lt;&gt; Modelica.Fluid.Types.Dynamics.SteadyState) [s]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Initialization</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</a></td><td>T_start</td><td>&nbsp;</td><td>Initial or guess value of set point [K]</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equations</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</a></td><td>energyDynamics</td><td>Modelica.Fluid.Types.Dynamic...</td><td>Formulation of energy balance</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> PrescribedOutletStateParameters <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Parameters for models with prescribed outlet state&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow_maxHeat = Modelica.Constants.inf <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Maximum heat flow rate for heating (positive)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>Modelica.SIunits.HeatFlowRate</a> Q_flow_maxCool = -Modelica.Constants.inf <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Maximum heat flow rate for cooling (negative)&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</a> m_flow_nominal <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Nominal mass flow rate, used for regularization near zero flow&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Modelica.SIunits.Time</a> tau(min=0) = 10 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Time constant at nominal flow rate (used if energyDynamics &lt;&gt; Modelica.Fluid.Types.Dynamics.SteadyState)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Modelica.SIunits.Temperature</a> T_start <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Initial or guess value of set point&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Modelica.Fluid.Types.Dynamics</a> energyDynamics=Modelica.Fluid.Types.Dynamics.SteadyState <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Formulation of energy balance&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>PrescribedOutletStateParameters;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE TwoPortFlowResistanceParameters<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Buildings.Fluid.Interfaces.TwoPortFlowResistanceParameters"></a><a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces"
>Buildings.Fluid.Interfaces</a>.TwoPortFlowResistanceParameters</h2>
<p>
<b>Parameters for flow resistance for models with two ports</b>
</p>
<h3>Information</h3>

This class contains parameters that are used to
compute the pressure drop in models that have one fluid stream.
Note that the nominal mass flow rate is not declared here because
the model
<a href="Buildings_Fluid_Interfaces.html#Buildings.Fluid.Interfaces.PartialTwoPortInterface"
>
PartialTwoPortInterface</a>
already declares it.

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Nominal condition</td></tr>
<tr><td><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</a></td><td>dp_nominal</td><td>&nbsp;</td><td>Pressure difference [Pa]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Flow resistance</b></td></tr>
<tr><td>Boolean</td><td>computeFlowResistance</td><td>true</td><td>=true, compute flow resistance. Set to false to assume no friction</td></tr>
<tr><td>Boolean</td><td>from_dp</td><td>false</td><td>= true, use m_flow = f(dp) else dp = f(m_flow)</td></tr>
<tr><td>Boolean</td><td>linearizeFlowResistance</td><td>false</td><td>= true, use linear relation between m_flow and dp for any flow rate</td></tr>
<tr><td>Real</td><td>deltaM</td><td>0.1</td><td>Fraction of nominal flow rate where flow transitions to laminar</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">record</span> TwoPortFlowResistanceParameters <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Parameters for flow resistance for models with two ports&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean computeFlowResistance = true <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=true, compute flow resistance. Set to false to assume no friction&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean from_dp = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use m_flow = f(dp) else dp = f(m_flow)&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="../../msl/Modelica%203.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</a> dp_nominal(min=0, displayUnit=&quot;Pa&quot;) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Pressure difference&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean linearizeFlowResistance = false <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;= true, use linear relation between m_flow and dp for any flow rate&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Real deltaM = 0.1 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Fraction of nominal flow rate where flow transitions to laminar&quot;</span>;

<span style="color: blue; font-weight: normal; font-style: normal;">end </span>TwoPortFlowResistanceParameters;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Mon Jul 13 14:26:14 2015.
</address>
</body>
</html>
